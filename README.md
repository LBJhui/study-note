```text
https://www.zhangxinxu.com/wordpress/2024/11/js-selectionchange-event/
tsup
ç™½æ¿ webassembly+Skia Engine
å…è´¹è¯¾åˆé›†ï¼šhttps://qmdqi.xetlk.com/s/376rbn
https://www.zhangxinxu.com/wordpress/2024/09/js-scrollend-event/
https://www.zhangxinxu.com/wordpress/2024/09/js-object-groupby/
https://www.zhangxinxu.com/wordpress/2024/09/css-math-round-function/
HTMLCollection(åŠ¨æ€) & NodeList(é™æ€) ä¼ªæ•°ç»„
CSSæ–‡æœ¬è‡ªå®šä¹‰é«˜äº®APç®€ä»‹ https://www.zhangxinxu.com/wordpress/2024/07/css-custom-highlight-api/
initial-letter https://www.zhangxinxu.com/wordpress/2024/03/css-initial-letter/
margin-trim å±æ€§è®¾ç½®åœ¨å®¹å™¨å…ƒç´ ä¸Šï¼Œå¯ä»¥è®©å­å…ƒç´ (éœ€è¾¹ç¼˜æ¥è§¦) margin è®¾ç½®è®¡ç®—å€¼å˜æˆ 0 https://www.zhangxinxu.com/wordpress/2023/05/css-margin-trim/
align-contentä¹Ÿé€‚ç”¨äºæ™®é€šå…ƒç´ 
Math.hypot
grid-template-rows: masonry;
vueæ–¹æ³•ä¸­å±æ€§ä¸¢å¤±çš„é—®é¢˜ methodsé…ç½®çš„æ–¹æ³•ä¸ç»„ä»¶å®ä¾‹çš„æ–¹æ³•
console.log(([][[]] + [])[+!![]] + ([] + {})[+!![] + +!![]])
å±•ç¤ºç»„ä»¶å’Œå®¹å™¨ç»„ä»¶
ä½¿ç”¨computedæ‹¦æˆªv-model https://juejin.cn/post/7338634091397431330
v-model çˆ¶ä¼ å­å€¼ï¼Œå…ƒç´ æ›´æ”¹åè·å–å€¼æ»åï¼ŒnextTick
å³é”®èœå•ç»„ä»¶çš„å°è£… https://blog.csdn.net/DuyiZiChen/article/details/131405493
SocketIO
è§†é¢‘æ–‡æœ¬åŒ– text-image
ä½¿ç”¨å†»ç»“å¯¹è±¡æå‡æ•ˆç‡ Object.freeze() å†»ç»“å¯¹è±¡åœ¨vueä¸­ä¸ä¼šå˜ä¸ºå“åº”å¼
symbol.toStringTag
backface-visibility
è¡Œç›’çš„æˆªæ–­æ ·å¼ï¼šbox-decoration-break
CSSå®ç°å¥¥æ—åŒ¹å…‹äº”ç¯
å…¨å±€å¯¼å…¥å’Œå±€éƒ¨å¯¼å…¥çš„åŒºåˆ«
ESModule çš„å·¥ä½œåŸç†
transform ä»å³åˆ°å·¦ translate3d
localeCompare å­—å…¸é¡ºåº
ä¾èµ–æ£€æŸ¥å·¥å…· depcheck
mask-image
vue3 expose defineExpose
æ­£åˆ™åŒ¹é…çš„è´ªå©ªæ¨¡å¼å’Œæƒ°æ€§æ¨¡å¼æœ‰ä»€ä¹ˆåŒºåˆ«
node ç‰ˆæœ¬ç®¡ç†å·¥å…·:`volta` `nvm`
new.target å¯ä»¥åˆ¤æ–­å‡½æ•°æ˜¯å¦è¢« new è°ƒç”¨
æµè§ˆå™¨çš„è‡ªåŠ¨æ’­æ”¾ç­–ç•¥
BFF å±‚ backends for frontends
å‡½æ•°ç­¾å = å‡½æ•°å + å‚æ•° + è¿”å›å€¼
æ”¹å˜ webkit è¡¨å•è¾“å…¥æ¡† placeholder çš„é¢œè‰²å€¼ï¼šinput::-webkit-input-placehold
å»æ‰ ios ç³»ç»Ÿä¸­å…ƒç´ è¢«è§¦æ‘¸æ—¶äº§ç”Ÿçš„åŠé€æ˜ç°è‰²é®ç½©ï¼štip-highlight-color:rgba(0,0,0,0)
http accept-lang/navigator.lang
git å¿½ç•¥æ–‡ä»¶åå¤§å°å†™ git config core.ignorecase false
content-type
showDirectoryPicker FileSystem API
insertBefore
removeProperty
Web Locks API
preventDefaultã€stopPropagation
ä¿„ç½—æ–¯æ–¹å—å®ç°æ€è·¯
conic-gradient
web-vitals
?? è¿ç®—ç¬¦ è¿”å›ç¬¬ä¸€ä¸ªå·²å®šä¹‰çš„å€¼
è‰²å½©ç©ºé—´ hex rgb hsl hsv
Object.defineProperty åªèƒ½ç›‘å¬åˆ°å¯¹è±¡å±æ€§çš„è¯»å–æˆ–è€…æ˜¯å†™å…¥ï¼Œè€Œ Proxy é™¤è¯»å†™å¤–è¿˜å¯ä»¥ç›‘å¬å¯¹è±¡ä¸­å±æ€§çš„åˆ é™¤ï¼Œå¯¹å¯¹è±¡å½“ä¸­æ–¹æ³•çš„è°ƒç”¨
object-fit
ä¸è§„åˆ™çš„æ–‡å­—ç¯ç»•:shape-outside
getPrototypeOfã€setPrototypeOf
Array.from()
[åŠ¨ç”»åº“ï¼šGSAP scrolltrigger]https://gsap.com/
addEventListener compositionstart 'contextmenu'
markRawã€withModifiers
æ•°ç»„æ–°å¢çš„çº¯å‡½æ•° APIï¼štoSortedã€toReversedã€toSplicedã€with(ä¿®æ”¹æ•°ç»„)
font-variantã€text-transform
js æ–‡æ¡£æ³¨é‡Šï¼šjsDoc
vscode æ­£åˆ™æ’ä»¶ï¼šRegex Previewer
ElementUI æ—¥æœŸé€‰æ‹©å™¨æ—¶é—´é€‰æ‹©èŒƒå›´é™åˆ¶
è‡ªå®šä¹‰æŒ‡ä»¤æ§åˆ¶æƒé™çš„å¼Šç«¯ https://blog.csdn.net/layonly/article/details/139402930 DOM å…ƒç´ åˆ é™¤åï¼Œç”Ÿå‘½å‘¨æœŸä¼šæ­£å¸¸è¿›è¡Œï¼Œè¿˜ä¼šè¯·æ±‚æ•°æ®
ç»„ä»¶å¾ªç¯ä¾èµ–ï¼šåŠ¨æ€å¯¼å…¥
å®ç° sleep å‡½æ•°
å®ç° throttle èŠ‚æµå‡½æ•°
å›¾ç‰‡è°ƒè‰²ç›˜ï¼šcolorThief
ç¬¦å·ç»‘å®š
css æ–°å•ä½ vmin vmax
å‰ç«¯ocrå›¾ç‰‡æ–‡å­—æå–åŠŸèƒ½: tesseract.js
æ‹–æ‹½ç»„ä»¶: vue-draggable-plus
é‡ç»˜å’Œå›æµ
é˜²æˆªå±é˜²å½•åˆ¶ï¼šEncrypted Media Extensions API
console.log() æ‰“å°å¯¹è±¡æ—¶ï¼Œç‚¹å‡»å°ä¸‰è§’å®æ—¶åŠ è½½
å…ƒç´ å€’å½±:-webkit-box-reflect
é¡µé¢å¯è§åº¦ API page visibility
ç¦æ­¢è§¦å‘ç³»ç»Ÿèœå•å’Œé•¿æŒ‰é€‰ä¸­ï¼š`touch-callout:none` contextmenu
ç¦æ­¢ç”¨æˆ·é€‰ä¸­æ–‡å­—ï¼š`user-select:none`
ä½¿ç”¨data urlé¢„è§ˆå›¾ç‰‡ https://blog.csdn.net/u012804440/article/details/136018598
åœ¨ TypeScript ä¸­æ­£ç¡®çš„éå†ä¸€ä¸ªå¯¹è±¡
```

```javascript
Array.prototype.myForEach = async function (callback, thisArg) {
  const _arr = this,
    _isArray = Array.isArray(_arr),
    _thisArg = thisArg ? Object(thisArg) : globalThis
  if (!_isArray) {
    throw new TypeError('The caller of myForEach must be the type an array')
  }
  for (let i = 0; i < _arr.length; i++) {
    await callback.call(_thisArg, _arr[i], i, _arr)
  }
}

fun([() => console.log('start'), () => sleep(1000), () => console.log('1'), () => sleep(2000), () => console.log('2'), () => sleep(3000), () => console.log('end')])

function sleep(ms) {
  return new Promise((resolve) => {
    setTimeout(resolve, ms)
  })
}

async function fun(arr) {
  arr.myForEach(async (item) => await item())
  // for (let i = 0; i < arr.length; i++) {
  //   await arr[i]()
  // }
  //
  /**
   * arr.forEach(async (item) => await item())
   *  async (item1)=>await item1()
   *  async (item2)=>await item2()
   */
}
```

```javascript
// Webç½‘é¡µ é˜»æ­¢æ¯å± Screen Wake Lock API https://www.zhangxinxu.com/wordpress/2024/03/js-screen-wake-lock-api/
navigator.wakeLock.request('screen')
// å½“å‰é¡µé¢æœ€å°åŒ–ï¼Œæˆ–è€…éå½“å‰æ˜¾ç¤ºæ ‡ç­¾é¡µï¼Œå±å¹•çš„ Wake é”å®šè¡Œä¸ºä¼šè¢«é‡Šæ”¾
document.addEventListener('visibility', () => {
  if (document.visibilityState === 'visible') {
    navigator.wakeLock.request('screen')
  }
})

// wakeLock æ˜¯ä¸ª WakeLockSentinel å¯¹è±¡
let wakeLock = null
navigator.wakeLock.request('screen').then((result) => {
  wakeLock = result
})

// é‡Šæ”¾é”
wakeLock.release().then(() => {
  wakeLock = null
})

// çŸ¥é“ä½•æ—¶é‡Šæ”¾
wakeLock.addEventListener('release', () => {
  console.log('å”¤é†’é”å®šå·²é‡Šæ”¾')
})
```

```css
/* CSSé”šç‚¹å®šä½ https://segmentfault.com/a/1190000045077175 */

/* éšå¼é”šç‚¹ é€‚ç”¨äº 1v1 */
.trigger {
  anchor-name: --my-anchor;
}

.target {
  position-anchor: --my-anchor;
  left: anchor(left);
  /* å±…ä¸­å¯¹é½ */
  /* justify-self: anchor-center;  */
  /* inset-area: bottom; */
}

/* æ˜¾ç¤ºé”šç‚¹ é€‚ç”¨äºå¤šå…ƒç´ å®šä½ */
.trigger1 {
  anchor-name: --anchor-a;
}

.trigger2 {
  anchor-name: --anchor-b;
}

.target {
  position: absolute;
  left: anchor(--anchor-a right);
  right: anchor(--anchor-b left);
}
```

```html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <style>
      /* @scopeè§„åˆ™ */
      @scope (#app) {
        .box {
          width: 100px;
          height: 100px;
          background-color: red;
        }
      }
    </style>
  </head>
  <body>
    <div id="app">
      <div class="box"></div>
    </div>
  </body>
</html>
```

```text
è·¨æ ‡ç­¾é¡µé€šä¿¡å¸¸è§æ–¹æ¡ˆ
  BroadcastChannel API
  Service Worker
  LocalStorage  window.onstorage ç›‘å¬
  Shared Worker å®šæ—¶å™¨è½®è¯¢ setInterval
  IndexedDB å®šæ—¶å™¨è½®è¯¢
  cookie å®šæ—¶å™¨è½®è¯¢
  window.openã€window.postMessage
  WebSocket
```

```javascript
// ä»»åŠ¡æ‰§è¡Œçš„æ´‹è‘±æ¨¡å‹
class TaskPro {
  #tasksList
  #isRunning
  #currentIndex
  #next

  constructor() {
    this.#tasksList = []
    this.#isRunning = false
    this.#currentIndex = 0
    this.#next = async () => {
      this.#currentIndex++
      await this.#runTask()
    }
  }

  addTask(task) {
    this.#tasksList.push(task)
  }

  run() {
    if (this.#isRunning || this.#tasksList.length === 0) return undefined
    this.#isRunning = true
    this.#runTask()
  }

  /**
   * å–å‡ºä¸€ä¸ªä»»åŠ¡æ‰§è¡Œ
   */
  async #runTask() {
    if (this.#currentIndex >= this.#tasksList.length) {
      this.#reset()
      return undefined
    }
    const i = this.#currentIndex
    const task = this.#tasksList[this.#currentIndex]
    await task(this.#next)
    const j = this.#currentIndex
    if (i === j) {
      await this.#next()
    }
  }

  #reset() {
    this.#currentIndex = 0
    this.#isRunning = false
    this.#tasksList = []
  }
}

const t = new TaskPro()

t.addTask(async (next) => {
  console.log('task1 start')
  await next()
  console.log('task1 end')
})
t.addTask((next) => {
  console.log('task2')
})
t.addTask((next) => {
  console.log('task3')
})

t.run()
```

```
æ‰“åŒ…ç»“æœåˆ†æå·¥å…·
  Webpack:webpack-bundle-analyzer
  vite:vite-bundle-visualizer
       rollup-bundle-visualizer
```

```
å…ƒç´ çš„ç»˜åˆ¶é¡ºåº
  å¯æ›¿æ¢å…ƒç´ 
    å…ƒç´ æœ¬èº«
    å…ƒç´ å†…å®¹
  å †å ä¸Šä¸‹æ–‡ã€å±‚å ä¸Šä¸‹æ–‡
    z-index,position:relative
    transform
```

```javascript
// æ–‡ä»¶ä¸Šä¼ 
//   å•æ–‡ä»¶ä¸Šä¼  multiport/form-data
//   äºŒè¿›åˆ¶æ ¼å¼ä¸Šä¼ æ–‡ä»¶ binary/application/octet-stream

// æ–‡ä»¶ä¸‹è½½
// ä¸‹è½½çš„æµå¼ä¼ è¾“
// å¦‚æœå‰ç«¯ç›´æ¥æ‰“å¼€æ–‡ä»¶ï¼Œæ²¡æœ‰è§¦å‘ä¸‹è½½ a å…ƒç´  download

// æ•°æ®çš„æµå¼è·å–
async function getRespnse(content) {
  const resp = await fetch(url, {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify(content),
  })
  // const data = awit resp.text()
  const reder = resp.body.getReader()
  const decoder = new TextDecoder()
  while (true) {
    const { done, value } = await reader.read()
    if (done) {
      break
    }
    const txt = decoder.decode(value)
  }
}

// åˆ†å—åŠ è½½å¤§æ•°æ®
async function loadNovel() {
  const url = 'https://duyi-static.oss-cn-beijing.aliyuncs.com/files/novel.txt'
  const res = await fetch(url)
  const reader = res.body.getReader()
  const { value, done } = await reader.read()
  const decoder = new TextDecoder()
  const text = decoder.decode(value)
  for (;;) {
    const { value, done } = await reader.read()
    if (done) {
      break
    }
    const text = decoder.decode(value) // å¯èƒ½å­˜åœ¨ä¹±ç 
  }
}

// æœåŠ¡å™¨ç«¯ï¼š
  res.setHeader('Content-Disposition', 'attachment;filename=es6.pdf')
// å‰ç«¯
  <a download=''></a>
// https://blog.csdn.net/weixin_64684095/article/details/139484213

// è§¦å‘è¿…é›·ä¸‹è½½
const link = 'éœ€è¦ä¸‹è½½çš„åœ°å€'
const newHref = btoa(`AA${link}ZZ`) // a æ ‡ç­¾çš„åœ°å€

a.href = `thunder://${newHref}`
```

```ts
// neverç±»å‹çš„å¦™ç”¨
type Method = 'GET' | 'POST'

function request(url: string, method: Method) {
  if (method === 'GET') {
    // do something
  } else if (method === 'POST') {
    // do something
  } else {
    // ä¹‹å Method æ–¹æ³•ä¿®æ”¹ï¼Œè¿™é‡Œä¼šæŠ¥é”™
    const n: never = method
  }
}

// neverç±»å‹çš„å¦™ç”¨2
function m<T>(x: T extends number ? never : T) {}
```

```javascript
// ä»è§†é¢‘æ–‡ä»¶æå–ç”»é¢å¸§ https://juejin.cn/post/7352079398072746047
const inp = document.querySelector('input[type=file]')
inp.onchange = (e) => {
  const file = e.target.files[0]
  captureFrame(file, 1).then(({ url }) => {
    const img = document.createElement('img')
    img.src = url
    document.body.appendChild(img)
  })
}

function captureFrame(file, time = 0) {
  return new Promise((resolve, reject) => {
    const vdo = document.createElement('video')
    vdo.currentTime = time
    vdo.mute = true
    vdo.autoplay = true
    vdo.src = URL.createObjectURL(file)
    vdo = oncanplay = () => {
      const cvs = document.createElement('canvas')
      cvs.width = vdo.videoWidth
      cvs.height = vdo.videoHeight
      const ctx = cvs.getContext('2d')
      ctx.drawImage(vdo, 0, 0, cvs.width, cvs.height)
      // document.body.appendChild(cvs)

      cvs.toBlob((blob) => {
        const url = URL.createObjectURL(blob)
        resolve({ url, blob })
      })
    }
  })
  // return {
  //   url:å›¾ç‰‡çš„urlåœ°å€
  //   blob:å›¾ç‰‡çš„äºŒè¿›åˆ¶æ•°æ®
  // }
}
```

```js
// æ·±åº¦å…‹éš†çš„ä¸€èˆ¬å®ç°
const cache = new WeakMap()

function deepClone(value) {
  if (typeof value !== 'object' || value === null) {
    return value
  }
  // value æ˜¯å¯¹è±¡
  if (cache.has(value)) {
    return cache.get(value)
  }
  const result = Array.isArray(value) ? [] : {}
  Object.setPrototypeOf(result, Object.getPrototypeOf(value))
  cache.set(value, result)
  for (const key in value) {
    if (value.hasOwnProperty(key)) {
      result[key] = deepClone(value[key])
    }
  }
  return result
}

function deepClone(origin, target) {
  var tar = target || {}
  var toStr = Object.prototype.toString
  var arrType = '[object Array]'
  for (var k in origin) {
    if (origin.hasOwnProperty(k)) {
      if (typeof origin[k] === 'object' && origin[k] !== null) {
        tar[k] = toStr.call(origin[k]) === arrType ? [] : {}
        deepClone(origin[k], tar[k])
      } else {
        tar[k] = origin[k]
      }
    }
  }
  return tar
}

function deepClone(origin, hashMap = new WeakMap()) {
  // undefined null origin == undefined
  if (origin === undefined || origin === null || typeof origin !== 'object') {
    return origin
  }
  if (origin instanceof Date) {
    return new Date(origin)
  }
  if (origin instanceof RegExp) {
    return new RegExp(origin)
  }

  const hasKey = hashMap.get(origin)
  if (hasKey) {
    return hasKey
  }

  const target = new origin.constructor()
  for (let k in origin) {
    hashMap.set(origin, target)
    if (origin.hasOwnProperty(k)) {
      target[k] = deepClone(origin[k], hashMap)
    }
  }
  return target
}
```

```ts
class A {
  a: number = 1
  b: string = 'a'
}

type AFields = keypf
InstanceType<typeof A>
```

```text
å€¼ä¼ é€’
å¼•ç”¨ä¼ é€’
js å¼•ç”¨ä¼ é€’ å…·åå¯¼å…¥ import { n as main } from 'a.js'
https://blog.csdn.net/brilliantSt/article/details/136300491
```

```js
/**
 * å¯¹è±¡çš„å±æ€§è¿­ä»£é¡ºåºå¤§è‡´éµå¾ªä»¥ä¸‹è§„åˆ™ï¼š
 *  1ã€æ•°å€¼å±æ€§ï¼šé¦–å…ˆä¼šè¿­ä»£å¯¹è±¡çš„æ‰€æœ‰æ•°å€¼é”®ï¼ŒæŒ‰ç…§æ•°å€¼çš„å‡åºè¿›è¡Œã€‚
 *  2ã€å­—ç¬¦ä¸²å±æ€§ï¼šç„¶åæŒ‰å­—ç¬¦ä¸²çš„æ’å…¥é¡ºåºä¾æ¬¡è¿­ä»£å­—ç¬¦ä¸²å±æ€§
 *  3ã€symbolå±æ€§ï¼šå†ç„¶åæŒ‰symbolçš„æ’å…¥é¡ºåºä¾æ¬¡è¿­ä»£symbolå±æ€§
 *  4ã€ç»§æ‰¿å±æ€§ï¼šå½“ä¸€ä¸ªå¯¹è±¡ä¸Šæœ‰è‡ªå·±çš„å±æ€§ï¼Œå¹¶ä¸”è¿˜ç»§æ‰¿ä¸€äº›å±æ€§çš„æ—¶å€™ã€‚æ•´ä½“ä¹Ÿæ˜¯æŒ‰ç…§ä¸Šè¿°ä¸‰æ¡è§„åˆ™æ’åºçš„ï¼Œä½†æ˜¯æ’å…¥é¡ºåºå¯èƒ½éœ€è¦æ³¨æ„ã€‚è¿™é‡Œæš‚ä¸è€ƒè™‘è¿™ç§ç‰¹æ®Šå¤æ‚æƒ…å†µã€‚
 */
const obj = {
  a: 0,
}
obj['1'] = 0
obj[++obj.a] = obj.a++
const values = Object.values(obj)
obj[values[1]] = obj.a
console.log(obj)
```

```js
// æ‰‹å†™memoize
class MemoizeMap {
  #map
  #weakMap

  constructor() {
    this.#map = new Map()
    this.#weakMap = new WeakMap()
  }

  _isObject(v) {
    return typeof v === 'object' && v !== null
  }

  set(key, value) {
    if (this._isObject(key)) {
      this.#weakMap.set(key, value)
    } else {
      this.#map.set(key, value)
    }
  }

  get(key) {
    if (this._isObject(key)) {
      return this.#weakMap.get(key)
    } else {
      return this.#map.get(key)
    }
  }

  has(key) {
    if (this._isObject(key)) {
      return this.#weakMap.get(key)
    } else {
      return this.#map.get(key)
    }
  }
}

function memoize(fn, resolver) {
  function memoized(...args) {
    const key = resolver ? resolver(...args) : args[0]
    const cache = memoized.cache
    if (cache.has(key)) {
      return cache.get(key)
    }
    const result = fn.apply(this, args)
    cache.set(key, result)
    return result
  }

  memoized.cache = new MemoizeMap()
  return memoized
}
```

```js
// JSLabelè¯­æ³•
outer: for (let i = 0; i < 10; i++) {
  console.log('é¡¶å±‚å¾ªç¯')
  for (let j = 0; j < 10; j++) {
    console.log('å†…å±‚å¾ªç¯', i, j)
    if (i * j > 30) {
      console.log('é€€å‡ºé¡¶å±‚å¾ªç¯')
      break outer
    }
  }
}
```

```js
/**
 * nums æ•°ç»„ä¸­åŒ…å« 1 ä¸ªæˆ–å¤šä¸ªæ­£æ•´æ•°
 * å…¶ä»–çš„æ•°å­—éƒ½å‡ºç° 2 æ¬¡
 * åªæœ‰ä¸€ä¸ªæ•°å­—å‡ºç°äº† 1 æ¬¡
 * æ‰¾å‡ºåªå‡ºç°äº† 1 æ¬¡çš„æ•°å­—
 */
function uniqueNumber(nums) {
  // 0 å¼‚æˆ– åˆ«çš„æ•°ç­‰äºæ•°æœ¬èº«
  // ç›¸åŒçš„æ•°å¼‚æˆ–ç»“æœä¸º 0
  var result = 0
  for (const n of nums) {
    result ^= n
  }
  return result
  // return nums.reduce((a, b) => a ^ b, 0)
}
```

```javascript
// ç›®å½•çš„è‡ªåŠ¨é«˜äº®
function highlight(id) {
  document.querySelectorAll('a.highlight').forEach((a) => {
    a.classList.remove('highlight')
  })
  if (id instanceof HTMLElement) {
    id.classList.add('highlight')
    return
  }
  if (id.startsWith('#')) {
    id = id.substring(1)
  }
  document.querySelector(`a[href="${id}"`).classList.add('highlight')
}

const links = document.querySelectorAll('.toc a[href^="#"')
const titles = []
for (const link of links) {
  link.addEventListener('click', (e) => {
    highlight(link)
  })
  const url = new URL(link.href)
  const dom = document.querySelector(url.hash)
  if (dom) {
    titles.push(dom)
  }
}

/**
 * å‡½æ•°é˜²æŠ–
 */
const debounce = (fn, delay) => {
  let timer = null
  return function (...args) {
    clearTimeout(timer)
    timer = setTimeout(() => {
      fn.apply(this, args)
    }, delay)
  }
}

const scrollHandler = debounce(() => {
  const rects = titles.map((title) => title.getBoundingClientRect())
  const toRange = 300
  for (let i = 0; i < titles.length; i++) {
    const rect = rects[i] // æ ‡é¢˜çš„ä½ç½®ä¿¡æ¯
    const title = titles[i] // æ ‡é¢˜çš„ Dom
    if (rect.top >= 0 && rect.top <= toRange) {
      highlight(title.id)
      break
    } else if (rect.top < 0 && rect[i + 1] && rect[i + 1].top > document.documentElement.clientHeight) {
      highlight(title.id)
      break
    }
  }
}, 100)

window.addEventListener('scroll', scrollHandler)
```

```ts
// å¯¹é˜²æŠ–å‡½æ•°è¿›è¡Œç±»å‹æ ‡æ³¨
declare function debounce<T extends any[]>(fn: (...args: T) => any, delay: number): (...args: T) => void
```

```javascript
/**
 * ä¸¤ä¸ªè¶…è¿‡æ•´æ•°å­˜å‚¨èŒƒå›´çš„å¤§æ­£æ•´æ•°æ±‚å’Œ
 * @param {String} a
 * @param {String} b
 */

function sum(a, b) {
  let result = ''
  const len = Math.max(a.length, b.length)
  a = a.padStart(len, '0')
  b = b.padStart(len, '0')
  let addOne = 0
  for (let i = len - 1; i >= 0; i--) {
    const n = +a[i] + +b[i] + addOne
    addOne = Math.floor(n / 10)
    result = (n % 10) + result
  }
  if (addOne) result = addOne + result
  return result
}
```

```ts
åå˜å’Œé€†å˜
//blog.csdn.net/u014676858/article/details/141826960
// https: ç±»å‹å®‰å…¨ æ‰€æœ‰æˆå‘˜å¯ç”¨

// æ”¶ï¼šFans: çˆ¶ç±»å‹ æˆå‘˜å°‘
// ç»™ï¼šIkun: å­ç±»å‹ æˆå‘˜å¤š

interface Fans {
  call(): void
}

interface IKun extends Fans {
  sing(): void
  dance(): void
  basketball(): void
  rap(): void
}

let fans: Fans
let ikun: IKun

fans = ikun
ikun = fans // ä¸èƒ½èµ‹å€¼
```

```javascript
// 2048æ¸¸æˆæ ¸å¿ƒé€»è¾‘
const matrix = [
  [0, 2, 2, 0],
  [0, 0, 2, 2],
  [2, 4, 4, 2],
  [2, 4, 4, 4],
]

function move(matrix, direction) {
  const rows = matrix.length
  const cols = matrix[0].length

  function _inRange(i, j) {
    return i >= 0 && i < rows && j >= 0 && j < cols
  }

  const nexts = {
    up: (i, j) => [i + 1, j],
    down: (i, j) => [i - 1, j],
    left: (i, j) => [i, j + 1],
    right: (i, j) => [i, j - 1],
  }

  // å¾—åˆ°ä¸‹ä¸€ä¸ªéé›¶çš„ä½ç½® [r, c, value]
  function _nextNonZero(i, j) {
    // å¾—åˆ°ä¸‹ä¸€ä¸ªä½ç½®
    let [nextI, nextJ] = nexts[direction](i, j)
    if (!_inRange(nextI, nextJ)) return null
    while (_inRange(nextI, nextJ)) {
      const value = matrix[nextI][nextJ]
      if (value !== 0) {
        return [nextI, nextJ, value]
      }
      ;[nextI, nextJ] = nexts[direction](nextI, nextJ)
    }
    return null
  }

  // ä» iï¼Œj å‡ºå‘ï¼Œä¾æ¬¡å¤„ç†æŸè¡Œæˆ–æŸåˆ—çš„æ•°æ®
  function _cal(i, j) {
    if (!_inRange(i, j)) return
    const next = _nextNonZero(i, j)
    if (!next) {
      return
    }
    const [nextI, nextJ, nextValue] = next
    if (matrix[i][j] === 0) {
      matrix[i][j] = nextValue
      matrix[nextI][nextJ] = 0
      _cal(i, j)
    } else if (matrix[i][j] === nextValue) {
      matrix[i][j] *= 2
      matrix[nextI][nextJ] = 0
    }
    const [ni, nj] = nexts[direction](i, j)
    _cal(ni, nj)
  }

  if (direction === 'up') {
    for (let j = 0; j < cols; j++) {
      _cal(0, j)
    }
  } else if (direction === 'down') {
    for (let j = 0; j < cols; j++) {
      _cal(rows - 1, j)
    }
  } else if (direction === 'left') {
    for (let i = 0; i < rows; i++) {
      _cal(i, 0)
    }
  } else if (direction === 'right') {
    for (let i = 0; i < rows; i++) {
      _cal(i, cols - 1)
    }
  }
  return matrix
}

console.log(move(matrix, 'up'))

/**
 * [
 *  [4, 2, 4, 4],
 *  [0, 8, 8, 4],
 *  [0, 0, 0, 0],
 *  [0, 0, 0, 0]
 * ]
 */
```

```js
// æ¶ˆé™¤å¼‚æ­¥çš„ä¼ æŸ“æ€§ https://blog.csdn.net/weixin_51351053/article/details/140050295
async function getUser() {
  return await fetch('./1.json')
}

async function m1() {
  const user = await getUser()
  return user
}

async function m2() {
  const user = await m1()
  return user
}

async function m3() {
  const user = await m2()
  return user
}

/**
 * main->getUser->fetch(error)--->main->getUser->fetch->getUser->main
 *                      fetch-->cache-->main
 */
function main() {
  const user = m3()
  console.log(user)
}

function run(func) {
  // 1. æ”¹åŠ¨ Fetch
  const oldFetch = window.fetch
  const cache = {
    status: 'pending',
    value: null,
  }

  function newFetch(...args) {
    // æœ‰ç¼“å­˜è¿”å›ç¼“å­˜
    if (cache.status === 'fulfilled') {
      return cache
    } else if (cache.status === 'rejected') {
      throw new Error(cache.value)
    }
    // æ²¡æœ‰ç¼“å­˜
    const p = oldFetch(...arguments)
      .then((data) => data.json)
      .then((data) => {
        cache.status = 'fulfilled'
        cache.value = data
      })
      .catch((err) => {
        cache.status = 'rejected'
        cache.value = err
      })
    // æŠ›å‡ºé”™è¯¯
    throw 123
  }

  window.fetch = newFetch
  // 2. æ‰§è¡Œ func
  try {
    func()
  } catch (e) {
    // ç­‰å¾…è¯·æ±‚å®Œæˆåé‡æ–°è¿è¡Œ func
    if (err instanceof Promise) {
      err.finall(() => {
        window.fetch = newFetch
        func()
        window.fetch = oldFetch
      })
    }
  }
  // 3. æ”¹å› fetch
  window.fetch = oldFetch
}

run(main)
```

```javascript
// call æ–¹æ³•ç¬¬ä¸€ä¸ªå‚æ•°ä¸º null æˆ– undefinedï¼Œthis ä¼šè¢«è®¾ç½®ä¸ºå…¨å±€å¯¹è±¡
// callå’Œapplyçš„é“¾å¼è°ƒç”¨
const r = console.log.call.call.call.call.call.call.call.apply((a) => a, [1, 2])

console.log(r)

console.log(console.log.__proto__ === Function.prototype)
console.log(console.log.call === Function.prototype.call)

// const r = Function.prototype.call.apply((a) => a, [1, 2])
```

```javascript
Promise.myAll = function (promises) {
  let res, rej
  const p = new Promise((resolve, reject) => {
    res = resolve
    rej = reject
  })
  let i = 0
  let result = []
  for (const prom of promises) {
    const index = i
    i++
    Promise.resolve(prom).then((data) => {
      // 1.å°†å®Œæˆçš„æ•°æ®åŠ å…¥åˆ°æœ€ç»ˆç»“æœ
      result[index] = data
      // 2.åˆ¤æ–­æ˜¯å¦å…¨éƒ¨å®Œæˆ
      i--
      if (i === 0) {
        res(result)
      }
    }, rej)
  }
  if (i === 0) {
    res([])
  }
  return p
}

Promise.myAll([1, 2, 3, Promise.reject(4)])
  .then((data) => {
    console.log('%c ğŸ‘ data', 'font-size:16px;color:#ea7e5c', data)
  })
  .catch((e) => {
    console.log('%c ğŸ‚ e', 'font-size:16px;color:#f5ce50', e)
  })
```

```js
// â‘ 
Pormise.resolve()
  .then(() => {
    console.log(0)
    return Promise.resolve(4)
  })
  .then((res) => {
    console.log(res)
  })
Promise.resolve()
  .then(() => {
    console.log(1)
  })
  .then(() => {
    console.log(2)
  })
  .then(() => {
    console.log(3)
  })
  .then(() => {
    console.log(5)
  })
  .then(() => {
    console.log(6)
  })

/**
 * thenable
 *  1. å®Œæˆï¼Œæ‰€æœ‰æ³¨å†Œçš„ thenable è¿›é˜Ÿåˆ—
 *  2. è°ƒç”¨ thenï¼Œå¦‚æœå·²å®Œæˆï¼Œç›´æ¥è¿›é˜Ÿåˆ—
 */

// â‘¡
new Promise((resolve, reject) => {
  resolve(2)
  new Promise((resolve, reject) => {
    resolve(5)
  }).then((v) => console.log(v))
}).then((v) => console.log(v))

// â‘¢
new Promise((resolve, reject) => {
  setTimeout(() => {
    resolve(2)
    new Promise((resolve, reject) => {
      resolve(5)
    }).then((v) => console.log(v))
  })
}).then((v) => console.log(v))

// â‘£
const promise1 = Promise.resolve('first')

const promise2 = new Promise((resolve) => {
  setTimeout(() => {
    resolve('second')
  }, 1000)
})

const promise3 = Promise.reject('third')

function handlePromise(promise) {
  return promise
    .then((value) => {
      console.log(value)
      return value
    })
    .catch((error) => {
      console.log('Error', error)
      return 'Error handler'
    })
}

async function runPromises() {
  try {
    const result1 = await handlePromise(promise1)
    console.log('result1', result1)
    // const result2 = await handlePromise(promise2)
    const result2 = handlePromise(promise2)
    console.log('result2', result2)
    const result3 = await handlePromise(promise3)
    console.log('result3', result3)
  } catch (error) {
    console.error('Caught error', error)
  }
}

runPromises()
```

```js
// é«˜é‡çº§ä»»åŠ¡æ‰§è¡Œä¼˜åŒ–
/**
 * è¿è¡Œä¸€ä¸ªè€—æ—¶ä»»åŠ¡
 * å¦‚æœè¦å¼‚æ­¥æ‰§è¡Œä»»åŠ¡ï¼Œè¯·è¿”å› Promise
 * è¦å°½å¿«å®Œæˆä»»åŠ¡ï¼ŒåŒæ—¶ä¸è¦è®©é¡µé¢äº§ç”Ÿå¡é¡¿
 * å°½é‡å…¼å®¹æ›´å¤šçš„æµè§ˆå™¨
 * @param {Function} task

 */
//ç›´æ¥è¿è¡Œä»»åŠ¡ é˜»å¡
function runTask(task) {
  task()
}

// å¾®ä»»åŠ¡ é˜»å¡
function runTask(task) {
  return new Promise((resolve) => {
    Promise.resolve().then(() => {
      task()
      resolve()
    })
  })
}

// å®ä»»åŠ¡ å¡é¡¿
function runTask(task) {
  return new Promise((resolve) => {
    setTimeout(() => {
      task()
      resolve()
    }, 0)
  })
}

// requestAnimationFrame é˜»å¡
function runTask(task) {
  return new Promise((resolve) => {
    requestAnimationFrame(() => {
      task()
      resolve()
    })
  })
}

function _runTask(task, callback) {
  // requestIdleCallback å…¼å®¹æ€§å·®
  // requestIdleCallback((idle) => {
  //   if (idle.timeRemaining > 0) {
  //     task()
  //     callback()
  //   } else {
  //     _runTask(task, callback)
  //   }
  // })
  let start = Date.now()
  requestAnimationFrame(() => {
    if (Date.now() - start < 16.6) {
      task()
      callback()
    } else {
      _runTask(task, callback)
    }
  })
}

function runTask(task) {
  return new Promise((resolve) => {
    _runTask(task, resolve)
  })
}
```

```css
/* é»æ€§å®šä½ */
position: sticky

;
æ ·å¼è®¡ç®— è§†è§‰æ ¼å¼åŒ–æ¨¡å‹
åŒ…å«å—
æœ€è¿‘å¯æ»šåŠ¨ç¥–å…ˆ
```

```scss
// SASSä¸­çš„æ¨¡å—åŒ–å¼€å‘
// @import
//   è¿è¡Œæ—¶ css
//   ç¼–è¯‘æ—¶
//     æ··æ·†
//     æ±¡æŸ“ å˜é‡æ±¡æŸ“
//     æ— ç§æœ‰
// @use

@use 'common.scss';
@use 'var.scss' as b;

$_n: 6; // ç§æœ‰å˜é‡

.foo {
  color: common.$color;
}
```

```scss
// sass æ··åˆ @mixin @include
// sass ç»§æ‰¿ extends %(æŠ½è±¡ç±»)

// ä½¿ç”¨SASSå®ç°ä¸»é¢˜åˆ‡æ¢
$themes: (
  light: (
    textColor: #333,
    bgColor: #fff,
  ),
  dark: (
    textColor: #fff,
    bgColor: #333,
  ),
);
$themeMap: ();
@mixin useTheme() {
  @each $key, $value in $themes {
    $themeMap: $value !global;
    html [data-theme='#{$key}'] & {
      @content;
    }
  }
}

@function getVar($paramName) {
  @return map-get($themeMap, $paramName);
}

.item {
  font-size: 14px;
  @include useTheme {
    background: getVar('bgColor');
    color: getVar('textColor');
  }
}
```

```js
// CommonJSçš„æœ¬è´¨ https://blog.csdn.net/huangpb123/article/details/138473608
// 2.js
this.a = 1
exports.b = 2
exports = {
  c: 3,
}
module.exports = {
  d: 4,
}
exports.e = 5
this.f = 6

//1.js
const a = require('./2')
console.log(a)
```

```js
// å¯ç¼“å­˜çš„æ–¹æ³• è®¡ç®—å±æ€§å¦‚ä½•ä¼ å‚
import { computed } from 'vue'

function useComputed(fn) {
  const map = new Map()
  return function (...args) {
    const key = JSON.stringify(args)
    if (map.has(key)) {
      return map.get(key)
    }
    const result = computed(() => {
      return fn(...args)
    })
    map.set(key, result)
    return result
  }
}
```

```js
// æ ‡ç­¾åŒ–æ¨¡æ¿ styled components
function tag(strings, ...values) {
  console.log(strings)
  console.log(values)
}

const user = {
  name: 'LBJhui',
  age: 18,
}

const hi = tag`My name is ${user.name}, I'm ${user.age} years old.`
```

```js
// æ•°ç»„æ‰å¹³åŒ–
Array.prototype.customFlatten = function () {
  // è½¬åŒ–ç»“æœ
  let flat = []
  for (let item of this) {
    if (Array.isArray(item)) {
      flat = flat.concat(item.customFlatten())
    } else {
      flat.push(item)
    }
  }
  return flat
}
```

```js
;[NaN]
  .includes(NaN) // true
  [NaN].indexOf(NaN) // -1
isNaN(NaN) // true
isNaN(1) // false
isNaN('1') // false
isNaN('x') // true

Number(undefined) // NaN
Number('   123    ') // 123
Number('12 3') // NaN (only whitespace from the start and end are removed)
NaN ** 0 // 1
isNaN('this is a string not a NaN value') // true
Number.isNaN('this is a string not a NaN value') // false

// NaN å’Œ Number.isNaN æœ‰ä»€ä¹ˆåŒºåˆ« Not a Number
console.log(NaN === NaN) // false
console.log(Number.isNaN(NaN)) // true
console.log(Number.isNaN('42')) // false
console.log(Number.isNaN('NaN')) // false
console.log(isNaN(NaN)) // true
console.log(isNaN(42)) // false
console.log(isNaN('NaN')) // true

/**
 * NaN ä¸ä»»ä½•å€¼ç›¸åŠ ç»“æœéƒ½ä¸º NaN
 * NaN ä¸ä»»ä½•å€¼ç›¸ç­‰ç»“æœéƒ½ä¸º false
 *
 * isNaN() å…ˆå°è¯•è½¬æ¢ä¸ºæ•°å­—ï¼Œè‹¥æ— æ³•è½¬æ¢ä¸ºæ•°å­—ï¼Œåˆ™è¿”å› trueï¼Œå¦åˆ™è¿”å› false
 * Number.isNaN ç›´æ¥æ£€æŸ¥ä¸€ä¸ªå€¼æ˜¯å¦æ˜¯ NaN
 */

console.log(isNaN('0yd'))
console.log(isNaN('0xd'))
console.log(NaN === NaN)
console.log(Number.isNaN('0yd'))
console.log(Number.isNaN('0xd'))
```

```js
Object.freeze(obj)
let person = {
  a: '1',
  b: '2',
}
Object.freeze(person)
person.a = '3'
console.log(person) // {a: '1', b: '2'}
person = {
  c: '3',
}
console.log(person) // {c: '3'}

/**
 * Object.freeze() è¿”å›çš„æ˜¯ä¸€ä¸ªä¸å¯å˜çš„å¯¹è±¡ã€‚è¿™å°±æ„å‘³ç€æˆ‘ä»¬ä¸èƒ½æ·»åŠ ï¼Œåˆ é™¤æˆ–æ›´æ”¹å¯¹è±¡çš„ä»»ä½•å±æ€§
 * const å’Œ Object.freeze å¹¶ä¸åŒï¼Œconst æ˜¯é˜²æ­¢å˜é‡é‡æ–°åˆ†é…ï¼Œè€Œ Object.freeze æ˜¯ä½¿å¯¹è±¡å…·æœ‰ä¸å¯å˜æ€§
 *
 * Object.freeze åªèƒ½å†»ç»“å½“å‰å¯¹è±¡
 *  Object.freeze ä»…èƒ½å†»ç»“å¯¹è±¡çš„å½“å‰å±‚çº§å±æ€§ï¼Œæ¢è€Œè¨€ä¹‹ï¼Œå¦‚æœå¯¹è±¡çš„æŸä¸ªå±æ€§æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆè¿™ä¸ªå†…éƒ¨å¯¹è±¡å¹¶ä¸ä¼šè¢« Object.freeze å†»ç»“
 */

// æ·±å†»ç»“
function deepFreeze(obj) {
  var propNames = Object.getOwnPropertyNames(obj)
  propNames.forEach((name) => {
    var prop = obj[name]
    if (typeof prop == 'object' && prop !== null) deepFreeze(prop)
  })
  return Object.freeze(obj)
}
```

```js
// è®¿é—®å™¨æˆå‘˜
function Product(name, unitPrice, chooseNumber) {
  this.name = name
  this.unitPrice = unitPrice
  this.chooseNumber = chooseNumber
  // ES5
  Object.defineProperty(this, 'totalPrice', {
    get() {
      return this.unitPrice * this.chooseNumber
    },
  })
  // ES6
  get
  totalPrice()
  {
    return this.unitPrice * this.chooseNumber
  }
}
```

```js
// ä½¿ç”¨ä»£ç†æ‹¦æˆªåŠ¨æ€å±æ€§
function createProxy (values = []) {
  return new Proxy(
    {},
    {
      get (target, p) {
        if (p === Symbol.toPrimitive) {
          return () => values.reduce((a, b) => a + b, 0)
        }
        return createProxy([...values, +p])
      },
    }
  )
}

const add = createProxy()
add + 4 // æœŸæœ›ç»“æœ 4
const r1 = add[1][2][3] + 4 // æœŸæœ›ç»“æœ 10
const r2 = add[10][20] + 30 // æœŸæœ›ç»“æœ 60
const r3 = add[100][200][300] + 400 // æœŸæœ›ç»“æœ 1000

// é“¾å¼è°ƒç”¨
function chain (value) {
  const handler = {
    get: function(obj, prop) {
      if (prop === 'end') {
        return obj.value
      }
      if (typedof window[prop] === 'function'
    )
      {
        obj.value = window[prop](obj.value)
        return proxy
      }
      return obj[prop]
    }
  }
  const proxy = new Proxy({ value }, handler)
  return proxy
}
```

```js
// å¾ªç¯è½¬é€’å½’
// å®ç°ä¸€ä¸ªæ±‚å’Œå‡½æ•°ï¼Œä¸èƒ½ä½¿ç”¨å¾ªç¯ï¼Œä¸èƒ½ä½¿ç”¨æ•°ç»„æ–¹æ³•
function sum(arr, i = 0) {
  if (i >= arr.length) {
    return 0
  }
  return arr[i] + sum(arr, i + 1)
}

function demo1() {
  // å‰é¢çš„ä»£ç 
  for (åˆå§‹ä»£ç ; æ¡ä»¶; åç½®ä»£ç ) {
    // å¾ªç¯ä½“
  }
  // åé¢çš„ä»£ç 
}

function demo2() {
  // å‰é¢çš„ä»£ç 
  åˆå§‹ä»£ç 

  function _m() {
    if (!æ¡ä»¶) {
      return
    }
    // å¾ªç¯ä½“
    åç½®ä»£ç 
    _m()
  }

  _m()
  // åé¢çš„ä»£ç 
}

function demo1(arr) {
  let sum = 0
  for (let i = 0; i < arr.length; i++) {
    sum += arr[i]
  }
  return sum
}

function demo2(arr) {
  let sum = 0
  let i = 0

  function _m() {
    if (i >= arr.length) {
      return
    }
    sum += arr[i++]
    _m()
  }

  _m()
  return sum
}
```

```js
// ç›‘å¬å…ƒç´ çš„é‡å åº¦
const ob = new IntersectionObserver(entries => {
  const entry = entries[0]
  if (entry.isIntersecting) {
    console.log('åŠ è½½æ›´å¤š')
  }
}, {
  root: null
  threshold: 0
})
const dom = document.querySelector('.loading')
ob.observe(dom)
```

```js
// åˆ†æ—¶å‡½æ•°çš„å°è£…
const tasks = Array.from({ length: 300000 }, (_, i) => {
  const div = document.createElement('div')
  div.innerText = i
  document.body.appendChild(div)
})

const btn = document.querySelector('.btn')
btn.onclick = () => {
  // for (const task of tasks) {
  //   task()
  // }
  performTasks(tasks)
}

// æµè§ˆå™¨çš„å¾®ä»»åŠ¡é˜Ÿåˆ—
function performTasks(tasks) {
  if (tasks.length === 0) {
    return
  }
  let i = 0

  // æ¯ä¸€æ¬¡çš„æ‰§è¡Œ
  function _run() {
    requestIdleCallback((idle) => {
      while (i < tasks.length && idle.timeRemaining() > 0) {
        tasks[i++]()
      }
      _run()
    })
  }

  _run()
}

// è‡ªå®šä¹‰è°ƒåº¦å™¨
btn.onclick = () => {
  const scheduler = (chunkTask) => {
    setTimeout(() => {
      const now = performance.now()
      chunkTask(() => performance.noew() - now < 1)
    }, 1000)
  }
  performTasks(tasks, scheduler)
}

function performTasks(tasks, scheduler) {
  if (tasks.length === 0) {
    return
  }
  let i = 0

  // æ¯ä¸€æ¬¡çš„æ‰§è¡Œ
  function _run() {
    scheduler((goOn) => {
      while (i < tasks.length && goOn()) {
        tasks[i++]()
      }
      _run()
    })
  }

  _run()
}

function idlePerformTasks(tasks) {
  const scheduler = (chunkTask) => {
    requestIdleCallback((deadline) => {
      chunkTask(() => deadline.timeRemaining() > 0)
    })
  }
  performanceTasks(tasks, scheduler)
}
```

```text
éä¸¥æ ¼ç›¸ç­‰
  ä¸¤ç«¯ç±»å‹ä¸€è‡´
    ç­‰åŒäºä¸¥æ ¼ç›¸ç­‰
  ä¸¤ç«¯ç±»å‹ä¸ä¸€è‡´
    ç‰¹æ®Š
      null == undefined
      null === undefined
      null == 0
      null == ''
      undefined == ''
    è§„åˆ™ 1 å‡ä¸ºåŸå§‹ï¼Œè½¬æ•°å­—
    è§„åˆ™ 2 æœ‰å¯¹è±¡ï¼Œè½¬åŸå§‹

1. ç›¸ç­‰æ¯”è¾ƒï¼ˆ==ï¼‰
  1. å¦‚æœä¸¤ä¸ªæ“ä½œæ•°ç±»å‹ç›¸åŒï¼Œæ‰§è¡Œä¸¥æ ¼æ¯”è¾ƒ
  2. å¦‚æœä¸¤ä¸ªæ“ä½œæ•°ç±»å‹ä¸åŒï¼Œåˆ™è¿›è¡Œ**ç±»å‹è½¬æ¢å**å†è¿›è¡Œæ¯”è¾ƒï¼Œè§„åˆ™å¦‚ä¸‹ï¼š
    1. å¦‚æœä¸€ä¸ªæ“ä½œæ•°æ˜¯æ•°å€¼ï¼Œå¦ä¸€ä¸ªæ“ä½œæ•°æ˜¯å­—ç¬¦ä¸²ï¼Œåˆ™å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•°å€¼ï¼Œç„¶åè¿›è¡Œæ¯”è¾ƒ
    2. å¦‚æœä¸€ä¸ªæ“ä½œæ•°åå¸ƒå°”å€¼ï¼Œåˆ™å°†å¸ƒå°”å€¼è½¬æ¢ä¸ºæ•°å€¼ï¼Œç„¶åè¿›è¡Œæ¯”è¾ƒ
    3. å¦‚æœä¸€ä¸ªæ“ä½œæ•°åå¯¹è±¡ï¼Œå¦ä¸€ä¸ªæ“ä½œæ•°åæ•°å€¼æˆ–å­—ç¬¦ä¸²ï¼Œåˆ™å°†å¯¹è±¡è½¬æ¢ä¸ºåŸå§‹å€¼ï¼Œç„¶åè¿›è¡Œæ¯”è¾ƒ

å¦‚æœä¸€ä¸ªæ“ä½œæ•°æ˜¯å¯¹è±¡ï¼Œå¦ä¸€ä¸ªæ“ä½œæ•°æ˜¯å­—ç¬¦ä¸²æˆ–è€…æ•°å­—ï¼Œä¼šé¦–å…ˆè°ƒç”¨å¯¹è±¡çš„ valueOf æ–¹æ³•ï¼Œå°†å¯¹è±¡è½¬åŒ–ä¸ºåŸºæœ¬ç±»å‹ï¼Œå†è¿›è¡Œæ¯”è¾ƒ
å½“valueOf è¿”å›çš„ä¸æ˜¯åŸºæœ¬ç±»å‹çš„æ—¶å€™ï¼Œæ‰ä¼šè°ƒç”¨ toString æ–¹æ³•

Object.is å’Œ === è§„åˆ™å¦‚ä¸‹
Object.is å’Œ === åœ¨æ¯”è¾ƒä¸¤ä¸ªå€¼æ—¶éƒ½ä¸ä¼šè¿›è¡Œç±»å‹è½¬æ¢

Object.isï¼š
  å½“æ¯”è¾ƒ NaN æ˜¯ï¼ŒObject.is(NaN,NaN) è¿”å› true
  å½“æ¯”è¾ƒ +0 å’Œ -0 æ—¶ï¼ŒObject.is(+0,-0) è¿”å› falseï¼Œå› ä¸ºå®ƒèƒ½åŒºåˆ†æ­£é›¶å’Œè´Ÿé›¶

===ï¼š
  NaN === NaN è¿”å› falseï¼Œ å› ä¸º NaN ä¸ç­‰äºä»»ä½•å€¼ï¼ŒåŒ…æ‹¬å®ƒè‡ªèº«
  å¯¹äº +0 å’Œ -0ï¼Œ+0 === -0 è¿”å› trueï¼Œå› ä¸ºä¸¥æ ¼ç›¸ç­‰ä¸åŒºåˆ†æ­£è´Ÿ
```

```scss
// ç”¨Sassç®€åŒ–åª’ä»‹æŸ¥è¯¢
// 1. å‡½æ•°çš„å‚æ•°é»˜è®¤å€¼
@mixin flex {
  display: flex;
  align-items: center;
  justify-content: center;
}

.container {
  @include flex;
}

// 2. å‡½æ•°çš„å‚æ•°é»˜è®¤å€¼ + å†…å®¹å—
@mixin flex($layout) {
  display: flex;
  align-items: $layout;
  justify-content: center;
  @content;
}

.container {
  @include flex(start) {
    gap: 20px;
  }
}

// 3. å‡½æ•°çš„å‚æ•°é»˜è®¤å€¼ + å“åº”å¼
@mixin respondTo($breakname) {
  @if $breakname == 'phone' {
    @media (min-width: 320px) and (max-width: 480px) {
      @content;
    }
  }
  @if $breakname == 'pad' {
    @media (min-width: 481px) and (max-width: 768px) {
      @content;
    }
  }
}

.header {
  width: 100%;
  @include respondTo('phone') {
    height: 50px;
  }
  @include respondTo('pad') {
    height: 60px;
  }
}

// 4. åª’ä»‹æŸ¥è¯¢çš„å‚æ•°æ˜¯å¯¹è±¡
$breakpoints= {
  phone: (320px, 480px);
  pad: (481px, 768px);
  notebook: (769px, 1024px);
  desktop: (1025px, 1280px);
  tv: 1281px;
}

@mixin respondTo($breakname) {
  $bp: map-get($breakpoints, $breakname);
  @if type-of($bp) == 'list' {
    $min: nth($bp, 1);
    $max: nth($bp, 2);
    @media (min-width: $min) and (max-width: $max) {
      @content;
    }
  } @else {
    @media (min-width: $bp) {
      @content;
    }
  }
}
```

```text
https://juejin.cn/post/7362587412067385354
æ‹–æ‹½API
<div draggable="true></div>


dragstart
e.dataTransfer.effect = 'move'
dragend
dragenter
```

```js
const o = (function () {
  const obj = {
    a: 1,
    b: 2,
  }
  return {
    get: function (k) {
      return obj[k]
    },
  }
})()
// é—­åŒ…ä»£ç çš„ææƒæ¼æ´
// å¦‚ä½•åœ¨ä¸æ”¹å˜ä¸Šé¢ä»£ç çš„æƒ…å†µä¸‹ï¼Œä¿®æ”¹ obj å¯¹è±¡
Object.defineProperty(Object.prototype, 'abc', {
  get() {
    return this
  },
})
console.log(o.get('abc'))

// è§£å†³
const o = (function () {
  // var obj = Object.create(null)
  const obj = {
    a: 1,
    b: 2,
  }
  // Object.setPropertytypeOf(obj, null)
  return {
    get: function (k) {
      if (obj.hasOwnProperty(k)) {
        return obj[k]
      }
    },
  }
})()
```

```js
let a = 5
let b = 6

// â‘ 
const temp = b
b = a
a = temp

// â‘¡
;[a, b] = [b, a]

// â‘¢ æ•°å­—
a = a + b
b = a - b
a = a - b
// a = b + (b = a) - b

// â‘£ æ•´æ•°
a = a ^ b
b = a ^ b
a = a ^ b
```

```js
// æ‰‹å†™ call
Function.prototype.myCall = function (ctx, ...args) {
  ctx = ctx === null || ctx === undefined ? globalThis : Object(ctx)
  const fn = this
  const key = Symbol()
  Object.defineProperty(ctx, key, {
    value: fn,
    enumerable: false,
  })
  const r = ctx[key](...args)
  delete ctx[key]
  return r
}

// æ‰‹å†™ bind
Function.prototype.myBind = function (ctx, ...args) {
  const fn = this
  return function (...restArgs) {
    if (new.target) {
      return new fn(...args, ...restArgs)
    }
    return fn.apply(ctx, [...args, ...restArgs])
  }
}
```

```js
// å¹¶å‘è¯·æ±‚
function concurRequest(urls, maxNum) {
  if (urls.length === 0) return Promise.resolve([])
  return new Promise((resolve) => {
    let index = 0 // æŒ‡å‘ä¸‹ä¸€æ¬¡è¯·æ±‚çš„ url å¯¹åº”çš„ä¸‹æ ‡
    const result = [] // å­˜å‚¨æ‰€æœ‰è¯·æ±‚çš„ç»“æœ
    let count = 0 // å½“å‰å®Œæˆçš„è¯·æ±‚æ•°é‡
    async function _request() {
      const i = index
      const url = urls[index]
      index++
      try {
        const resp = await fetch(url)
        result[i] = resp
      } catch (err) {
        result[i] = err
      } finally {
        count++
        if (count === urls.length) {
          resolve(result)
        }
        if (index < urls.length) {
          _request()
        }
      }
    }

    for (let i = 0; i < Math.min(urls.length, maxNum); i++) {
      _request()
    }
  })
}

/**
 * å¯ä»¥é‡è¯•çš„è¯·æ±‚
 * å‘å‡ºè¯·æ±‚ï¼Œè¿”å› Promise
 * @param {string} url è¯·æ±‚åœ°å€
 * @param {number} maxCount æœ€å¤§é‡è¯•æ¬¡æ•°
 */
function request(url, maxCount = 5) {
  return fetch(url).catch((err) => {
    maxCount <= 0 ? Promise.reject(err) : request(url, maxCount - 1)
  })
}
```

```ts
// å¯¹æŸ¯é‡ŒåŒ–è¿›è¡Œç±»å‹æ ‡æ³¨
type Curried<A extends any[], R> = A extends [] ? () => R : A extends [infer P] ? (x: P) => R : A extends [infer P, ...infer Rest] ? (x: p) => Curried<Rest, R> : never

declare function curry<A extends any[], R> (fn: (...args: A) => R): Curried<A, R>

æŸ¯é‡ŒåŒ–æ˜¯å°†æ¥æ”¶å¤šä¸ªå‚æ•°çš„å‡½æ•°è½¬æ¢æˆæ¥æ”¶ä¸€ä¸ªå•ä¸€å‚æ•°çš„å‡½æ•°

ç»„åˆæ˜¯å°†ä¸¤ä¸ªæˆ–å¤šä¸ªå‡½æ•°ç»„åˆæˆä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œå¹¶ä¸”ç»„åˆçš„å‡½æ•°ä»å³åˆ°å·¦æ‰§è¡Œ

ç®¡é“å‡½æ•°ä¸ç»„åˆå‡½æ•°
å…±åŒç‚¹ï¼šéƒ½å¯ä»¥å°†ä¸¤ä¸ªæˆ–å¤šä¸ªå‡½æ•°ç»„åˆæˆä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œæ–°å‡½æ•°çš„æ‰§è¡Œç»“æœç­‰äºè¿ç»­è°ƒç”¨å¤šä¸ªåŸå‡½æ•°çš„æ‰§è¡Œç»“æœ
åŒºåˆ«ï¼šç»„åˆå‡½æ•°æ˜¯ä»å³åˆ°å·¦æ‰§è¡Œï¼Œè€Œç®¡é“å‡½æ•°æ˜¯ä»å·¦åˆ°å³æ‰§è¡Œ

function pipe (...fns) {
  return function(x) {
    return fns.reduce(function(acc, fn) {
      return fn(acc)
    }, x)
  }
}
```

```text
# æŸ¥è¯¢å½“å‰ä½¿ç”¨çš„é•œåƒæº
npm get registry

# è®¾ç½®ä¸ºæ·˜å®é•œåƒæº
npm config set registry https://registry.npmmirror.com/

# è¿˜åŸä¸ºå®˜æ–¹é•œåƒæº
npm config set registry https://registry.npmjs.org/


github æ…¢
C:\Windows\System32\drivers\etc\hosts
140.82.114.4 github.com
199.232.69.194 github.global.ssl.fastly.net
```

```js
// æ„é€ å‡½æ•°å†…å’Œå¤–çš„æ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«
class Person {
  constructor (name) {
    this.name = name
    this.say1 = () => {
      console.log('æˆ‘åœ¨é‡Œé¢', this.name)
    }
  }

  say2 () {
    console.log('æˆ‘åœ¨å¤–é¢', this.name)
  }
}

const A = new Person('A')
const B = new Person('B')

A.say1()
A.say2()
A.say1 === B.say1
A.say2 === B.say2

â‘ 
åœ¨æ„é€ å‡½æ•°å†…éƒ¨å®šä¹‰çš„æ–¹æ³•ï¼Œå®é™…ä¸Šæ˜¯åœ¨ ** æ¯ä¸ªå¯¹è±¡å®ä¾‹ ** ä¸Šåˆ›å»ºäº†ä¸€ä¸ªæ–°çš„å‡½æ•°
åœ¨æ„é€ å‡½æ•°å¤–éƒ¨å®šä¹‰çš„æ–¹æ³•æ˜¯åœ¨
Person
çš„åŸå‹å¯¹è±¡(Person.prototype)
ä¸Šåˆ›å»ºçš„

â‘¡
åœ¨æ„é€ å‡½æ•°å†…éƒ¨å®šä¹‰çš„æ–¹æ³•æ˜¯å„ä¸ªå®ä¾‹å¯¹è±¡ç‹¬æœ‰çš„
åœ¨æ„é€ å‡½æ•°å¤–éƒ¨å®šä¹‰çš„æ–¹æ³•ï¼Œæ‰€æœ‰Personå®ä¾‹å…±äº«çš„

â‘¢
åœ¨æ„é€ å‡½æ•°å†…éƒ¨å®šä¹‰çš„æ–¹æ³•å¯ä»¥è¢«`Object.keys()`
éå†
åœ¨æ„é€ å‡½æ•°å¤–éƒ¨å®šä¹‰çš„æ–¹æ³•ä¸èƒ½è¢«`Object.keys()`
éå†
```

```js
// å‡½æ•°çš„length
function fun1(a) {}

function fun2(b = 'a', a) {}

function fun3(a, b = 'a') {}

function fun4(a, ...arr) {}

console.log(fun1.length)
console.log(fun2.length)
console.log(fun3.length)
console.log(fun4.length)
```

```text
parseIntå’ŒMath.flooræœ‰ä»€ä¹ˆåŒºåˆ«
Math.floor()
æ— è®ºæ­£è´Ÿï¼ŒMath.flooréƒ½åªæ˜¯ç®€å•åœ°å°†ä¸€ä¸ªæ•°å‘ä¸‹å–æ•´åˆ°æœ€æ¥è¿‘çš„æ•´æ•°
å®ƒåªæ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼šä½ æƒ³è¦å‘ä¸‹å–æ•´çš„æ•°

Math.floor(-4.05)
parseInt(-4.05)

parseIntï¼šå‘é›¶å–æ•´
å¯¹äºè´Ÿæ•°ï¼Œä¼š ** å‘ä¸Šå–æ•´ ** åˆ°æœ€æ¥è¿‘çš„æ•´æ•°
å¯¹äºæ­£æ•°ï¼Œä¼š ** å‘ä¸‹å–æ•´åˆ° ** æœ€æ¥è¿‘çš„æ•´æ•°

parseInt
ä¼šå¿½ç•¥ä»»ä½•æ•°å­—åé¢çš„éæ•°å­—å­—ç¬¦
parseInt('4.05abc') // 4
Math.floor('4.05abc') // NaN

parseInt
å¤„ç†ä¸åŒçš„è¿›åˆ¶æ•°æ®,å°†å…¶ä»–è¿›åˆ¶è½¬æ¢ä¸ºåè¿›åˆ¶
parseInt('11', 2)  // ç»“æœæ˜¯3ï¼Œå› ä¸ºåœ¨2è¿›åˆ¶ä¸­ï¼Œ11è¡¨ç¤ºçš„æ˜¯åè¿›åˆ¶ä¸­çš„3

;['1', '2', '3'].map(parseInt) // parseInt(item,index,arr)

parseInt
ç¬¬äºŒä¸ªå‚æ•°ï¼š
  1.  ä¸ä¼ é€’ã€undefinedã€0  è‡ªåŠ¨
    1ï¼‰0x åå…­è¿›åˆ¶
    2ï¼‰0 åè¿›åˆ¶ / å…«è¿›åˆ¶
    3ï¼‰åè¿›åˆ¶
  2. æ— æ•ˆè¿›åˆ¶ï¼ˆ2 - 36 æœ‰æ•ˆï¼‰ NaN
  3. æœ‰æ•ˆè¿›åˆ¶
      æ­£å¸¸è½¬æ¢

BigInt('0b' + a)
num.toString(2) // åè¿›åˆ¶è½¬æ¢ä¸ºäºŒè¿›åˆ¶
```

```css
/* å›¾ç‰‡è¾¹æ¡† */
border-image-source
border-image-slice
border-image-repeat
```

```js
// å¦‚ä½•å°† class è½¬æ¢ä¸º function
// åˆå§‹åŒ–ä¹‹å‰ä¸èƒ½new
class Example {
  constructor(name) {
    this.name = name
  }

  func() {
    console.log(this.name)
  }
}

;('use strict') // ä¸¥æ ¼æ¨¡å¼
function Example(name) {
  // éªŒè¯ this çš„æŒ‡å‘
  if (!(this instanceof Example)) {
    throw new TypeError('Class constructor Example cannot be invoked without "new"')
  }
  this.name = name
}

// ä¸å¯æšä¸¾
Object.defineProperty(Example.prototype, 'func', {
  value: function () {
    // ä¸å¯é€šè¿‡ new è°ƒç”¨
    if (!(this instanceof Example)) {
      throw new TypeError('Class constructor Example cannot be invoked without "new"')
    }
    console.log(this.name)
  },
  enumerable: false,
})
```

```js
// å­—ç¬¦ä¸²æ¯”è¾ƒ
/**
 * æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²çš„å¤§å°
 * ä¸¤ä¸ªå­—ç¬¦ä¸²éƒ½æ˜¯ç”¨-è¿æ¥çš„æ•°å­—ï¼Œæ¯”å¦‚1-2-33-41-5
 * æ¯”è¾ƒæ–¹å¼æ˜¯ä»å·¦åˆ°å³ï¼Œä¾æ¬¡æ¯”è¾ƒæ¯ä¸ªæ•°å­—çš„å¤§å°ï¼Œé‡åˆ°ç›¸ç­‰çš„æ•°å­—ç»§ç»­å¾€åæ¯”è¾ƒï¼Œé‡åˆ°ä¸åŒçš„æ•°å­—ç›´æ¥å¾—åˆ°æ¯”è¾ƒç»“æœ
 * s1 > s2 return 1
 * s1 < s2 return -1
 * s1 === s2 return 0
 */
function compare(s1, s2) {
  while (1) {
    const iter1 = walk(s1)
    const iter2 = walk(s2)
    if (iter1.done && iter2.done) {
      return 0
    } else if (n1.done) {
      return -1
    } else if (n2.done) {
      return 1
    } else if (n1.value > n2.value) {
      return 1
    } else if (n1.value < n2.value) {
      return -1
    } else {
      continue
    }
  }
}

function* walk(str) {
  let n = ''
  for (let i = 0; i < str.length; i++) {
    const char = str[i]
    if (char === '-') {
      if (n) {
        yield +n
        n = ''
      }
    } else {
      n += char
    }
  }
  if (n) {
    yield +n
  }
}
```

```ts
type Props = {
  onClick: (e: MouseEvent) => void
  onDrag: (e: DragEvent) => void
  news1Types: string
  class2Name: string
}

type t1 = keyof Props
type t2 = keyof Props & {}
type t3 = keyof Props & `on${string}`
```

```js
æ‰§è¡Œä¸Šä¸‹æ–‡
// â‘ 
var name = 'global'
const obj = {
  name: 'LBJhui',
  fun1() {
    ;(() => {
      console.log(this.name)
    })()
  },
  fun2: () => {
    console.log(this.name)
  },
}
obj.fun1()
obj.fun2()

// â‘¡
var length = 1

function fun() {
  console.log(this.length)
}

let arr = [fun, 'a', 'b']
arr[0]()
let fun2 = arr[0]
fun2()

// â‘¢
var name = 'LBJhui'
let obj = {
  name: 'objLBJhui',
  say: function () {
    console.log(this.name)
  },
}
obj.say()
setTimeout(obj.say, 10)

// â‘£
var name = 'LBJhui'

function outerFunction() {
  this.name = 'outerFunction'
  return () => {
    console.log(this.name)
  }
}

const obj = {
  name: 'objLBJhui',
  innerFunction1: outerFunction(),
  innerFunction2: () => {
    console.log(this.name)
  },
}
obj.innerFunction1()
obj.innerFunction2()
```

```text
object å’Œ map æœ‰ä»€ä¹ˆç›¸åŒç‚¹å’Œä¸åŒç‚¹
åˆ›å»ºæ–¹å¼çš„åŒºåˆ«
  é€šè¿‡å­—é¢é‡åˆ›å»º Objectã€é€šè¿‡æ„é€ å‡½æ•°åˆ›å»º Object
  é€šè¿‡æ„é€ å‡½æ•°åˆ›å»º Map
key çš„ç±»å‹ä¸åŒ
  Objectï¼šå¯¹è±¡çš„é”®æ˜¯å­—ç¬¦ä¸²æˆ–è€…Symbol
  Mapï¼šMapå¯ä»¥ä½¿ç”¨ä»»ä½•ç±»å‹çš„å€¼ä½œä¸ºé”®ï¼ŒåŒ…æ‹¬å¯¹è±¡ã€å‡½æ•°ã€åŸå§‹å€¼ç­‰ã€‚
key çš„é¡ºåº
  Objectï¼škeyçš„é¡ºåºä¸æ’å…¥é¡ºåºæ— å…³
  Mapï¼škeyçš„é¡ºåºå°±æ˜¯æ’å…¥çš„é¡ºåº
```

```text
é«˜é˜¶å‡½æ•°ï¼šå¯ä»¥æ¥æ”¶ä¸€ä¸ªæˆ–å¤šä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œå¹¶ä¸”è¿”å›ä¸€ä¸ªå‡½æ•°çš„å‡½æ•°ç§°ä¸ºé«˜é˜¶å‡½æ•°
  1.ä»£ç å¤ç”¨
  2.æ¨¡å—åŒ–å’Œè§£è€¦
  3.å»¶è¿Ÿæ‰§è¡Œ
  4.å‡½æ•°ç»„åˆ

ç”¨é€”ï¼š
  1.æ•°ç»„æ“ä½œ
  2.å‡½æ•°å¼ç¼–ç¨‹
  3.å¼‚æ­¥ç¼–ç¨‹
  4.ä»£ç é‡æ„å’Œä¼˜åŒ–
  5.äº‹ä»¶ç›‘å¬

ä½¿ç”¨é«˜é˜¶å‡½æ•°æ—¶éœ€è¦è€ƒè™‘å“ªäº›æ€§èƒ½å› ç´ 
  1.å‡½æ•°è°ƒç”¨å¼€é”€
  2.å†…å­˜ä½¿ç”¨
  3.åƒåœ¾å›æ”¶
  4.å¹¶è¡Œå’Œå¼‚æ­¥å¤„ç†
  5.ç¼–è¯‘å™¨ä¼˜åŒ–
```

```text
å¦‚ä½•åœ¨ä¸åŒè®¾å¤‡é—´åŒæ­¥ç”¨æˆ·çš„æœ¬åœ°å­˜å‚¨æ•°æ®
  1.äº‘åŒæ­¥æœåŠ¡
  2.websockets
  3.åˆå¹¶åŒæ­¥ç­–ç•¥
  4.å¢é‡åŒæ­¥
  5.å‘¨æœŸæ€§å…¨é‡åŒæ­¥å¢é‡æ›´æ–°
  6.ç¬¬ä¸‰æ–¹æœåŠ¡
  7.ç«¯åˆ°ç«¯åŠ å¯†
```

```text
å¦‚ä½•å¤„ç†è·¨åŸŸè¯·æ±‚ä¸­çš„å®‰å…¨é—®é¢˜
  1.CORSç­–ç•¥
  2.HTTPS
  3.é¢„æ£€è¯·æ±‚
  4.é™åˆ¶è·¨ç«™è¯·æ±‚ä¼ªé€ 
  5.tokenéªŒè¯
```

```text
ç¦ç”¨äº†jsï¼Œæœ¬åœ°å­˜å‚¨è¿˜èƒ½ä½¿ç”¨å—
ä¸èƒ½ä½¿ç”¨
  1.æŠ€æœ¯ä¾èµ–
  2.æ•°æ®äº¤äº’é€šé“å°é”
  3.å®‰å…¨å’Œéšç§è€ƒé‡
```

```js
// åŸå‹æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•
function Person() {
  Person.say = function () {
    console.log('a')
  }
  this.say = function () {
    console.log('b')
  }
}

Person.prototype.say = function () {
  console.log('c')
}

Person.say = function () {
  console.log('d')
}

Person.say()
var p = new Person()
p.say()
Person.say()
```

```ts
// å®ç°Optional
interface Article {
  title: string
  content: string
  tags: string[]
  comments: string[]
  likeCount: number
}

type Optional<T, K extends keyof T> = Omit<T, K> & Partial<Pick<T, K>>

type CreateArticleOptions = Optional<Article, 'tags' | 'comments'>

// å®ç°GetOptionals
interface Article {
  title: string
  content: string
  tags: string[]
  comments?: string[]
  likeCount?: number
}

type GetOptional<T> = {
  [P in keyof T]: T[P]
}

type GetOptional1<T> = {
  [P in keyof T as `get${Capitalize<P & string>}`]: T[P]
}
type GetOptional2<T> = {
  [P in keyof T as never]: T[P]
}

Required<Article>
type GetOptional<T> = {
  [P in keyof T as T[P] extends Required<T>[p] ? never : P]: T[P]
}
```

```js
ä¸­æ–‡è¾“å…¥æ³•å¯¼è‡´çš„é«˜é¢‘äº‹ä»¶
// å¤šä¸ªæŒ‰é”®å¯¹åº”ä¸€ä¸ªå­—ç¬¦
dom.addEventListener('compositionstart', function (e) {})
dom.addEventListener('compositionend', function (e) {})
```

```text
node çš„æ¨¡å—æŸ¥æ‰¾ç­–ç•¥
  æ–‡ä»¶æŸ¥æ‰¾
  æ–‡ä»¶å¤¹æŸ¥æ‰¾
    é»˜è®¤ index.js
    å¯é€šè¿‡æ–‡ä»¶å¤¹ä¸­ package.json ä¸­ main å­—æ®µä¿®æ”¹é…ç½®
  å†…ç½®æ¨¡å—
  ç¬¬ä¸‰æ–¹
    node_modules
```

```text
Reflect
Proxy å’Œ DefineProperty
vue 3.0 ä½¿ç”¨ proxy æ›¿ä»£äº† vue 2.x ä¸­ä½¿ç”¨çš„ Object.defineProperty æ¥å®ç°å“åº”å¼ç³»ç»Ÿï¼Œè¿™ç§å˜åŒ–æœ‰ä»¥ä¸‹å‡ ä¸ªåŸå› ï¼š
1.æ›´å¼ºå¤§çš„æ‹¦æˆªèƒ½åŠ›:Proxy æä¾›äº†æ›´ä¸°å¯Œçš„æ‹¦æˆªå™¨,å¯ä»¥æ‹¦æˆªæ›´å¤šçš„çš„æ“ä½œ,åŒ…æ‹¬å±æ€§çš„è¯»å–ã€è®¾ç½®ã€åˆ é™¤ã€å‡½æ•°è°ƒç”¨ã€inè¿ç®—ç¬¦ç­‰ã€‚è¿™ä½¿å¾—Vueå¯ä»¥æ›´å¥½åœ°è·Ÿè¸ªæ•°æ®çš„å˜åŒ–,å¹¶åœ¨ä¹‹å‰æ— æ³•æ‹¦æˆªçš„åœºæ™¯ä¸‹æä¾›æ›´ç²¾ç¡®çš„å“åº”å¼è¡Œä¸ºã€‚
2.æ›´ç›´è§‚å’Œé«˜æ•ˆçš„ä»£ç :Proxy çš„æ‹¦æˆªèƒ½åŠ›æ›´åŠ ç›´è§‚å’Œçµæ´»,å¯ä»¥é€šè¿‡ç®€å•ä¸”å¯è¯»æ€§æ›´é«˜çš„ä»£ç å®ç°å¤æ‚çš„æ“ä½œã€‚ç›¸æ¯”ä¹‹ä¸‹,ä½¿ç”¨ Object.defineProperty æ‰‹åŠ¨åœ°å¤„ç†æ¯ä¸ªå±æ€§çš„getterå’Œsetteræ›´åŠ ç¹çå’Œå†—é•¿ã€‚
3.æ›´å¥½çš„æ€§èƒ½å’Œæ›´å°‘çš„å†…å­˜æ¶ˆè€—:Proxy é‡‡ç”¨ä»£ç†å¯¹è±¡çš„æ–¹å¼,åªéœ€è¦åœ¨è¯»å–å’Œä¿®æ”¹å±æ€§æ—¶è§¦å‘æ‹¦æˆªå™¨,è€Œä¸éœ€è¦è·å–å’Œè®¾ç½®å±æ€§çš„ç‰¹æ€§ã€‚è¿™ç§æ–¹å¼å¯ä»¥å¸¦æ¥æ›´å¥½çš„æ€§èƒ½,å¹¶ä¸”ä¸ä¼šå¯¹æ¯ä¸ªå±æ€§éƒ½æ·»åŠ é¢å¤–çš„setterå’Œgetterã€‚
4.æ”¯æŒåµŒå¥—å¯¹è±¡çš„å“åº”å¼:ä½¿ç”¨ Proxy å¯ä»¥å®ç°å¯¹åµŒå¥—å¯¹è±¡çš„å“åº”å¼å¤„ç†,è€Œ Object.defineProperty åœ¨å¤„ç†åµŒå¥—å¯¹è±¡æ—¶éœ€è¦éå†å’Œé€’å½’æ“ä½œ,ç›¸æ¯”ä¹‹ä¸‹,Proxy æ›´åŠ é«˜æ•ˆå’Œç®€æ´ã€‚
æ€»è€Œè¨€ä¹‹,Vue 3.0é€‰æ‹©ä½¿ç”¨ Proxy æ›¿ä»£ Object.defineProperty æ˜¯ä¸ºäº†æä¾›æ›´å¼ºå¤§ã€ç›´è§‚ã€é«˜æ•ˆçš„å“åº”å¼èƒ½åŠ›,å¹¶ä¸”èƒ½å¤Ÿæ”¯æŒæ›´å¤æ‚çš„åœºæ™¯,åŒæ—¶å¸¦æ¥æ›´å¥½çš„æ€§èƒ½å’Œæ›´å°‘çš„å†…å­˜æ¶ˆè€—ã€‚è¿™ä½¿å¾—Vue3.0åœ¨å¼€å‘ä½“éªŒå’Œæ€§èƒ½æ–¹é¢å‡æœ‰å¾ˆå¤§çš„æå‡ã€‚

vue2å’Œ3æœ‰ä»€ä¹ˆåŒºåˆ«
  1.ç”¨ç»„åˆå¼apiæ›¿æ¢é€‰é¡¹å¼apiï¼Œæ–¹ä¾¿é€»è¾‘æ›´åŠ çš„èšåˆ
  2.ä¸€äº›ç»†èŠ‚çš„ä½¿ç”¨ç‚¹æ”¹å˜
    1.å› ä¸ºæ”¹æˆç»„åˆå¼apiæ‰€ä»¥æ²¡æœ‰this
    2.ç”Ÿå‘½å‘¨æœŸæ²¡æœ‰createï¼Œsetupç­‰åŒäºcreateï¼Œå¸è½½æ”¹æˆunmount
    3.vue3ä¸­v-ifé«˜äºv-forçš„ä¼˜å…ˆçº§
    4.æ ¹å®ä¾‹çš„åˆ›å»ºä»new appå˜æˆäº†createAppæ–¹æ³•
    5.ä¸€äº›å…¨å±€æ³¨å†Œï¼Œæ¯”å¦‚mixinï¼Œæ³¨å†Œå…¨å±€ç»„ä»¶ï¼Œuseæ”¹æˆäº†ç”¨appå®ä¾‹è°ƒç”¨ï¼Œè€Œä¸æ˜¯vueç±»è°ƒç”¨
    6.æ–°å¢äº†ä¼ é€é—¨teleportç»„ä»¶
    7.templateæ¨¡æ¿å¯ä»¥ä¸åŒ…åœ¨ä¸€ä¸ªæ ¹divé‡Œ

  1.å“åº”å¼åŸç†æ”¹æˆäº†ç”¨proxyï¼Œè§£å†³äº†æ•°ç»„æ— æ³•é€šè¿‡ä¸‹æ ‡ä¿®æ”¹ï¼Œæ— æ³•ç›‘å¬åˆ°å¯¹è±¡å±æ€§çš„æ–°å¢å’Œåˆ é™¤çš„é—®é¢˜ã€‚ä¹Ÿæå‡äº†å“åº”å¼çš„æ•ˆç‡
  2.å¯ä»¥é¢å¤–å™è¿°vue3å¹¶ä¸æ˜¯å®Œå…¨æŠ›å¼ƒäº†definePropertyï¼Œé€šè¿‡reactiveå®šä¹‰çš„å“åº”å¼æ•°æ®ä½¿ç”¨proxyåŒ…è£…å‡ºæ¥ï¼Œè€Œrefè¿˜æ˜¯ç”¨çš„definePropertyå»ç»™ä¸€ä¸ªç©ºå¯¹è±¡ï¼Œå®šä¹‰äº†ä¸€ä¸ªvalueå±æ€§æ¥åšçš„å“åº”å¼
  3.ç»„åˆå¼apiçš„å†™æ³•ä¸‹ï¼Œæºç æ”¹æˆäº†å‡½æ•°å¼ç¼–ç¨‹ï¼Œæ–¹ä¾¿æŒ‰éœ€å¼•å…¥ï¼Œå› ä¸ºtree-shakingåŠŸèƒ½å¿…é¡»é…åˆæŒ‰éœ€å¼•å…¥å†™æ³•ã€‚æ‰€ä»¥vue3æ›´å¥½åœ°é…åˆtree-shakingèƒ½è®©æ‰“åŒ…ä½“ç§¯æ›´å°
  4.æ€§èƒ½ä¼˜åŒ–ï¼Œå¢åŠ äº†é™æ€èŠ‚ç‚¹æ ‡è®°ã€‚ä¼šæ ‡è®°é™æ€èŠ‚ç‚¹ï¼Œä¸å¯¹é™æ€èŠ‚ç‚¹è¿›è¡Œæ¯”å¯¹ï¼Œä»è€Œå¢åŠ æ•ˆç‡
  5.æ­¤å¤–å¤§å®¶å¯ä»¥å™è¿°å…·ä½“æ ‡è®°ç­–ç•¥ï¼Œä»è€Œæå‡è‡ªå·±çš„å°è±¡
```

```text
vue-watch value æ›´æ–° â†’ è§¦å‘å›è°ƒå‡½æ•° â†’ DOM æ›´æ–°
{flush:'pre'}
pre(é»˜è®¤)ï¼šå›è°ƒå‡½æ•°ä¼šåœ¨ DOM æ›´æ–°ä¹‹å‰æ‰§è¡Œ
postï¼šå›è°ƒå‡½æ•°ä¼šåœ¨ DOM æ›´æ–°ä¹‹åæ‰§è¡Œï¼Œåœ¨å®é™…å¼€å‘ä¸­ï¼Œå‡è®¾ä½ å¸Œæœ›æ»šåŠ¨åˆ°é¡µé¢çš„æŸä¸ªä½ç½®å†æ‰§è¡Œå›è°ƒï¼Œå¯ä»¥ç”¨è¿™ä¸ª
sync:å›è°ƒå‡½æ•°ä¼šåŒæ­¥æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯åœ¨å“åº”å¼æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ç«‹å³æ‰§è¡Œ

watch åªèƒ½æ”¶é›†åŒæ­¥ä»£ç çš„ä¾èµ–ï¼Œå¦‚æœå­˜åœ¨ await ä¾èµ–æ”¶é›†ä¼šå‡ºç°é—®é¢˜

â‘ 
watchEffect ä¼šè‡ªåŠ¨è¿½è¸ªå‡½æ•°å†…éƒ¨ä½¿ç”¨çš„æ•°æ®å˜åŒ–ï¼Œæ•°æ®å˜åŒ–æ—¶é‡æ–°æ‰§è¡Œè¯¥å‡½æ•°
watch éœ€è¦æ˜¾ç¤ºåœ°æŒ‡å®šç›‘å¬çš„æ•°æ®ï¼Œè‹¥æŒ‡å®šçš„æ•°æ®å‘ç”Ÿå˜åŒ–ï¼Œé‡æ–°æ‰§è¡Œè¯¥å‡½æ•°

â‘¡
watchEffect çš„å‡½æ•°ä¼šç«‹å³æ‰§è¡Œä¸€æ¬¡ï¼Œå¹¶åœ¨ä¾èµ–çš„æ•°æ®å˜åŒ–æ—¶å†æ¬¡æ‰§è¡Œ
watch çš„å›è°ƒå‡½æ•°åªæœ‰åœ¨ä¾¦å¬çš„æ•°æ®æºå‘ç”Ÿå˜åŒ–æ—¶æ‰ä¼šæ‰§è¡Œï¼Œä¸ä¼šç«‹å³æ‰§è¡Œ

â‘¢
watch å¯ä»¥æ›´ç²¾ç»†åœ°æ§åˆ¶ç›‘å¬è¡Œä¸ºï¼Œå¦‚ deepã€immediateã€flush
watchEffect æ›´é€‚åˆç®€å•çš„åœºæ™¯ï¼Œä¸éœ€è¦é¢å¤–çš„é…ç½®ã€‚ç›¸å½“äºé»˜è®¤å¼€å¯äº† deepã€immediate
```

```vue
<script>
// â‘ 
let clicked = false
watchEffect(() => {
  if (clicked) {
    console.log('æ›´æ–°äº† msg', msg.value)
  }
})

// â‘¡
watchEffect(async () => {
  await fetchData()
  console.log(`ç¬¬${count}æ¬¡è¯·æ±‚æ•°æ®`)
})
</script>
```

```js
ç»Ÿè®¡å­—ç¬¦é¢‘ç‡çš„é£éªšå†™æ³•
const str = 'dlskdlkdsowjfood'
const result = [...str].reduce((a, b) => (a[b]++ || (a[b] = 1), a), {})
```

```ts
// TSä¸­å­—ç¬¦ä¸²ç´¢å¼•å¸¦æ¥çš„ç±»å‹é—®é¢˜
const obj = {
  name: 'LBJhui',
  age: 18,
}

function method(key: string) {
  const v = obj[key as keyof typeof obj]
}
```

```text
ä¸ºä»€ä¹ˆéœ€è¦ç®­å¤´å‡½æ•°
  æ¶ˆé™¤å‡½æ•°äºŒä¹‰æ€§
  æŒ‡ä»¤åºåˆ—
  åˆ›å»ºå®ä¾‹
```

```js
// vue-router
base: '/'

// vue.config.js
publicPath: '/' // æµè§ˆå™¨å¦‚ä½•æ‰¾èµ„æº
```

```css
/* ç³»ç»Ÿä¸»é¢˜ */
@media (prefers-color-scheme: dark) {
}

@media (prefers-color-scheme: light) {
}

/* js */
const match

=
matchMedia

(
'(prefers-color-scheme: dark)'
)
match.
addEventListener

(
'change'
,
(
e

)
=
> {
}

)
```

```js
// éšå¼è½¬æ¢å’Œå¸ƒå°”åˆ¤å®š
;[] + []
;[] + ![]
```

```js
// æ•°å­—æ ¼å¼åŒ–
const str = '10000000000'
const s = str.replace(/\B(?=(\d{3})+$)/g, ',')
```

```scss
// SASSä¸­çš„é¢œè‰²å‡½æ•°
$btnColors: #409eff, #67c23a, #f56c6c, #e6a23c, #909399;

@for $i from 1 through length($btnColors) {
  .btn.type-#{$i} {
    $color: nth($btnColors, $i);
    background: $color;
    color: #fff;

    &:hover {
      background: lighten($color, 10%);
    }

    &:active {
      background: darken($color, 10%);
    }

    &:disabled {
      background: lighten($color, 20%);
    }
  }
}
```

```text
inital: é»˜è®¤å€¼
unset æ¸…é™¤æµè§ˆå™¨æ ·å¼
revert ä½¿ç”¨æµè§ˆå™¨çš„æ ·å¼
```

```text
Cookie ä¸­çš„ SameSiteï¼šç”¨äºé™åˆ¶è·¨ç«™è¯·æ±‚
None:ä¸ä½œä»»ä½•é™åˆ¶ï¼Œä½¿ç”¨è¯¥å€¼å¿…é¡»ä¿è¯ Cookie ä¸º Secureï¼Œå¦åˆ™æ— æ•ˆ
lax:é˜»æ­¢å‘é€ Cookieï¼Œä½†å¯¹è¶…é“¾æ¥æ”¾è¡Œï¼Œé»˜è®¤å€¼
strict:é˜»æ­¢å‘é€ Cookie
```

```html
<!-- å›¾ç‰‡çš„é©¬èµ›å…‹æ•ˆæœ -->
â‘ 
<!-- step 1 -->
<svg>
  <filter id="mosaic">
    <feFlood x="4" y="4" height="2" width="2" />
    <feComposite width="8" heigth="8" />
    <feTile result="a" />
    <feComposite in="SourceGraphic" in2="a" operator="in" />
    <feMorphology operator="dilate" raduis="4" />
  </filter>
</svg>
<!-- step 2 é©¬èµ›å…‹å›¾ç‰‡åº”ç”¨æ»¤é•œ -->
<style>
  img {
    filter: url(#mosaic);
  }
</style>

â‘¡ image-rendering:pixelated å›¾ç‰‡è¦å° vite-imagetools
<style>
  img {
    image-rendering: pixelated;
  }
</style>

<style>
  /* ç£¨ç ‚ç»ç’ƒæ•ˆæœ */
  backdrop-filter: blur (10 px);

  /* é˜´å½±æ•ˆæœ */
  filter: drop-shadow (0 0 5 px #000);
  filter: blur (5 px);
  filter: grayscale (50 %);
  filter: hue-rotate (90 deg);
</style>
```

---

# ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ Typescriptï¼Ÿ

å¢åŠ äº†é™æ€ç±»å‹ ä»£ç è´¨é‡æ›´å¥½ æ›´å¥å£®

ä¼˜åŠ¿

- æœç»æ‰‹è¯¯å¯¼è‡´å˜é‡åå†™é”™
- ç±»å‹ä¸€å®šç¨‹åº¦å……å½“æ–‡æ¡£
- IDE è‡ªåŠ¨å¡«å…… è‡ªåŠ¨è”æƒ³

---

const readonly
const é˜²æ­¢å˜é‡å€¼è¢«ä¿®æ”¹
readonly é˜²æ­¢å˜é‡å±æ€§å€¼è¢«ä¿®æ”¹

æšä¸¾
å¸¸é‡æšä¸¾ ç¼–è¯‘é˜¶æ®µä¼šè¢«åˆ é™¤ è¢«å†…æ•›

æ¥å£
ç±»å‹åˆ«å å¯ä»¥ç”¨äºå…¶ä»–ç±»å‹ï¼ŒåŸºæœ¬ç±»å‹ï¼Œè”åˆç±»å‹ï¼Œå…ƒç»„
éƒ½å¯ä»¥ç”¨æ¥æè¿°å¯¹è±¡æˆ–å‡½æ•°ç±»å‹

---

- any åŠ¨æ€ç±»å‹å˜é‡ å¤±å»äº†ç±»å‹æ£€æŸ¥çš„ä½œç”¨
- never æ°¸è¿œä¸å­˜åœ¨çš„å€¼çš„ç±»å‹
  - æŠ›å‡ºå¼‚å¸¸ æ ¹æœ¬æ²¡æœ‰è¿”å›å€¼çš„å‡½æ•°è¡¨è¾¾å¼ æˆ–è€…ç®­å¤´å‡½æ•°è¡¨è¾¾å¼è¿”å›å€¼ç±»å‹
- unknown ä»»ä½•ç±»å‹çš„å€¼éƒ½å¯ä»¥èµ‹å€¼ç»™ unknownï¼Œunknown åªèƒ½èµ‹å€¼ç»™ unknownã€any
- null & undefined é»˜è®¤æ˜¯æ‰€æœ‰ç±»å‹çš„å­ç±»å‹ --strictNullChecks æ ‡è®° null æˆ–è€… undefined åªèƒ½èµ‹å€¼ç»™ void æˆ–è€…å®ƒä»¬è‡ªå·±
- void æ²¡æœ‰ä»»ä½•ç±»å‹ å‡½æ•°æ²¡æœ‰è¿”å›å€¼ å¯ä»¥å®šä¹‰ä¸º void

---

# interface å¯ä»¥ç»™ Function / Array / Class åšå£°æ˜å—ï¼Ÿ

```ts
// å‡½æ•°å£°æ˜
interface Say {
  (name: string): void
}

let say: Say = (name: string): void => {}

// Array
interface NumberArray {
  [index: number]: number
}

let list: NumberArray = [1, 2, 4, 5]

// Class å£°æ˜
interface Person {
  name: string

  sayHi(name: string): string
}
```

---

# Typescript ä¸­çš„ this å’Œ JavaScript ä¸­çš„ this æœ‰ä»€ä¹ˆå·®å¼‚ï¼Ÿ

TSï¼šnoImplicitThis:true å¿…é¡»å»å£°æ˜ this ç±»å‹ï¼Œæ‰èƒ½åœ¨å‡½æ•°æˆ–è€…å¯¹è±¡ä¸­ä½¿ç”¨ this

# Typescript ä¸­ä½¿ç”¨ Union Types æ—¶æœ‰å“ªäº›æ³¨æ„äº‹é¡¹ï¼Ÿ

å±æ€§æˆ–è€…æ–¹æ³•è®¿é—®ï¼šåªèƒ½è®¿é—®å…±æœ‰å±æ€§æˆ–è€…æ–¹æ³•

# Typescript å¦‚ä½•è®¾è®¡ Class çš„å£°æ˜ï¼Ÿ

```ts
class Greet {
  greeting: string

  constructor(message: string) {
    this.greeting = message
  }

  greet(): string {
    return `hello,${this.message}`
  }
}

let greeter = new Greet('world')
```

# Typescript ä¸­å¦‚ä½•è”åˆæšä¸¾ç±»å‹çš„ key

```ts
enum str {
  A,
  B,
  C,
  D,
}

type strUnion = keyof typeof str // 'A'|'B'|'C'|'D'
```

# type å’Œ interface çš„åŒºåˆ«

ç›¸åŒç‚¹ï¼š

- éƒ½å¯ä»¥æè¿°å¯¹è±¡æˆ–è€…å‡½æ•°
- éƒ½å…è®¸æ‹“å±•

ä¸åŒç‚¹ï¼š

- type å¯ä»¥å£°æ˜åŸºæœ¬ç±»å‹ è”åˆç±»å‹ å…ƒç»„
- type å¯ä»¥ä½¿ç”¨ typeof è·å–å®ä¾‹ç±»å‹è¿›è¡Œèµ‹å€¼
- å¤šä¸ªç›¸åŒçš„ interface å¯ä»¥è‡ªåŠ¨åˆå¹¶

ç±»å‹å…¼å®¹æ€§

# å¯¹è±¡å±•å¼€ä¼šæœ‰ä»€ä¹ˆå‰¯ä½œç”¨

1. å±•å¼€å¯¹è±¡åé¢çš„å±æ€§ä¼šè¦†ç›–å‰é¢çš„å±æ€§
2. ä»…åŒ…å«å¯æšä¸¾çš„å±æ€§ï¼Œä¸å¯æšä¸¾å±æ€§ä¸¢å¤±

# å…¨å±€å£°æ˜å’Œå±€éƒ¨å£°æ˜

ä¸åŒ…å« import export å˜æˆå…¨å±€å£°æ˜
åŒ…å« å±€éƒ¨å£°æ˜ ä¸ä¼šå½±å“åˆ°å…¨å±€å£°æ˜

# Typescript é¡¹ç›®å¼•å…¥å¹¶è¯†åˆ«ç¼–è¯‘ä¸º JavaScript çš„ npm åº“åŒ…ï¼Ÿ

1. é€‰æ‹©å®‰è£… ts ç‰ˆæœ¬ npm install @types/xxx --save
2. æ²¡æœ‰ç±»å‹çš„ js åº“ éœ€è¦ç¼–å†™åŒåçš„ .d.ts

# Typescript ä¸­å¦‚ä½•è®¾ç½®æ¨¡å—å¯¼å…¥çš„è·¯å¾„åˆ«å

tsconfig.json paths

```json
{
  "compilerOptions": {
    "paths": {
      "@/helper/*": ["src/helper/*"]
    }
  }
}
```

# declareï¼Œdeclare global æ˜¯ä»€ä¹ˆ

declare å®šä¹‰å…¨å±€å˜é‡ å…¨å±€å‡½æ•° å…¨å±€å‘½åç©ºé—´ js modules class ç­‰
delcare global ä¸ºå…¨å±€å¯¹è±¡ window å¢åŠ æ–°çš„å±æ€§

```ts
declare global {
  interface Window {
    csrf: string
  }
}
```

# keypf å’Œ typedof å…³é”®å­—çš„ä½œç”¨

keyof ç´¢å¼•ç±»å‹æŸ¥è¯¢æ“ä½œç¬¦ è·å–æŸç§ç±»å‹çš„æ‰€æœ‰é”®ï¼Œå…¶è¿”å›ç±»å‹æ˜¯è”åˆç±»å‹
typeof è·å–ä¸€ä¸ªå˜é‡æˆ–è€…å¯¹è±¡çš„ç±»å‹

---

#

```
å¯¹ç­‰ä¾èµ– peerDependencies(package.json)
npm i --legacy-peer-deps
```

```
CSSå±æ€§å€¼çš„è®¡ç®—è¿‡ç¨‹
getComputedStyle
1.ç¡®å®šå£°æ˜å€¼
2.å±‚å 
  1. æ¯”è¾ƒé‡è¦æ€§
    é‡è¦æ€§ä»é«˜åˆ°ä½ï¼š
      1.å¸¦æœ‰ important çš„ä½œè€…æ ·å¼
      2.å¸¦æœ‰ important çš„é»˜è®¤æ ·å¼
      3.ä½œè€…æ ·å¼
      4.é»˜è®¤æ ·å¼
  2.æ¯”è¾ƒç‰¹å®šæ€§ï¼ˆæƒé‡ï¼‰
  3.æ¯”è¾ƒæºæ¬¡åºï¼šæºç ä¸­é åçš„è¦†ç›–é å‰çš„
3.ç»§æ‰¿
  å¯¹ä»ç„¶æ²¡æœ‰å€¼çš„å±æ€§ï¼Œè‹¥å¯ä»¥ç»§æ‰¿åˆ™ä½¿ç”¨ç»§æ‰¿
4.ä½¿ç”¨é»˜è®¤å€¼
  å¯¹ä»ç„¶æ²¡æœ‰å€¼çš„å±æ€§ï¼Œä½¿ç”¨é»˜è®¤å€¼
```

```js
åƒåœ¾å›æ”¶ç›‘å¬ï¼šFinalizationRegistry
å¼•ç”¨è®¡æ•°
æ ‡è®°æ¸…é™¤
memory
management
```

```js
ajax
XMLHttpRequest
XHR
Fetch
axios-- > XHR
umi - request-- > Fetch

// xhr è¯·æ±‚è¿›åº¦ç›‘æ§
xhr.upload.addEventListener('progress', (e) => {
  console.log(e.loaded, e.total)
})

// xhr å“åº”è¿›åº¦ç›‘æ§
xhr.addEventListener('progress', (e) => {
  console.log(e.loaded, e.total)
  onProgress &&
    onProgress({
      loaded: e.loaded,
      total: e.total,
    })
})
xhr.open(method, url)
xhr.send(data)

// fetch å“åº”è¿›åº¦ç›‘æ§
const resp = await fetch(url, {
  method,
  body: data,
})
const total = +resp.headers.get('content-length')
const decoder = new TextDecoder()
let body = ''
const reader = resp.body.getReader()
let loaded = 0
while (1) {
  const { done, value } = await reader.read()
  if (done) {
    break
  }
  loaded += value.length
  body += decoder.decode(value)
  onProgress &&
    onProgress({
      loaded: e.loaded,
      total: e.total,
    })
}
```

| åŠŸèƒ½ç‚¹                     |   XHR    |  Fetch   |
| -------------------------- | :------: | :------: |
| åŸºæœ¬çš„è¯·æ±‚åŠŸèƒ½             |    âˆš     |    âˆš     |
| åŸºæœ¬çš„è·å–ç›¸åº”èƒ½åŠ›         |    âˆš     |    âˆš     |
| ç›‘æ§è¯·æ±‚è¿›åº¦               |    âˆš     |    Ã—     |
| ç›‘æ§ç›¸åº”è¿›åº¦               |    âˆš     |    âˆš     |
| Service Workder ä¸­æ˜¯å¦å¯ç”¨ |    Ã—     |    âˆš     |
| ç²¾ç»†æ§åˆ¶ cookie çš„æºå¸¦     |    Ã—     |    âˆš     |
| æ§åˆ¶é‡å®šå‘                 |    Ã—     |    âˆš     |
| è¯·æ±‚å–æ¶ˆ                   |    âˆš     |    âˆš     |
| è‡ªå®šä¹‰ referrer            |    Ã—     |    âˆš     |
| æµ                         |    Ã—     |    âˆš     |
| API é£æ ¼                   |  Event   | Promise  |
| æ´»è·ƒåº¦                     | åœæ­¢æ›´æ–° | ä¸æ–­æ›´æ–° |

```
å¦‚ä½•ä¼˜åŒ–jsä»£ç çš„æ‰§è¡Œæ•ˆç‡
1.ä»£ç å‹ç¼©ä¸åˆå¹¶
2.æ¨¡å—åŒ–å’Œæ‡’åŠ è½½
3.ç¼“å­˜å’ŒæŒä¹…åŒ–
4.ä¼˜åŒ–å¾ªç¯å’Œæ•°ç»„æ“ä½œ
5.å‡å°‘ DOM æ“ä½œ
6.é¿å…é˜»å¡ UI çº¿ç¨‹
7.å‡å°‘é‡ç»˜å’Œå›æµ
```

```css
/* ä½ ä¸çŸ¥é“çš„ CSS é€‰æ‹©å™¨ */
:focus-within
:has()
::first-letter
::selection
```

```
ä»€ä¹ˆæ˜¯WebSocketï¼Œä»¥åŠå®ƒä¸ä¼ ç»Ÿçš„HTTPé•¿è½®è¯¢ç›¸æ¯”çš„ä¼˜åŠ¿
1.æŒä¹…é“¾æ¥
2.åŒå‘é€šä¿¡
3.ä½å»¶è¿Ÿ
4.å‡å°‘èµ„æºæ¶ˆè€—
5.æ¶ˆæ¯å¸§æ ¼å¼
```

```js
// çŠ¶æ€ä»“åº“æŒä¹…åŒ–
// vuex å…¨éƒ¨
//store.js
import persistPlugin from './persistPlugin'

const store = createStore({
  modules: {
    counter,
    test,
  },
  plugins: [persistPlugin],
})

// persistPlugin
const KEY = 'VUEX"STATE'

export default function(store) {
  // å­˜
  window.addEventListener('beforeunload', () => {
    localStorage.setItem(KEY, JSON.stringify(store.state))
  })
  // å–
  try {
    const state = JSON.parse(localStorage.getItem(KEY))
    if (state) {
      store.replaceState(state)
    }
  } catch {
    console.log('å­˜å‚¨çš„æ•°æ®æœ‰è¯¯')
  }
}

// pinia å•ä¸ªæ¨¡å—
//main.js
import { createPinia } from 'pinia'
import persistPlugin from './store/persistPlugin'

const pinia = createPinia()
pinia.use(persistPlugin)

// persistPlugin
const KEY_PREFIX = 'PINIA:STATE'
export default function(context) {
  // å­˜
  window.addEventListener('beforeunload', () => {
    localStorage.setItem(KEY_PREFIX + store.$id, JSON.stringify(store.$state))
  })
  // å–
  try {
    const state = JSON.parse(localStorage.getItem(KEY_PREFIX + store.$id))
    if (state) {
      store.$patch(state)
    }
  } catch {
  }
}
```

```js
// è‡ªåŠ¨æ³¨å…¥Lesså…¨å±€å˜é‡
module.exports = defineConfig({
  css: {
    loaderOptions: {
      less: {
        additionalData: '@import "~@/var.less"',
      },
    },
  },
})
// vite esbulid rollup
export default defineConfig({
  plugins: [vue()],
  resolve: {
    alias: {
      '~@': './src',
    },
  },
  css: {
    preprocessOptions: {
      less: {
        additionalData: '@import "~@/var.less"',
      },
    },
  },
})

// ç»Ÿä¸€viteä¸­çš„å›¾ç‰‡è½¬æ¢é€»è¾‘
import fs from 'node:fs'

const myPlugin = (limit = 4096) => {
  return {
    name: 'my-plugin',
    transform: async (code, id) => {
      if (process.env.NODE_ENV !== 'development') return
      if (!/\.(png|jpe?g|gif|webp|svg)$/.test(id)) {
        return
      }
      const state = await fs.promise.stat(id)
      if (state.size > limit) {
        return
      }
      const buffer = await fs.promise.readFile(id)
      const base64 = buffer.toString('base64')
      const dataurl = `data:image/png;base64,${base64}`
      return {
        code: `export default ${dataurl}`,
      }
    },
  }
}

export default definConfig({
  build: {
    // ç»Ÿä¸€viteä¸­çš„å›¾ç‰‡è½¬æ¢é€»è¾‘
    assetsInlineLimit: 0,
    rollupOptions: {
      // åœ¨viteä¸­æ‰‹åŠ¨åˆ†åŒ…
      manualChunks (id) {
        if (id.includes('node_modules')) {
          return 'vendor'
        }
      },
      // viteæ‰“åŒ…ç»“æ„æ§åˆ¶
      output: {
        entryFileNames: 'js/[name]-[hash].js',
        chunkFileNames: 'js/[name]-[hash].js',
        assetFileNames (assetInfo) {
          if (assetInfo.name.endsWith('.css')) {
            return 'css/[name]-[hash].css'
          }
          const imgExts = ['.png', '.jpg', '.jpeg', '.webp', '.svg', '.gif', '.ico']
          if (imgExt.some((e) => assetInfo.name.endsWith(e))) {
            return 'imgs/[name]-[hash].[ext]'
          }
          return 'asset/[name]-[hash].[ext]'
        },
      },
    },
  },
})
```

```
ä»€ä¹ˆæ˜¯ vue çš„å“åº”å¼ï¼Ÿ
**vue æ•°æ®å“åº”å¼è®¾è®¡çš„åˆè¡·æ˜¯ä¸ºäº†å®ç°æ•°æ®å’Œå‡½æ•°çš„è”åŠ¨**ï¼Œå½“æ•°æ®å˜åŒ–åï¼Œç”¨åˆ°è¯¥æ•°æ®çš„è”åŠ¨å‡½æ•°ä¼šè‡ªåŠ¨é‡æ–°è¿è¡Œã€‚
å…·ä½“åœ¨ vue å¼€å‘ä¸­ï¼Œæ•°æ®å’Œç»„ä»¶çš„ render å‡½æ•°å…³è”åœ¨ä¸€èµ·ï¼Œä»è€Œå®ç°äº†æ•°æ®å˜åŒ–è‡ªåŠ¨è¿è¡Œ renderï¼Œåœ¨æ„Ÿå®˜ä¸Šå°±çœ‹åˆ°äº†ç»„ä»¶çš„é‡æ–°æ¸²æŸ“ã€‚
é™¤äº† vue è‡ªåŠ¨å…³è”çš„ render å‡½æ•°ï¼Œå…¶ä»–è¿˜æœ‰å¾ˆå¤šä½¿ç”¨åˆ° vue å“åº”å¼çš„åœºæ™¯ï¼Œæ¯”å¦‚ computedã€watch ç­‰ç­‰ï¼Œä¸èƒ½ä»…æŠŠ vue çš„æ•°æ®å“åº”å¼æƒ³è±¡æˆå’Œ render çš„å…³è”ã€‚

å‡½æ•°ä¸æ•°æ®çš„å…³è”
  1. è¢«ç›‘æ§çš„å‡½æ•°
    render
    computed å›è°ƒ
    watch
    watchEffect
  2. å‡½æ•°è¿è¡ŒæœŸé—´ç”¨åˆ°äº†å“åº”å¼æ•°æ®
  3. å“åº”å¼æ•°æ®å˜åŒ–ä¼šå¯¼è‡´å‡½æ•°é‡æ–°è¿è¡Œ
```

```css
: ä¼ªç±»
:: ä¼ªå…ƒç´ 
```

```txt
GET å’Œ POST çš„åŒºåˆ«ï¼Ÿ
åè®®å±‚é¢ï¼š**è¯­ä¹‰åŒºåˆ«**
åº”ç”¨å±‚é¢ï¼š**GET è¯·æ±‚ä½“ä¸ºç©º**
æµè§ˆå™¨å±‚é¢ï¼š
```

```html
<!-- DNSé¢„è§£æ -->
<link rel="dns-prefetch" href="xxxx" />
```

```js
// æ‰“åŒ…ä½“ç§¯çš„åˆ†æå’Œä¼˜åŒ–:webpack-bundle-analyzer
const BundleAnalyzerPlugin = require('webpack-bundle-analyzer').BundleAnalyzerPlugin
if (process.env.NODE_ENV === 'production') {
  let aPlugin = new BundleAnalyzerPlugin()
  module.exports = {
    devtool: 'none',
    plugins: [aPlugin],
    externals: {
      // å…¬å…±åº“é€šè¿‡ cdn å¼•å…¥ï¼Œæµè§ˆå™¨ä¼šç¼“å­˜
      vue: 'Vue',
    },
  }
}
```

```
let å’Œ var çš„åŒºåˆ«
1.å…¨å±€æ±¡æŸ“ï¼Œå¯ä»¥è·¨æ ‡ç­¾
2.å—çº§ä½œç”¨åŸŸ  var å…¨å±€ä½œç”¨åŸŸï¼Œå‡½æ•°ä½œç”¨åŸŸï¼Œlet å—çº§ä½œç”¨åŸŸ
3.TDZ æš‚æ—¶æ€§æ­»åŒº
4.é‡å¤å£°æ˜  var å¯ä»¥é‡æ–°å£°æ˜ï¼Œlet ä¸å¯ä»¥é‡æ–°å£°æ˜
```

```
æ‹¼éŸ³æ ‡æ³¨
<ruby></ruby>
import pinyin from 'pinyin';
åˆ¤æ–­æ˜¯ä¸æ˜¯ä¸­æ–‡
```

```javascript
typeof null // object

let numbers = {
  0: 0
}

console.log(numbers.
"0"
)
; // error
console.log(numbers[0]); // 0


```

```shell
git clone <repository> --recursive é€’å½’çš„æ–¹å¼å…‹éš†æ•´ä¸ªé¡¹ç›®
git submodule add <repository> <path> æ·»åŠ å­æ¨¡å—
git submodule init åˆå§‹åŒ–å­æ¨¡å—
git submodule update æ›´æ–°å­æ¨¡å—
git submodule foreach git pull æ‹‰å–æ‰€æœ‰å­æ¨¡å—
```

```js
ç›‘æ§é¡µé¢æ˜¯å¦å‡ºç°å¡é¡¿
const observer = new PerformanceObserver((list) => {
  for (const entry of list.getEntries()) {
  }
})
observer.observe({ entryTypes: ['longtask'] })
```

```text
ç½‘ç»œ
  äº”å±‚ç½‘ç»œæ¨¡å‹
  TCP/IP
  HTTP
  postman/apifox
  AJAX
  è·¨åŸŸåŠè§£å†³æ–¹æ¡ˆ
  JWT
  cookie
  sessionnavigator.hardwareConcurrency
  ç¼“å­˜åè®®
  CSRF
  XSS
  ç½‘ç»œæ€§èƒ½ä¼˜åŒ–
  åˆ†ç‰‡ä¼ è¾“
  åŸŸåä¸ DNS
  SSL/TLS/HTTPS
  HTTP2
  WebSocket
```

```text
ç½‘ç»œçŠ¶æ€ç›‘æ§
  navigator.connection
  navigator.onLine
  window.addEventListener('online', () => {})
  window.addEventListener('offline', () => {})
  navigatot.connection.addEventListener('change', () => {})
```

```
å¾®é˜Ÿåˆ—
  MutationObserver
  ob.observe(target, { childList: true })
```

```
èµ„æºæç¤ºç¬¦
  async: ä½œç”¨äº script å…ƒç´ 
  defer: ä½œç”¨äº script å…ƒç´ 
  prefetch
  preload
```

```text
åŠ¨ç”»
Web Animation API: element.
animate()


element.getAnimations()
requestAnimationFrame
dom.addEventListener('transitionend') transitionstart  view transitions API
document.startViewTransition()
animationend
é€å¸§åŠ¨ç”» step anima
tion: name 1s steps(5)
åŠ¨ç”»çš„æš‚åœå’Œæ¢å¤:animation-play-state paused running
dom.style.setProperty('--name','value')


display noneå…ƒç´ ä¹Ÿèƒ½transitionè¿‡æ¸¡
transition-behavior:allow-discrete; éšè—åŠ¨ç”»
transition-behavior:normal;
@starting-style æ˜¾ç¤ºåŠ¨ç”»

img{
  transition-duration:.25s;
  transition-behavior:allow-discrete;
}
@starting-style{
  img{
    opacity: 0;
  }
}


æ»šåŠ¨å…ƒç´ åˆ°å¯è§†åŒºåŸŸï¼šscrollIntoView
å¹³æ»‘æ»šåŠ¨
css:scroll-behavior
js: window.scrollTo({
  top: 0,
  behavior: 'smooth'
})

å¦‚ä½•é˜»æ­¢æ»šåŠ¨åµŒå¥—å†’æ³¡ ` overscroll-behavior:contain`
  /* è®¾ç½®æ»šåŠ¨æ¡æ ·å¼ */
scrollbar-face-color: #eaeaea;
scrollbar-shadow-color: #eaeaea;
scrollbar-highlight-color: #eaeaea;
scrollbar-3dlight-color: #eaeaea;
scrollbar-darkshadow-color: #697074;
scrollbar-track-color: #f7f7f7;
scrollbar-arrow-color: #666666;

/* ä½¿ç”¨CSSå®ç°æ»šåŠ¨å¸é™„æ•ˆæœ */
scroll-snap-type: mandatory;
scroll-snap-align: center;
scroll-snap-stop: always;

/* çº¯csså®ç°é¡µé¢æ»šåŠ¨åŠ¨ç”» */
scroll-timelin-name
animation-timeline /* https://www.zhangxinxu.com/wordpress/2024/08/css-scroll-timeline/ */
animation-range
åŠ¨ç”»åº“ vueusemotion
cubic-bezier
css åŠ¨ç”»åªæ”¯æŒæ•°å€¼ç±»çš„å±æ€§
Houdini

@property

CSS

å‰ªåˆ‡å‡½æ•° clip-path
background-clip
mix-blend-mode background-blend-mode
```

```html
é¼ æ ‡ä½ç½®ä¿¡æ¯ï¼špageX,clientX,offsetX,movementX åŸå§‹å°ºå¯¸ naturalWidth naturalHeight æ ·å¼å°ºå¯¸ ç¼©æ”¾å€ç‡ window.devicePixelRatio

<img srcset="https:picsum.photos/200/300?random=1 1x, https:picsum.photos/400/600?random=1 2x" />
<img
  srcset="https:picsum.photos/200/300?random=1 200w, https:picsum.photos/400/600?random=1 400w"
  sizes="
    (max-width: 300px)50vw,
    (max-width: 600px) 50vw,
    50vw
  "
/>

åŸå§‹å°ºå¯¸=æ ·å¼å°ºå¯¸*ç¼©æ”¾å€ç‡ å…ƒç´ å°ºå¯¸ï¼š - clientWidthï¼šcontent + padding - offsetWidthï¼šcontent + padding + scroll(æ»šåŠ¨æ¡) + border - scrollWidthï¼švisible + invisible - å¯è§å°ºå¯¸ getBoundingClientRect()
dom.style.width DOMæ ‘ getComputedStyle(dom).width CSSOMæ ‘ layout tree å¸ƒå±€æ ‘ å‡ ä½•ä¿¡æ¯
```

```js
ç›‘å¬å¤åˆ¶äº‹ä»¶
addEventListener
{
  passive: false
}
copy
paste
e.clipboardData.setData('text/palin', 'hello world')
Clipboard
API
navigator.clipboard.readText().then((text) => {})
```

```css
/* è°ƒæ•´æ–‡å­—æ–¹å‘ï¼š */
writing-modeã€
margin-block-startã€
margin-block-endã€
text-combine-upright
margin-inline-start
```

```js
å±æ€§åˆ°åº•å­˜åœ¨ä¸å­˜åœ¨
Object.keys()
å¯¹è±¡è‡ªæœ‰å¯æšä¸¾çš„å±æ€§
hasOwnProperty()
å¯¹è±¡è‡ªæœ‰å±æ€§
getOwnPropertyDescriptor()
defineProperty()
value
writable
enumerable
configurable
ä½¿ç”¨ in éå†å±æ€§ï¼ŒåŸå‹ä¸Šä¹Ÿä¼šæŸ¥æ‰¾

å¯¹è±¡å±æ€§
symbol
å±æ€§ä¸èƒ½è¢«jsonåºåˆ—åŒ–
symbol
å±æ€§å¯ä»¥åˆ é™¤ï¼Œconfigurable:true
```

```js
// è¯»å–æ–‡ä»¶åŸå§‹å†…å®¹
// webpack: raw-loader
module.exports = defineConfig({
  configureWebpack: {
    module: {
      rules: [
        {
          test: /\.dataurl$/,
          loader: 'raw-loader',
        },
      ],
    },
  },
})

// vite: ?raw
import data from './data.dataurl?raw'

// vite å¯»æ‰¾ views æ–‡ä»¶å¤¹ä¸­æ‰€æœ‰çš„ page.js
import.meta.glob('../views/**/page.js', {
  eager: true,
  import: 'default',
})
```

```
ä¿æŒå…ƒç´ å®½é«˜æ¯”
css å±æ€§: aspect-ratio
padding ç›¸å¯¹äºçˆ¶å…ƒç´ å®½åº¦
```

```js
æ‰‹åŠ¨è§£æ
DOM
æ ‘: removeTag
new DOMParser().parseFromString(str, 'text/html')
```

```html
show,showModel
<dialog open></dialog>
::backdrop
```

## ä½ èƒ½è¯¦ç»†æè¿°ä¸€ä¸‹ qiankun å¾®å‰ç«¯æ¡†æ¶çš„å·¥ä½œåŸç†å—ï¼Ÿ

> qiankun æ˜¯ä¸€ä¸ªåŸºäº single-spa çš„å¾®å‰ç«¯å®ç°æ¡†æ¶ã€‚å®ƒçš„å·¥ä½œåŸç†ä¸»è¦æ¶‰åŠåˆ°ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1. **åº”ç”¨åŠ è½½**ï¼šqiankun é€šè¿‡åŠ¨æ€åˆ›å»º script æ ‡ç­¾çš„æ–¹å¼åŠ è½½å­åº”ç”¨çš„å…¥å£æ–‡ä»¶ã€‚åŠ è½½å®Œæˆåï¼Œä¼šæ‰§è¡Œå­åº”ç”¨æš´éœ²å‡ºçš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ã€‚
2. **ç”Ÿå‘½å‘¨æœŸç®¡ç†**ï¼šqiankun è¦æ±‚æ¯ä¸ªå­åº”ç”¨éƒ½éœ€è¦æš´éœ²å‡º bootstrapã€mount å’Œ unmount ä¸‰ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•°ã€‚bootstrap å‡½æ•°åœ¨åº”ç”¨åŠ è½½æ—¶è¢«è°ƒç”¨ï¼Œmount å‡½æ•°åœ¨åº”ç”¨å¯åŠ¨æ—¶è¢«è°ƒç”¨ï¼Œunmount
   å‡½æ•°åœ¨åº”ç”¨å¸è½½æ—¶è¢«è°ƒç”¨ã€‚
3. **æ²™ç®±éš”ç¦»**ï¼šqiankun é€šè¿‡ Proxy å¯¹è±¡åˆ›å»ºäº†ä¸€ä¸ª JavaScript æ²™ç®±ï¼Œç”¨äºéš”ç¦»å­åº”ç”¨çš„å…¨å±€å˜é‡ï¼Œé˜²æ­¢å­åº”ç”¨ä¹‹é—´çš„å…¨å±€å˜é‡æ±¡æŸ“ã€‚
4. **æ ·å¼éš”ç¦»**ï¼šqiankun é€šè¿‡åŠ¨æ€æ·»åŠ å’Œç§»é™¤æ ·å¼æ ‡ç­¾çš„æ–¹å¼å®ç°äº†æ ·å¼éš”ç¦»ã€‚å½“å­åº”ç”¨å¯åŠ¨æ—¶ï¼Œä¼šåŠ¨æ€æ·»åŠ å­åº”ç”¨çš„æ ·å¼æ ‡ç­¾ï¼Œå½“å­åº”ç”¨å¸è½½æ—¶ï¼Œä¼šç§»é™¤å­åº”ç”¨çš„æ ·å¼æ ‡ç­¾ã€‚
5. **é€šä¿¡æœºåˆ¶**ï¼šqiankun æä¾›äº†ä¸€ä¸ªå…¨å±€çš„é€šä¿¡æœºåˆ¶ï¼Œå…è®¸å­åº”ç”¨ä¹‹é—´è¿›è¡Œé€šä¿¡ã€‚

## åœ¨ä½¿ç”¨ qiankun æ—¶ï¼Œå¦‚æœå­åº”ç”¨æ˜¯åŸºäº jQuery çš„å¤šé¡µåº”ç”¨ï¼Œä½ ä¼šå¦‚ä½•å¤„ç†é™æ€èµ„æºçš„åŠ è½½é—®é¢˜ï¼Ÿ

> åœ¨ä½¿ç”¨ qiankun æ—¶ï¼Œå¦‚æœå­åº”ç”¨æ˜¯åŸºäº jQuery çš„å¤šé¡µåº”ç”¨ï¼Œé™æ€èµ„æºçš„åŠ è½½é—®é¢˜å¯èƒ½ä¼šæˆä¸ºä¸€ä¸ªæŒ‘æˆ˜ã€‚è¿™æ˜¯å› ä¸ºåœ¨å¾®å‰ç«¯ç¯å¢ƒä¸­ï¼Œå­åº”ç”¨çš„é™æ€èµ„æºè·¯å¾„å¯èƒ½éœ€è¦è¿›è¡Œç‰¹æ®Šå¤„ç†æ‰èƒ½æ­£ç¡®åŠ è½½ã€‚è¿™é‡Œæœ‰å‡ ç§å¯èƒ½çš„è§£å†³æ–¹æ¡ˆï¼š

#### æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨å…¬å…±è·¯å¾„

åœ¨å­åº”ç”¨çš„é™æ€èµ„æºè·¯å¾„å‰æ·»åŠ å…¬å…±è·¯å¾„å‰ç¼€ã€‚ä¾‹å¦‚ï¼Œå¦‚æœå­åº”ç”¨çš„é™æ€èµ„æºå­˜æ”¾åœ¨ `http://localhost:8080/static/`ï¼Œé‚£ä¹ˆå¯ä»¥åœ¨æ‰€æœ‰çš„é™æ€èµ„æºè·¯å¾„å‰æ·»åŠ è¿™ä¸ªå‰ç¼€ã€‚

#### æ–¹æ¡ˆäºŒï¼šåŠ«æŒæ ‡ç­¾æ’å…¥å‡½æ•°

è¿™ä¸ªæ–¹æ¡ˆåˆ†ä¸ºä¸¤æ­¥ï¼š

-

- 1.  å¯¹äº HTML ä¸­å·²æœ‰çš„ img/audio/video ç­‰æ ‡ç­¾ï¼Œqiankun æ”¯æŒé‡å†™ getTemplate å‡½æ•°ï¼Œå¯ä»¥å°†å…¥å£æ–‡ä»¶ index.html ä¸­çš„é™æ€èµ„æºè·¯å¾„æ›¿æ¢æ‰ã€‚

-

- 1.  å¯¹äºåŠ¨æ€æ’å…¥çš„ img/audio/video ç­‰æ ‡ç­¾ï¼ŒåŠ«æŒ appendChildã€innerHTMLã€insertBefore ç­‰äº‹ä»¶ï¼Œå°†èµ„æºçš„ç›¸å¯¹è·¯å¾„æ›¿æ¢æˆç»å¯¹è·¯å¾„ã€‚

ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ä¼ é€’ä¸€ä¸ª getTemplate å‡½æ•°ï¼Œå°†å›¾ç‰‡çš„ç›¸å¯¹è·¯å¾„è½¬ä¸ºç»å¯¹è·¯å¾„ï¼Œå®ƒä¼šåœ¨å¤„ç†æ¨¡æ¿æ—¶ä½¿ç”¨ï¼š

```

start({
getTemplate(tpl,...rest) {
// ä¸ºäº†ç›´æ¥çœ‹åˆ°æ•ˆæœï¼Œæ‰€ä»¥å†™æ­»äº†ï¼Œå®é™…ä¸­éœ€è¦ç”¨æ­£åˆ™åŒ¹é…
return tpl.replace('<img src="./img/jQuery1.png">', '<img src="http://localhost:3333/img/jQuery1.png">');
}
});

```

å¯¹äºåŠ¨æ€æ’å…¥çš„æ ‡ç­¾ï¼ŒåŠ«æŒå…¶æ’å…¥ DOM çš„å‡½æ•°ï¼Œæ³¨å…¥å‰ç¼€ã€‚

```

beforeMount: app => {
if(app.name === 'purehtml'){
// jQuery çš„ html æ–¹æ³•æ˜¯ä¸€ä¸ªæŒºå¤æ‚çš„å‡½æ•°ï¼Œè¿™é‡Œåªæ˜¯ä¸ºäº†çœ‹æ•ˆæœï¼Œç®€å†™äº†
$.prototype.html = function(value){
const str = value.replace('<img src="/img/jQuery2.png">', '<img src="http://localhost:3333/img/jQuery2.png">')
this[0].innerHTML = str;
}
}
}

```

#### æ–¹æ¡ˆä¸‰ï¼šç»™ jQuery é¡¹ç›®åŠ ä¸Š webpack æ‰“åŒ…

è¿™ä¸ªæ–¹æ¡ˆçš„å¯è¡Œæ€§ä¸é«˜ï¼Œéƒ½æ˜¯é™ˆå¹´è€é¡¹ç›®äº†ï¼Œæ²¡å¿…è¦è¿™æ ·æŠ˜è…¾ã€‚

## åœ¨ä½¿ç”¨ `qiankun` æ—¶ï¼Œå¦‚æœå­åº”ç”¨åŠ¨æ€æ’å…¥äº†ä¸€äº›æ ‡ç­¾ï¼Œä½ ä¼šå¦‚ä½•å¤„ç†ï¼Ÿ

> åœ¨ä½¿ç”¨ `qiankun` æ—¶ï¼Œå¦‚æœå­åº”ç”¨åŠ¨æ€æ’å…¥äº†ä¸€äº›æ ‡ç­¾ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åŠ«æŒ DOM çš„ä¸€äº›æ–¹æ³•æ¥å¤„ç†ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥åŠ«æŒ `appendChild`ã€`innerHTML` å’Œ `insertBefore` ç­‰æ–¹æ³•ï¼Œå°†èµ„æºçš„ç›¸å¯¹è·¯å¾„æ›¿æ¢ä¸ºç»å¯¹è·¯å¾„ã€‚

ä»¥ä¸‹æ˜¯ä¸€ä¸ªä¾‹å­ï¼Œå‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªå­åº”ç”¨ï¼Œå®ƒä½¿ç”¨ jQuery åŠ¨æ€æ’å…¥äº†ä¸€å¼ å›¾ç‰‡ï¼š

```js
const render = ($) => {
  $('#app-container').html('<p>Hello, render with jQuery</p><img src="./img/my-image.png">')
  return Promise.resolve()
}
```

æˆ‘ä»¬å¯ä»¥åœ¨ä¸»åº”ç”¨ä¸­åŠ«æŒ jQuery çš„ `html` æ–¹æ³•ï¼Œå°†å›¾ç‰‡çš„ç›¸å¯¹è·¯å¾„æ›¿æ¢ä¸ºç»å¯¹è·¯å¾„ï¼š

```js
beforeMount: (app) => {
  if (app.name === 'my-app') {
    // jQuery çš„ html æ–¹æ³•æ˜¯ä¸€ä¸ªå¤æ‚çš„å‡½æ•°ï¼Œè¿™é‡Œä¸ºäº†ç®€åŒ–ï¼Œæˆ‘ä»¬åªå¤„ç† img æ ‡ç­¾
    $.prototype.html = function (value) {
      const str = value.replace('<img src="./img/my-image.png">', '<img src="http://localhost:8080/img/my-image.png">')
      this[0].innerHTML = str
    }
  }
}
```

åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åŠ«æŒäº† jQuery çš„ `html` æ–¹æ³•ï¼Œå°†å›¾ç‰‡çš„ç›¸å¯¹è·¯å¾„ `./img/my-image.png` æ›¿æ¢ä¸ºäº†ç»å¯¹è·¯å¾„ `http://localhost:8080/img/my-image.png`ã€‚è¿™æ ·ï¼Œæ— è®ºå­åº”ç”¨åœ¨å“ªé‡Œè¿è¡Œï¼Œå›¾ç‰‡éƒ½å¯ä»¥æ­£ç¡®åœ°åŠ è½½ã€‚

## åœ¨ä½¿ç”¨ `qiankun` æ—¶ï¼Œä½ å¦‚ä½•å¤„ç†è€é¡¹ç›®çš„èµ„æºåŠ è½½é—®é¢˜ï¼Ÿä½ èƒ½ç»™å‡ºä¸€äº›å…·ä½“çš„è§£å†³æ–¹æ¡ˆå—ï¼Ÿ

> åœ¨ä½¿ç”¨ `qiankun` æ—¶ï¼Œå¤„ç†è€é¡¹ç›®çš„èµ„æºåŠ è½½é—®é¢˜å¯ä»¥æœ‰å¤šç§æ–¹æ¡ˆï¼Œå…·ä½“çš„é€‰æ‹©å–å†³äºé¡¹ç›®çš„å…·ä½“æƒ…å†µã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¯èƒ½çš„è§£å†³æ–¹æ¡ˆï¼š

1. **ä½¿ç”¨ `qiankun` çš„ `getTemplate` å‡½æ•°é‡å†™é™æ€èµ„æºè·¯å¾„**ï¼šå¯¹äº HTML ä¸­å·²æœ‰çš„ `img/audio/video` ç­‰æ ‡ç­¾ï¼Œ`qiankun` æ”¯æŒé‡å†™ `getTemplate` å‡½æ•°ï¼Œå¯ä»¥å°†å…¥å£æ–‡ä»¶ `index.html`
   ä¸­çš„é™æ€èµ„æºè·¯å¾„æ›¿æ¢æ‰ã€‚ä¾‹å¦‚ï¼š

```js
start({
  getTemplate(tpl, ...rest) {
    // ä¸ºäº†ç›´æ¥çœ‹åˆ°æ•ˆæœï¼Œæ‰€ä»¥å†™æ­»äº†ï¼Œå®é™…ä¸­éœ€è¦ç”¨æ­£åˆ™åŒ¹é…
    return tpl.replace('<img src="./img/my-image.png">', '<img src="http://localhost:8080/img/my-image.png">')
  },
})
```

1. **åŠ«æŒæ ‡ç­¾æ’å…¥å‡½æ•°**ï¼šå¯¹äºåŠ¨æ€æ’å…¥çš„ `img/audio/video` ç­‰æ ‡ç­¾ï¼Œæˆ‘ä»¬å¯ä»¥åŠ«æŒ `appendChild` ã€ `innerHTML` ã€`insertBefore` ç­‰äº‹ä»¶ï¼Œå°†èµ„æºçš„ç›¸å¯¹è·¯å¾„æ›¿æ¢æˆç»å¯¹è·¯å¾„ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥åŠ«æŒ
   jQuery çš„ `html` æ–¹æ³•ï¼Œå°†å›¾ç‰‡çš„ç›¸å¯¹è·¯å¾„æ›¿æ¢ä¸ºç»å¯¹è·¯å¾„ï¼š

```js
beforeMount: (app) => {
  if (app.name === 'my-app') {
    $.prototype.html = function (value) {
      const str = value.replace('<img src="./img/my-image.png">', '<img src="http://localhost:8080/img/my-image.png">')
      this[0].innerHTML = str
    }
  }
}
```

1. **ç»™è€é¡¹ç›®åŠ ä¸Š webpack æ‰“åŒ…**ï¼šè¿™ä¸ªæ–¹æ¡ˆçš„å¯è¡Œæ€§ä¸é«˜ï¼Œéƒ½æ˜¯é™ˆå¹´è€é¡¹ç›®äº†ï¼Œæ²¡å¿…è¦è¿™æ ·æŠ˜è…¾ã€‚
2. **ä½¿ç”¨ iframe åµŒå…¥è€é¡¹ç›®**ï¼šè™½ç„¶ `qiankun` æ”¯æŒ jQuery è€é¡¹ç›®ï¼Œä½†æ˜¯ä¼¼ä¹å¯¹å¤šé¡µåº”ç”¨æ²¡æœ‰å¾ˆå¥½çš„è§£å†³åŠæ³•ã€‚æ¯ä¸ªé¡µé¢éƒ½å»ä¿®æ”¹ï¼Œæˆæœ¬å¾ˆå¤§ä¹Ÿå¾ˆéº»çƒ¦ï¼Œä½†æ˜¯ä½¿ç”¨ iframe åµŒå…¥è¿™äº›è€é¡¹ç›®å°±æ¯”è¾ƒæ–¹ä¾¿ã€‚

## ä½ èƒ½è§£é‡Šä¸€ä¸‹ `qiankun` çš„ `start` å‡½æ•°çš„ä½œç”¨å’Œå‚æ•°å—ï¼Ÿå¦‚æœåªæœ‰ä¸€ä¸ªå­é¡¹ç›®ï¼Œä½ ä¼šå¦‚ä½•å¯ç”¨é¢„åŠ è½½ï¼Ÿ

> `qiankun` çš„ `start` å‡½æ•°æ˜¯ç”¨æ¥å¯åŠ¨å¾®å‰ç«¯åº”ç”¨çš„ã€‚åœ¨æ³¨å†Œå®Œæ‰€æœ‰çš„å­åº”ç”¨ä¹‹åï¼Œæˆ‘ä»¬éœ€è¦è°ƒç”¨ `start` å‡½æ•°æ¥å¯åŠ¨å¾®å‰ç«¯åº”ç”¨ã€‚

`start` å‡½æ•°æ¥æ”¶ä¸€ä¸ªå¯é€‰çš„é…ç½®å¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œè¿™ä¸ªå¯¹è±¡å¯ä»¥åŒ…å«ä»¥ä¸‹å±æ€§ï¼š

- `prefetch`ï¼šé¢„åŠ è½½æ¨¡å¼ï¼Œå¯é€‰å€¼æœ‰ `true`ã€`false`ã€`'all'`ã€`'popstate'`ã€‚é»˜è®¤å€¼ä¸º `true`ï¼Œå³åœ¨ä¸»åº”ç”¨ `start` ä¹‹åå³åˆ»å¼€å§‹é¢„åŠ è½½æ‰€æœ‰å­åº”ç”¨çš„é™æ€èµ„æºã€‚å¦‚æœè®¾ç½®ä¸º `'all'`ï¼Œåˆ™ä¸»åº”ç”¨ `start`
  ä¹‹åä¼šé¢„åŠ è½½æ‰€æœ‰å­åº”ç”¨é™æ€èµ„æºï¼Œæ— è®ºå­åº”ç”¨æ˜¯å¦æ¿€æ´»ã€‚å¦‚æœè®¾ç½®ä¸º `'popstate'`ï¼Œåˆ™åªæœ‰åœ¨è·¯ç”±åˆ‡æ¢çš„æ—¶å€™æ‰ä¼šå»é¢„åŠ è½½å¯¹åº”å­åº”ç”¨çš„é™æ€èµ„æºã€‚
- `sandbox`ï¼šæ²™ç®±æ¨¡å¼ï¼Œå¯é€‰å€¼æœ‰ `true`ã€`false`ã€`{ strictStyleIsolation: true }`ã€‚é»˜è®¤å€¼ä¸º `true`ï¼Œå³ä¸ºæ¯ä¸ªå­åº”ç”¨åˆ›å»ºä¸€ä¸ªæ–°çš„æ²™ç®±ç¯å¢ƒã€‚å¦‚æœè®¾ç½®ä¸º `false`ï¼Œåˆ™å­åº”ç”¨è¿è¡Œåœ¨å½“å‰ç¯å¢ƒä¸‹ï¼Œæ²¡æœ‰ä»»ä½•çš„éš”ç¦»ã€‚å¦‚æœè®¾ç½®ä¸º
  `{ strictStyleIsolation: true }`ï¼Œåˆ™ä¼šå¯ç”¨ä¸¥æ ¼çš„æ ·å¼éš”ç¦»æ¨¡å¼ï¼Œå³å­åº”ç”¨çš„æ ·å¼ä¼šè¢«å®Œå…¨éš”ç¦»ï¼Œä¸ä¼šå½±å“åˆ°å…¶ä»–å­åº”ç”¨å’Œä¸»åº”ç”¨ã€‚
- `singular`ï¼šæ˜¯å¦ä¸ºå•ä¾‹æ¨¡å¼ï¼Œå¯é€‰å€¼æœ‰ `true`ã€`false`ã€‚é»˜è®¤å€¼ä¸º `true`ï¼Œå³ä¸€æ¬¡åªèƒ½æœ‰ä¸€ä¸ªå­åº”ç”¨å¤„äºæ¿€æ´»çŠ¶æ€ã€‚å¦‚æœè®¾ç½®ä¸º `false`ï¼Œåˆ™å¯ä»¥åŒæ—¶æ¿€æ´»å¤šä¸ªå­åº”ç”¨ã€‚
- `fetch`ï¼šè‡ªå®šä¹‰çš„ `fetch` æ–¹æ³•ï¼Œç”¨äºåŠ è½½å­åº”ç”¨çš„é™æ€èµ„æºã€‚

å¦‚æœåªæœ‰ä¸€ä¸ªå­é¡¹ç›®ï¼Œè¦æƒ³å¯ç”¨é¢„åŠ è½½ï¼Œå¯ä»¥è¿™æ ·ä½¿ç”¨ `start` å‡½æ•°ï¼š

```js
start({ prefetch: 'all' })
```

è¿™æ ·ï¼Œä¸»åº”ç”¨ `start` ä¹‹åä¼šé¢„åŠ è½½å­åº”ç”¨çš„æ‰€æœ‰é™æ€èµ„æºï¼Œæ— è®ºå­åº”ç”¨æ˜¯å¦æ¿€æ´»ã€‚

## åœ¨ä½¿ç”¨ `qiankun` æ—¶ï¼Œä½ å¦‚ä½•å¤„ç† `js` æ²™ç®±ä¸èƒ½è§£å†³çš„ `js` æ±¡æŸ“é—®é¢˜ï¼Ÿ

> `qiankun` çš„ `js` æ²™ç®±æœºåˆ¶ä¸»è¦æ˜¯é€šè¿‡ä»£ç† `window` å¯¹è±¡æ¥å®ç°çš„ï¼Œå®ƒå¯ä»¥æœ‰æ•ˆåœ°éš”ç¦»å­åº”ç”¨çš„å…¨å±€å˜é‡ï¼Œé˜²æ­¢å­åº”ç”¨ä¹‹é—´çš„å…¨å±€å˜é‡æ±¡æŸ“ã€‚ç„¶è€Œï¼Œè¿™ç§æœºåˆ¶å¹¶ä¸èƒ½è§£å†³æ‰€æœ‰çš„ `js` æ±¡æŸ“é—®é¢˜ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨
> `onclick` æˆ– `addEventListener` ç»™ `<body>` æ·»åŠ äº†ä¸€ä¸ªç‚¹å‡»äº‹ä»¶ï¼Œ`js` æ²™ç®±å¹¶ä¸èƒ½æ¶ˆé™¤å®ƒçš„å½±å“ã€‚

å¯¹äºè¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬éœ€è¦ä¾èµ–äºè‰¯å¥½çš„ä»£ç è§„èŒƒå’Œå¼€å‘è€…çš„è‡ªè§‰ã€‚åœ¨å¼€å‘å­åº”ç”¨æ—¶ï¼Œæˆ‘ä»¬éœ€è¦é¿å…ç›´æ¥æ“ä½œå…¨å±€å¯¹è±¡ï¼Œå¦‚ `window` å’Œ `document`ã€‚å¦‚æœå¿…é¡»è¦æ“ä½œï¼Œæˆ‘ä»¬åº”è¯¥åœ¨å­åº”ç”¨å¸è½½æ—¶ï¼Œæ¸…ç†æ‰è¿™äº›å…¨å±€äº‹ä»¶å’Œå…¨å±€å˜é‡ï¼Œä»¥é˜²æ­¢å¯¹å…¶ä»–å­åº”ç”¨æˆ–ä¸»åº”ç”¨é€ æˆå½±å“ã€‚

ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬åœ¨å­åº”ç”¨ä¸­æ·»åŠ äº†ä¸€ä¸ªå…¨å±€çš„ç‚¹å‡»äº‹ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å­åº”ç”¨çš„ `unmount` ç”Ÿå‘½å‘¨æœŸå‡½æ•°ä¸­ç§»é™¤è¿™ä¸ªäº‹ä»¶ï¼š

```js
export async function mount(props) {
  // æ·»åŠ å…¨å±€ç‚¹å‡»äº‹ä»¶
  window.addEventListener('click', handleClick)
}

export async function unmount() {
  // ç§»é™¤å…¨å±€ç‚¹å‡»äº‹ä»¶
  window.removeEventListener('click', handleClick)
}

function handleClick() {
  // å¤„ç†ç‚¹å‡»äº‹ä»¶
}
```

è¿™æ ·ï¼Œå½“å­åº”ç”¨å¸è½½æ—¶ï¼Œå…¨å±€çš„ç‚¹å‡»äº‹ä»¶ä¹Ÿä¼šè¢«ç§»é™¤ï¼Œä¸ä¼šå½±å“åˆ°å…¶ä»–çš„å­åº”ç”¨ã€‚

## ä½ èƒ½è§£é‡Šä¸€ä¸‹ `qiankun` å¦‚ä½•å®ç° `keep-alive` çš„éœ€æ±‚å—ï¼Ÿ

> åœ¨ `qiankun` ä¸­ï¼Œå®ç° `keep-alive` çš„éœ€æ±‚æœ‰ä¸€å®šçš„æŒ‘æˆ˜æ€§ã€‚è¿™æ˜¯å› ä¸º `qiankun` çš„è®¾è®¡ç†å¿µæ˜¯åœ¨å­åº”ç”¨å¸è½½æ—¶ï¼Œå°†ç¯å¢ƒè¿˜åŸåˆ°å­åº”ç”¨åŠ è½½å‰çš„çŠ¶æ€ï¼Œä»¥é˜²æ­¢å­åº”ç”¨å¯¹å…¨å±€ç¯å¢ƒé€ æˆæ±¡æŸ“ã€‚è¿™ç§è®¾è®¡ç†å¿µä¸
> `keep-alive` çš„éœ€æ±‚æ˜¯ç›¸æ‚–çš„ï¼Œå› ä¸º `keep-alive` éœ€è¦ä¿ç•™å­åº”ç”¨çš„çŠ¶æ€ï¼Œè€Œä¸æ˜¯åœ¨å­åº”ç”¨å¸è½½æ—¶å°†å…¶çŠ¶æ€æ¸…é™¤ã€‚

ç„¶è€Œï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€äº›æŠ€å·§æ¥å®ç° `keep-alive` çš„æ•ˆæœã€‚ä¸€ç§å¯èƒ½çš„æ–¹æ³•æ˜¯åœ¨å­åº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ä¸­ä¿å­˜å’Œæ¢å¤å­åº”ç”¨çš„çŠ¶æ€ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å­åº”ç”¨çš„ `unmount` å‡½æ•°ä¸­ä¿å­˜å­åº”ç”¨çš„çŠ¶æ€ï¼Œç„¶ååœ¨
`mount` å‡½æ•°ä¸­æ¢å¤è¿™ä¸ªçŠ¶æ€ï¼š

```

// ä¼ªä»£ç 
let savedState;

export async function mount(props) {
// æ¢å¤å­åº”ç”¨çš„çŠ¶æ€
if (savedState) {
restoreState(savedState);
}
}

export async function unmount() {
// ä¿å­˜å­åº”ç”¨çš„çŠ¶æ€
savedState = saveState();
}

function saveState() {
// ä¿å­˜å­åº”ç”¨çš„çŠ¶æ€
// è¿™ä¸ªå‡½æ•°çš„å®ç°å–å†³äºä½ çš„åº”ç”¨
}

function restoreState(state) {
// æ¢å¤å­åº”ç”¨çš„çŠ¶æ€
// è¿™ä¸ªå‡½æ•°çš„å®ç°å–å†³äºä½ çš„åº”ç”¨
}

```

è¿™ç§æ–¹æ³•çš„ç¼ºç‚¹æ˜¯éœ€è¦æ‰‹åŠ¨ä¿å­˜å’Œæ¢å¤å­åº”ç”¨çš„çŠ¶æ€ï¼Œè¿™å¯èƒ½ä¼šå¢åŠ å¼€å‘çš„å¤æ‚æ€§ã€‚æ­¤å¤–ï¼Œè¿™ç§æ–¹æ³•ä¹Ÿä¸èƒ½ä¿ç•™å­åº”ç”¨çš„ DOM çŠ¶æ€ï¼Œåªèƒ½ä¿ç•™ JavaScript çš„çŠ¶æ€ã€‚

è¿˜æœ‰ä¸€ç§å°±æ˜¯æ‰‹åŠ¨`*loadMicroApp*`+`display:none`ï¼Œç›´æ¥éšè— Dom

å¦ä¸€ç§å¯èƒ½çš„æ–¹æ³•æ˜¯ä½¿ç”¨ `single-spa` çš„ `Parcel` åŠŸèƒ½ã€‚`Parcel` æ˜¯ `single-spa` çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œå®ƒå…è®¸ä½ åœ¨ä¸€ä¸ªåº”ç”¨ä¸­æŒ‚è½½å¦ä¸€ä¸ªåº”ç”¨ï¼Œå¹¶ä¸”å¯ä»¥æ§åˆ¶è¿™ä¸ªåº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸã€‚é€šè¿‡ `Parcel`
ï¼Œæˆ‘ä»¬å¯ä»¥å°†å­åº”ç”¨æŒ‚è½½åˆ°ä¸€ä¸ªéšè—çš„ DOM å…ƒç´ ä¸Šï¼Œä»è€Œå®ç° `keep-alive` çš„æ•ˆæœã€‚ç„¶è€Œï¼Œè¿™ç§æ–¹æ³•éœ€è¦å¯¹ `qiankun` çš„æºç è¿›è¡Œä¿®æ”¹ï¼Œå› ä¸º `qiankun` ç›®å‰å¹¶ä¸æ”¯æŒ `Parcel`ã€‚

## ä½ èƒ½è§£é‡Šä¸€ä¸‹ `qiankun` å’Œ `iframe` åœ¨å¾®å‰ç«¯å®ç°æ–¹å¼ä¸Šçš„åŒºåˆ«å’Œä¼˜åŠ£å—ï¼Ÿåœ¨ä»€ä¹ˆæƒ…å†µä¸‹ï¼Œä½ ä¼šé€‰æ‹©ä½¿ç”¨ `iframe` è€Œä¸æ˜¯ `qiankun`ï¼Ÿ

`qiankun` å’Œ `iframe` éƒ½æ˜¯å¾®å‰ç«¯çš„å®ç°æ–¹å¼ï¼Œä½†å®ƒä»¬åœ¨å®ç°åŸç†å’Œä½¿ç”¨åœºæ™¯ä¸Šæœ‰ä¸€äº›åŒºåˆ«ã€‚

`qiankun` æ˜¯åŸºäº `single-spa` çš„å¾®å‰ç«¯è§£å†³æ–¹æ¡ˆï¼Œå®ƒé€šè¿‡ JavaScript çš„ `import` åŠŸèƒ½åŠ¨æ€åŠ è½½å­åº”ç”¨ï¼Œç„¶ååœ¨ä¸»åº”ç”¨çš„ DOM ä¸­æŒ‚è½½å­åº”ç”¨çš„ DOMã€‚`qiankun` æä¾›äº†ä¸€ç§ JavaScript
æ²™ç®±æœºåˆ¶ï¼Œå¯ä»¥éš”ç¦»å­åº”ç”¨çš„å…¨å±€å˜é‡ï¼Œé˜²æ­¢å­åº”ç”¨ä¹‹é—´çš„å…¨å±€å˜é‡æ±¡æŸ“ã€‚æ­¤å¤–ï¼Œ`qiankun` è¿˜æä¾›äº†ä¸€ç§æ ·å¼éš”ç¦»æœºåˆ¶ï¼Œå¯ä»¥é˜²æ­¢å­åº”ç”¨çš„ CSS å½±å“å…¶ä»–åº”ç”¨ã€‚è¿™äº›ç‰¹æ€§ä½¿å¾— `qiankun`åœ¨å¤„ç†å¤æ‚çš„å¾®å‰ç«¯åœºæ™¯æ—¶å…·æœ‰å¾ˆé«˜çš„çµæ´»æ€§ã€‚

`iframe` æ˜¯ä¸€ç§è¾ƒä¸ºä¼ ç»Ÿçš„å‰ç«¯æŠ€æœ¯ï¼Œå®ƒå¯ä»¥åœ¨ä¸€ä¸ªç‹¬ç«‹çš„çª—å£ä¸­åŠ è½½ä¸€ä¸ª HTML é¡µé¢ã€‚`iframe` æœ¬èº«å°±æ˜¯ä¸€ç§å¤©ç„¶çš„æ²™ç®±ï¼Œå®ƒå¯ä»¥å®Œå…¨éš”ç¦»å­åº”ç”¨çš„ JavaScript å’Œ CSSï¼Œé˜²æ­¢å­åº”ç”¨ä¹‹é—´çš„ç›¸äº’å½±å“ã€‚ç„¶è€Œï¼Œ
`iframe` çš„è¿™ç§éš”ç¦»æ€§ä¹Ÿæ˜¯å®ƒçš„ç¼ºç‚¹ï¼Œå› ä¸ºå®ƒä½¿å¾—ä¸»åº”ç”¨å’Œå­åº”ç”¨ä¹‹é—´çš„é€šä¿¡å˜å¾—å›°éš¾ã€‚æ­¤å¤–ï¼Œ`iframe` è¿˜æœ‰ä¸€äº›å…¶ä»–çš„é—®é¢˜ï¼Œæ¯”å¦‚æ€§èƒ½é—®é¢˜ã€SEO é—®é¢˜ç­‰ã€‚

åœ¨é€‰æ‹© `qiankun` å’Œ `iframe` æ—¶ï¼Œéœ€è¦æ ¹æ®å…·ä½“çš„ä½¿ç”¨åœºæ™¯æ¥å†³å®šã€‚å¦‚æœä½ çš„å­åº”ç”¨æ˜¯åŸºäºç°ä»£å‰ç«¯æ¡†æ¶ï¼ˆå¦‚ Reactã€Vueã€Angular ç­‰ï¼‰å¼€å‘çš„å•é¡µåº”ç”¨ï¼Œé‚£ä¹ˆ `qiankun`
å¯èƒ½æ˜¯ä¸€ä¸ªæ›´å¥½çš„é€‰æ‹©ï¼Œå› ä¸ºå®ƒå¯ä»¥æä¾›æ›´å¥½çš„ç”¨æˆ·ä½“éªŒå’Œæ›´é«˜çš„å¼€å‘æ•ˆç‡ã€‚å¦‚æœä½ çš„å­åº”ç”¨æ˜¯åŸºäº jQuery æˆ–è€…å…¶ä»–ä¼ ç»ŸæŠ€æœ¯å¼€å‘çš„å¤šé¡µåº”ç”¨ï¼Œæˆ–è€…ä½ éœ€è¦åœ¨å­åº”ç”¨ä¸­åŠ è½½ä¸€äº›ç¬¬ä¸‰æ–¹çš„é¡µé¢ï¼Œé‚£ä¹ˆ `iframe`
å¯èƒ½æ˜¯ä¸€ä¸ªæ›´å¥½çš„é€‰æ‹©ï¼Œå› ä¸ºå®ƒå¯ä»¥æä¾›æ›´å¼ºçš„éš”ç¦»æ€§ã€‚

## åœ¨ä½¿ç”¨ `qiankun` æ—¶ï¼Œä½ å¦‚ä½•å¤„ç†å¤šä¸ªå­é¡¹ç›®çš„è°ƒè¯•é—®é¢˜ï¼Ÿ

åœ¨ä½¿ç”¨`qiankun`å¤„ç†å¤šä¸ªå­é¡¹ç›®çš„è°ƒè¯•é—®é¢˜æ—¶ï¼Œé€šå¸¸çš„æ–¹å¼æ˜¯å°†æ¯ä¸ªå­é¡¹ç›®ä½œä¸ºä¸€ä¸ªç‹¬ç«‹çš„åº”ç”¨è¿›è¡Œå¼€å‘å’Œè°ƒè¯•ã€‚æ¯ä¸ªå­é¡¹ç›®éƒ½å¯ä»¥åœ¨æœ¬åœ°å¯åŠ¨ï¼Œå¹¶é€šè¿‡ä¿®æ”¹ä¸»åº”ç”¨çš„é…ç½®ï¼Œè®©ä¸»åº”ç”¨å»åŠ è½½æœ¬åœ°æ­£åœ¨è¿è¡Œçš„å­åº”ç”¨ï¼Œè¿™æ ·å°±å¯ä»¥å¯¹å­åº”ç”¨è¿›è¡Œè°ƒè¯•äº†ã€‚è¿™ç§æ–¹å¼çš„å¥½å¤„æ˜¯ï¼Œå­åº”ç”¨ä¸ä¸»åº”ç”¨è§£è€¦ï¼Œå¯ä»¥ç‹¬ç«‹è¿›è¡Œå¼€å‘å’Œè°ƒè¯•ï¼Œä¸ä¼šç›¸äº’å½±å“ã€‚

å¯¹äºå¦‚ä½•åŒæ—¶å¯åŠ¨å¤šä¸ªå­åº”ç”¨ï¼Œä½ å¯ä»¥ä½¿ç”¨`npm-run-all`è¿™ä¸ªå·¥å…·ã€‚`npm-run-all`æ˜¯ä¸€ä¸ª CLI å·¥å…·ï¼Œå¯ä»¥å¹¶è¡Œæˆ–è€…ä¸²è¡Œæ‰§è¡Œå¤šä¸ª npm è„šæœ¬ã€‚è¿™ä¸ªå·¥å…·å¯¹äºåŒæ—¶å¯åŠ¨å¤šä¸ªå­åº”ç”¨éå¸¸æœ‰ç”¨ã€‚ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1. é¦–å…ˆï¼Œä½ éœ€è¦åœ¨ä½ çš„é¡¹ç›®ä¸­å®‰è£…`npm-run-all`ï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢çš„å‘½ä»¤è¿›è¡Œå®‰è£…ï¼š

```

npm install --save-dev npm-run-all

```

1. ç„¶åï¼Œåœ¨ä½ çš„`package.json`æ–‡ä»¶ä¸­å®šä¹‰ä½ éœ€è¦å¹¶è¡Œè¿è¡Œçš„è„šæœ¬ã€‚æ¯”å¦‚ï¼Œä½ æœ‰ä¸¤ä¸ªå­åº”ç”¨ï¼Œåˆ†åˆ«ä¸º`app1`å’Œ`app2`ï¼Œä½ å¯ä»¥å®šä¹‰å¦‚ä¸‹çš„è„šæœ¬ï¼š

```

"scripts": {
"start:app1": "npm start --prefix ./app1",
"start:app2": "npm start --prefix ./app2",
"start:all": "npm-run-all start:app1 start:app2"
}

```

åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ`start:app1`å’Œ`start:app2`è„šæœ¬åˆ†åˆ«ç”¨äºå¯åŠ¨`app1`å’Œ`app2`åº”ç”¨ï¼Œ`start:all`è„šæœ¬åˆ™ç”¨äºåŒæ—¶å¯åŠ¨è¿™ä¸¤ä¸ªåº”ç”¨ã€‚

1. æœ€åï¼Œé€šè¿‡æ‰§è¡Œ`npm run start:all`å‘½ä»¤ï¼Œå°±å¯ä»¥åŒæ—¶å¯åŠ¨`app1`å’Œ`app2`è¿™ä¸¤ä¸ªåº”ç”¨äº†ã€‚

`npm-run-all`ä¸ä»…å¯ä»¥å¹¶è¡Œè¿è¡Œå¤šä¸ªè„šæœ¬ï¼Œè¿˜å¯ä»¥ä¸²è¡Œè¿è¡Œå¤šä¸ªè„šæœ¬ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½éœ€è¦æŒ‰ç…§ä¸€å®šçš„é¡ºåºå¯åŠ¨ä½ çš„åº”ç”¨ï¼Œè¿™æ—¶ä½ å¯ä»¥ä½¿ç”¨`npm-run-all`çš„`-s`é€‰é¡¹æ¥ä¸²è¡Œæ‰§è¡Œè„šæœ¬ï¼Œä¾‹å¦‚ï¼š
`npm-run-all -s script1 script2`ï¼Œè¿™å°†ä¼šå…ˆæ‰§è¡Œ`script1`ï¼Œç„¶åå†æ‰§è¡Œ`script2`ã€‚

## qiankun æ˜¯å¦‚ä½•å®ç° CSS éš”ç¦»çš„ï¼Œè¯¥æ–¹æ¡ˆæœ‰ä»€ä¹ˆç¼ºç‚¹ï¼Œè¿˜æœ‰å…¶å®ƒæ–¹æ¡ˆä¹ˆ

`qiankun`ä¸»è¦é€šè¿‡ä½¿ç”¨`Shadow DOM`æ¥å®ç° CSS éš”ç¦»ã€‚

1. `Shadow DOM`ï¼š`Shadow DOM`æ˜¯ä¸€ç§æµè§ˆå™¨å†…ç½®çš„ Web æ ‡å‡†æŠ€æœ¯ï¼Œå®ƒå¯ä»¥åˆ›å»ºä¸€ä¸ªå°é—­çš„ DOM ç»“æ„ï¼Œè¿™ä¸ª DOM ç»“æ„å¯¹å¤–éƒ¨æ˜¯éš”ç¦»çš„ï¼ŒåŒ…æ‹¬å…¶ CSS æ ·å¼ã€‚`qiankun`åœ¨æŒ‚è½½å­åº”ç”¨æ—¶ï¼Œä¼šå°†å­åº”ç”¨çš„ HTML
   å…ƒç´ æŒ‚è½½åˆ°`Shadow DOM`ä¸Šï¼Œä»è€Œå®ç° CSS çš„éš”ç¦»ã€‚

```

// qiankun ä½¿ç”¨ Shadow DOM æŒ‚è½½å­åº”ç”¨
const container = document.getElementById('container');
const shadowRoot = container.attachShadow({mode: 'open'});
shadowRoot.innerHTML = '<div id="subapp-container"></div>';

```

å¯¹äº`qiankun`çš„éš”ç¦»æ–¹æ¡ˆï¼Œä¸€ä¸ªæ½œåœ¨çš„ç¼ºç‚¹æ˜¯å®ƒéœ€è¦æµè§ˆå™¨æ”¯æŒ`Shadow DOM`ï¼Œè¿™åœ¨ä¸€äº›æ—§çš„æµè§ˆå™¨æˆ–è€…ä¸å…¼å®¹`Shadow DOM`çš„æµè§ˆå™¨ä¸­å¯èƒ½ä¼šå‡ºç°é—®é¢˜ã€‚

å¦ä¸€ç§å¯èƒ½çš„æ–¹æ¡ˆæ˜¯ä½¿ç”¨ CSS æ¨¡å—ï¼ˆCSS Modulesï¼‰ã€‚CSS æ¨¡å—æ˜¯ä¸€ç§å°† CSS ç±»åå±€éƒ¨åŒ–çš„æ–¹å¼ï¼Œå¯ä»¥é¿å…å…¨å±€æ ·å¼å†²çªã€‚åœ¨ä½¿ç”¨ CSS æ¨¡å—æ—¶ï¼Œæ¯ä¸ªæ¨¡å—çš„ç±»åéƒ½ä¼šè¢«è½¬æ¢æˆä¸€ä¸ªå”¯ä¸€çš„åå­—ï¼Œä»è€Œå®ç°æ ·å¼çš„éš”ç¦»ã€‚

ä¾‹å¦‚ï¼Œå‡è®¾ä½ æœ‰ä¸€ä¸ªåä¸º`Button`çš„ CSS æ¨¡å—ï¼š

```

/_ Button.module.css _/
.button {
background-color: blue;
}

```

åœ¨ä½ çš„ JavaScript æ–‡ä»¶ä¸­ï¼Œä½ å¯ä»¥è¿™æ ·å¼•å…¥å¹¶ä½¿ç”¨è¿™ä¸ªæ¨¡å—ï¼š

```

import styles from './Button.module.css';

function Button() {
return <button className={styles.button}>Click me</button>;
}

```

åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ`button`ç±»åä¼šè¢«è½¬æ¢æˆä¸€ä¸ªå”¯ä¸€çš„åå­—ï¼Œå¦‚`Button_button__xxx`ï¼Œè¿™æ ·å°±å¯ä»¥é¿å…å…¨å±€æ ·å¼å†²çªäº†ã€‚

3.BEM å‘½åè§„èŒƒéš”ç¦»

## qiankun ä¸­å¦‚ä½•å®ç°çˆ¶å­é¡¹ç›®é—´çš„é€šä¿¡ï¼Ÿå¦‚æœè®©ä½ å®ç°ä¸€å¥—é€šä¿¡æœºåˆ¶ï¼Œä½ è¯¥å¦‚ä½•å®ç°ï¼Ÿ

- `Actions` é€šä¿¡ï¼š`qiankun` å®˜æ–¹æä¾›çš„é€šä¿¡æ–¹å¼ï¼Œé€‚åˆä¸šåŠ¡åˆ’åˆ†æ¸…æ™°ï¼Œè¾ƒç®€å•çš„å¾®å‰ç«¯åº”ç”¨ã€‚è¿™ç§é€šä¿¡æ–¹å¼ä¸»è¦é€šè¿‡ `setGlobalState` è®¾ç½® `globalState`ï¼Œå¹¶é€šè¿‡ `onGlobalStateChange` å’Œ
  `offGlobalStateChange` æ¥æ³¨å†Œå’Œå–æ¶ˆ `è§‚å¯Ÿè€…` å‡½æ•°ï¼Œä»è€Œå®ç°é€šä¿¡ã€‚
- è‡ªå·±å®ç°ä¸€å¥—é€šä¿¡æœºåˆ¶ï¼ˆå¯ä»¥æ€è€ƒä¸€ä¸‹å¦‚ä½•è¿½è¸ª State çŠ¶æ€ï¼Œç±»ä¼¼ Redux æ¨¡å¼ï¼‰

1. **å…¨å±€å˜é‡**ï¼šåœ¨å…¨å±€ï¼ˆwindowï¼‰å¯¹è±¡ä¸Šå®šä¹‰å…±äº«çš„å±æ€§æˆ–æ–¹æ³•ã€‚è¿™ç§æ–¹å¼ç®€å•æ˜äº†ï¼Œä½†æœ‰å¯èƒ½å¯¼è‡´å…¨å±€æ±¡æŸ“ï¼Œéœ€è¦æ³¨æ„å˜é‡å‘½åä»¥é¿å…å†²çªã€‚

2. **è‡ªå®šä¹‰äº‹ä»¶**ï¼šä½¿ç”¨åŸç”Ÿçš„ CustomEvent æˆ–ç±»ä¼¼çš„ç¬¬ä¸‰æ–¹åº“æ¥æ´¾å‘å’Œç›‘å¬è‡ªå®šä¹‰äº‹ä»¶ã€‚è¿™ç§æ–¹å¼é¿å…äº†å…¨å±€æ±¡æŸ“ï¼Œæ›´åŠ ç¬¦åˆæ¨¡å—åŒ–çš„åŸåˆ™ï¼Œä½†å¯èƒ½éœ€è¦æ›´å¤æ‚çš„äº‹ä»¶ç®¡ç†ã€‚

3. - 2.1. **å®šä¹‰ä¸€ä¸ªå…¨å±€çš„é€šä¿¡å¯¹è±¡**ï¼Œä¾‹å¦‚ window.globalEventï¼Œè¿™ä¸ªå¯¹è±¡æä¾›ä¸¤ä¸ªæ–¹æ³•ï¼Œemit å’Œ onã€‚
   - 2.2. **emit æ–¹æ³•**ç”¨äºæ´¾å‘äº‹ä»¶ï¼Œæ¥æ”¶äº‹ä»¶åç§°å’Œå¯é€‰çš„äº‹ä»¶æ•°æ®ä½œä¸ºå‚æ•°ã€‚
   - 2.3. **on æ–¹æ³•**ç”¨äºç›‘å¬äº‹ä»¶ï¼Œæ¥æ”¶äº‹ä»¶åç§°å’Œå›è°ƒå‡½æ•°ä½œä¸ºå‚æ•°ã€‚å½“ç›¸åº”çš„äº‹ä»¶è¢«æ´¾å‘æ—¶ï¼Œå›è°ƒå‡½æ•°å°†è¢«æ‰§è¡Œã€‚

```

window.globalEvent = {
events: {},
emit(event, data) {
if (!this.events[event]) {
return;
}
this.events[event].forEach(callback => callback(data));
},
on(event, callback) {
if (!this.events[event]) {
this.events[event] = [];
}
this.events[event].push(callback);
},
};

```

### 1.åœ¨ä¸»é¡¹ç›®ä¸­ä½¿ç”¨ qiankun æ³¨å†Œå­é¡¹ç›®æ—¶ï¼Œå¦‚ä½•è§£å†³å­é¡¹ç›®è·¯ç”±çš„ hash ä¸ history æ¨¡å¼ä¹‹äº‰ï¼Ÿ

### å¦‚æœä¸»é¡¹ç›®ä½¿ç”¨ `history` æ¨¡å¼ï¼Œå¹¶ä¸”å­é¡¹ç›®å¯ä»¥ä½¿ç”¨ `history` æˆ– `hash` æ¨¡å¼ï¼Œè¿™æ˜¯ `qiankun` æ¨èçš„ä¸€ç§å½¢å¼ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå­é¡¹ç›®å¯ä»¥é€‰æ‹©é€‚åˆè‡ªå·±çš„è·¯ç”±æ¨¡å¼ï¼Œè€Œä¸”å¯¹äºå·²æœ‰çš„å­é¡¹ç›®ä¸éœ€è¦åšå¤ªå¤šä¿®æ”¹ã€‚ä½†æ˜¯å­é¡¹ç›®ä¹‹é—´çš„è·³è½¬éœ€è¦é€šè¿‡çˆ¶é¡¹ç›®çš„

`router` å¯¹è±¡æˆ–åŸç”Ÿçš„ `history` å¯¹è±¡è¿›è¡Œã€‚

### 2. å¦‚æœä¸»é¡¹ç›®å’Œæ‰€æœ‰å­é¡¹ç›®éƒ½é‡‡ç”¨ `hash` æ¨¡å¼ï¼Œå¯ä»¥æœ‰ä¸¤ç§åšæ³•ï¼š

- ä½¿ç”¨ `path` æ¥åŒºåˆ†å­é¡¹ç›®ï¼šè¿™ç§æ–¹å¼ä¸éœ€è¦å¯¹å­é¡¹ç›®è¿›è¡Œä¿®æ”¹ï¼Œä½†æ‰€æœ‰é¡¹ç›®ä¹‹é—´çš„è·³è½¬éœ€è¦å€ŸåŠ©åŸç”Ÿçš„ `history` å¯¹è±¡ã€‚
- ä½¿ç”¨ `hash` æ¥åŒºåˆ†å­é¡¹ç›®ï¼šè¿™ç§æ–¹å¼å¯ä»¥é€šè¿‡è‡ªå®šä¹‰ `activeRule` æ¥å®ç°ï¼Œä½†éœ€è¦å¯¹å­é¡¹ç›®è¿›è¡Œä¸€å®šçš„ä¿®æ”¹ï¼Œå°†å­é¡¹ç›®çš„è·¯ç”±åŠ ä¸Šå‰ç¼€ã€‚è¿™æ ·çš„è¯ï¼Œé¡¹ç›®ä¹‹é—´çš„è·³è½¬å¯ä»¥ç›´æ¥ä½¿ç”¨å„è‡ªçš„ `router` å¯¹è±¡æˆ–
  `<router-link>`ã€‚

### 3. å¦‚æœä¸»é¡¹ç›®é‡‡ç”¨ `hash` æ¨¡å¼ï¼Œè€Œå­é¡¹ç›®ä¸­æœ‰äº›é‡‡ç”¨ `history` æ¨¡å¼ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œå­é¡¹ç›®é—´çš„è·³è½¬åªèƒ½å€ŸåŠ©åŸç”Ÿçš„ `history` å¯¹è±¡ï¼Œè€Œä¸ä½¿ç”¨å­é¡¹ç›®è‡ªå·±çš„ `router` å¯¹è±¡ã€‚å¯¹äºå­é¡¹ç›®ï¼Œå¯ä»¥é€‰æ‹©ä½¿ç”¨

`path` æˆ– `hash` æ¥åŒºåˆ†ä¸åŒçš„å­é¡¹ç›®ã€‚

## åœ¨ qiankun ä¸­ï¼Œå¦‚æœå®ç°ç»„ä»¶åœ¨ä¸åŒé¡¹ç›®é—´çš„å…±äº«ï¼Œæœ‰å“ªäº›è§£å†³æ–¹æ¡ˆï¼Ÿ

> åœ¨é¡¹ç›®é—´å…±äº«ç»„ä»¶æ—¶ï¼Œå¯ä»¥è€ƒè™‘ä»¥ä¸‹å‡ ç§æ–¹å¼ï¼š

1. **çˆ¶å­é¡¹ç›®é—´çš„ç»„ä»¶å…±äº«**ï¼šä¸»é¡¹ç›®åŠ è½½æ—¶ï¼Œå°†ç»„ä»¶æŒ‚è½½åˆ°å…¨å±€å¯¹è±¡ï¼ˆå¦‚`window`ï¼‰ä¸Šï¼Œåœ¨å­é¡¹ç›®ä¸­ç›´æ¥æ³¨å†Œä½¿ç”¨è¯¥ç»„ä»¶ã€‚
2. **å­é¡¹ç›®é—´çš„ç»„ä»¶å…±äº«ï¼ˆå¼±ä¾èµ–ï¼‰**ï¼šé€šè¿‡ä¸»é¡¹ç›®æä¾›çš„å…¨å±€å˜é‡ï¼Œå­é¡¹ç›®æŒ‚è½½åˆ°å…¨å±€å¯¹è±¡ä¸Šã€‚å­é¡¹ç›®ä¸­çš„å…±äº«ç»„ä»¶å¯ä»¥ä½¿ç”¨å¼‚æ­¥ç»„ä»¶æ¥å®ç°ï¼Œåœ¨åŠ è½½ç»„ä»¶å‰å…ˆæ£€æŸ¥å…¨å±€å¯¹è±¡ä¸­æ˜¯å¦å­˜åœ¨ï¼Œå­˜åœ¨åˆ™å¤ç”¨ï¼Œå¦åˆ™åŠ è½½ç»„ä»¶ã€‚
3. **å­é¡¹ç›®é—´çš„ç»„ä»¶å…±äº«ï¼ˆå¼ºä¾èµ–ï¼‰**ï¼šåœ¨ä¸»é¡¹ç›®ä¸­é€šè¿‡`loadMicroApp`æ‰‹åŠ¨åŠ è½½æä¾›ç»„ä»¶çš„å­é¡¹ç›®ï¼Œç¡®ä¿å…ˆåŠ è½½è¯¥å­é¡¹ç›®ã€‚åœ¨åŠ è½½æ—¶ï¼Œå°†ç»„ä»¶æŒ‚è½½åˆ°å…¨å±€å¯¹è±¡ä¸Šï¼Œå¹¶å°†`loadMicroApp`
   å‡½æ•°ä¼ é€’ç»™å­é¡¹ç›®ã€‚å­é¡¹ç›®åœ¨éœ€è¦ä½¿ç”¨å…±äº«ç»„ä»¶çš„åœ°æ–¹ï¼Œæ‰‹åŠ¨åŠ è½½æä¾›ç»„ä»¶çš„å­é¡¹ç›®ï¼Œç­‰å¾…åŠ è½½å®Œæˆåå³å¯è·å–ç»„ä»¶ã€‚

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨ä½¿ç”¨å¼‚æ­¥ç»„ä»¶æˆ–æ‰‹åŠ¨åŠ è½½å­é¡¹ç›®æ—¶ï¼Œå¯èƒ½ä¼šé‡åˆ°æ ·å¼åŠ è½½çš„é—®é¢˜ï¼Œå¯ä»¥å°è¯•è§£å†³è¯¥é—®é¢˜ã€‚å¦å¤–ï¼Œå¦‚æœå…±äº«çš„ç»„ä»¶ä¾èµ–å…¨å±€æ’ä»¶ï¼ˆå¦‚`store`å’Œ`i18n`ï¼‰ï¼Œéœ€è¦è¿›è¡Œç‰¹æ®Šå¤„ç†ä»¥ç¡®ä¿æ’ä»¶çš„æ­£ç¡®åˆå§‹åŒ–ã€‚

## åœ¨ qiankun ä¸­ï¼Œåº”ç”¨ä¹‹é—´å¦‚ä½•å¤ç”¨ä¾èµ–ï¼Œé™¤äº† npm åŒ…æ–¹æ¡ˆå¤–ï¼Ÿ

1. åœ¨ä½¿ç”¨`webpack`æ„å»ºçš„å­é¡¹ç›®ä¸­ï¼Œè¦å®ç°å¤ç”¨å…¬å…±ä¾èµ–ï¼Œéœ€è¦é…ç½®`webpack`çš„`externals`ï¼Œå°†å…¬å…±ä¾èµ–æŒ‡å®šä¸ºå¤–éƒ¨ä¾èµ–ï¼Œä¸æ‰“åŒ…è¿›å­é¡¹ç›®çš„ä»£ç ä¸­ã€‚

2. å­é¡¹ç›®ä¹‹é—´çš„ä¾èµ–å¤ç”¨å¯ä»¥é€šè¿‡ä¿è¯ä¾èµ–çš„ URL ä¸€è‡´æ¥å®ç°ã€‚å¦‚æœå¤šä¸ªå­é¡¹ç›®éƒ½ä½¿ç”¨åŒä¸€ä»½ CDN æ–‡ä»¶ï¼ŒåŠ è½½æ—¶ä¼šå…ˆä»ç¼“å­˜è¯»å–ï¼Œé¿å…é‡å¤åŠ è½½ã€‚

3. å­é¡¹ç›®å¤ç”¨ä¸»é¡¹ç›®çš„ä¾èµ–å¯ä»¥é€šè¿‡ç»™å­é¡¹ç›®çš„`index.html`ä¸­çš„å…¬å…±ä¾èµ–çš„`script`å’Œ`link`æ ‡ç­¾æ·»åŠ è‡ªå®šä¹‰å±æ€§`ignore`æ¥å®ç°ã€‚åœ¨`qiankun`è¿è¡Œå­é¡¹ç›®æ—¶ï¼Œ`qiankun`ä¼šå¿½ç•¥è¿™äº›å¸¦æœ‰`ignore`
   å±æ€§çš„ä¾èµ–ï¼Œå­é¡¹ç›®ç‹¬ç«‹è¿è¡Œæ—¶ä»ç„¶å¯ä»¥åŠ è½½è¿™äº›ä¾èµ–ã€‚

4. åœ¨ä½¿ç”¨`qiankun`å¾®å‰ç«¯æ¡†æ¶æ—¶ï¼Œå¯èƒ½ä¼šå‡ºç°å­é¡¹ç›®ä¹‹é—´å’Œä¸»é¡¹ç›®ä¹‹é—´çš„å…¨å±€å˜é‡å†²çªçš„é—®é¢˜ã€‚è¿™æ˜¯å› ä¸ºå­é¡¹ç›®ä¸é…ç½®`externals`æ—¶ï¼Œå­é¡¹ç›®çš„å…¨å±€`Vue`å˜é‡ä¸å±äº`window`å¯¹è±¡ï¼Œè€Œ`qiankun`
   åœ¨è¿è¡Œå­é¡¹ç›®æ—¶ä¼šå…ˆæ‰¾å­é¡¹ç›®çš„`window`ï¼Œå†æ‰¾çˆ¶é¡¹ç›®çš„`window`ï¼Œå¯¼è‡´å…¨å±€å˜é‡å†²çªã€‚

5. è§£å†³å…¨å±€å˜é‡å†²çªçš„æ–¹æ¡ˆæœ‰ä¸‰ç§ï¼š

6. - æ–¹æ¡ˆä¸€æ˜¯åœ¨æ³¨å†Œå­é¡¹ç›®æ—¶ï¼Œåœ¨`beforeLoad`é’©å­å‡½æ•°ä¸­å¤„ç†å…¨å±€å˜é‡ï¼Œå°†å­é¡¹ç›®çš„å…¨å±€`Vue`å˜é‡è¿›è¡Œæ›¿æ¢ï¼Œä»¥è§£å†³å­é¡¹ç›®ç‹¬ç«‹è¿è¡Œæ—¶çš„å…¨å±€å˜é‡å†²çªé—®é¢˜ã€‚
   - æ–¹æ¡ˆäºŒæ˜¯é€šè¿‡ä¸»é¡¹ç›®å°†ä¾èµ–é€šè¿‡`props`ä¼ é€’ç»™å­é¡¹ç›®ï¼Œå­é¡¹ç›®åœ¨ç‹¬ç«‹è¿è¡Œæ—¶ä½¿ç”¨ä¼ é€’è¿‡æ¥çš„ä¾èµ–ï¼Œé¿å…ä¸ä¸»é¡¹ç›®çš„å…¨å±€å˜é‡å†²çªã€‚
   - æ–¹æ¡ˆä¸‰æ˜¯ä¿®æ”¹ä¸»é¡¹ç›®å’Œå­é¡¹ç›®çš„ä¾èµ–åç§°ï¼Œä½¿å®ƒä»¬ä¸ä¼šç›¸äº’å†²çªï¼Œä»è€Œé¿å…å…¨å±€å˜é‡å†²çªçš„é—®é¢˜ã€‚

## è¯´è¯´ webpack5 è”é‚¦æ¨¡å—åœ¨å¾®å‰ç«¯çš„åº”ç”¨

> Webpack 5 çš„è”é‚¦æ¨¡å—ï¼ˆFederation Moduleï¼‰æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„ç‰¹æ€§ï¼Œå¯ä»¥åœ¨å¾®å‰ç«¯åº”ç”¨ä¸­å®ç°æ¨¡å—å…±äº«å’ŒåŠ¨æ€åŠ è½½ï¼Œä»è€Œæä¾›æ›´å¥½çš„ä»£ç å¤ç”¨å’Œå¯æ‰©å±•æ€§

### 1. æ¨¡å—å…±äº«

Webpack 5 çš„è”é‚¦æ¨¡å—å…è®¸ä¸åŒçš„å¾®å‰ç«¯åº”ç”¨ä¹‹é—´å…±äº«æ¨¡å—ï¼Œé¿å…é‡å¤åŠ è½½å’Œä»£ç å†—ä½™ã€‚é€šè¿‡è”é‚¦æ¨¡å—ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä¸€äº›å…¬å…±çš„æ¨¡å—æŠ½ç¦»æˆä¸€ä¸ªç‹¬ç«‹çš„æ¨¡å—ï¼Œå¹¶åœ¨å„ä¸ªå¾®å‰ç«¯åº”ç”¨ä¸­è¿›è¡Œå¼•ç”¨ã€‚è¿™æ ·å¯ä»¥èŠ‚çœèµ„æºï¼Œå¹¶æé«˜åº”ç”¨çš„åŠ è½½é€Ÿåº¦ã€‚

```

// main-app webpack.config.js
const HtmlWebpackPlugin = require('html-webpack-plugin');
const { ModuleFederationPlugin } = require('webpack').container;

module.exports = {
// ...å…¶ä»–é…ç½®

plugins: [
new HtmlWebpackPlugin(),
new ModuleFederationPlugin({
name: 'main_app',
remotes: {
shared_module: 'shared_module@http://localhost:8081/remoteEntry.js',
},
}),
],
};

// shared-module webpack.config.js
const { ModuleFederationPlugin } = require('webpack').container;

module.exports = {
// ...å…¶ä»–é…ç½®

plugins: [
new ModuleFederationPlugin({
name: 'shared_module',
filename: 'remoteEntry.js',
exposes: {
'./Button': './src/components/Button',
},
}),
],
};

```

åœ¨ä¸Šè¿°ç¤ºä¾‹ä¸­ï¼Œ`main-app` å’Œ `shared-module` åˆ†åˆ«æ˜¯ä¸¤ä¸ªå¾®å‰ç«¯åº”ç”¨çš„ webpack é…ç½®æ–‡ä»¶ã€‚é€šè¿‡ `ModuleFederationPlugin` æ’ä»¶ï¼Œ`shared-module` å°† `Button` ç»„ä»¶æš´éœ²ç»™å…¶ä»–åº”ç”¨ä½¿ç”¨ï¼Œè€Œ
`main-app` åˆ™é€šè¿‡ `remotes` é…ç½®å¼•å…¥äº† `shared-module`ã€‚

### 2. åŠ¨æ€åŠ è½½

Webpack 5 è”é‚¦æ¨¡å—è¿˜æ”¯æŒåŠ¨æ€åŠ è½½æ¨¡å—ï¼Œè¿™å¯¹äºå¾®å‰ç«¯åº”ç”¨çš„æŒ‰éœ€åŠ è½½å’Œæ€§èƒ½ä¼˜åŒ–éå¸¸æœ‰ç”¨ã€‚é€šè¿‡åŠ¨æ€åŠ è½½ï¼Œå¯ä»¥åœ¨éœ€è¦æ—¶åŠ¨æ€åœ°åŠ è½½è¿œç¨‹æ¨¡å—ï¼Œè€Œä¸æ˜¯åœ¨åº”ç”¨åˆå§‹åŒ–æ—¶ä¸€æ¬¡æ€§åŠ è½½æ‰€æœ‰æ¨¡å—ã€‚

```

// main-app
const remoteModule = () => import('shared_module/Button');

// ...å…¶ä»–ä»£ç 

// åœ¨éœ€è¦çš„æ—¶å€™åŠ¨æ€åŠ è½½æ¨¡å—
remoteModule().then((module) => {
// ä½¿ç”¨åŠ è½½çš„æ¨¡å—
const Button = module.default;
// ...
});

```

åœ¨ä¸Šè¿°ç¤ºä¾‹ä¸­ï¼Œ`main-app` ä½¿ç”¨ `import()` å‡½æ•°åŠ¨æ€åŠ è½½ `shared_module` ä¸­çš„ `Button` ç»„ä»¶ã€‚é€šè¿‡åŠ¨æ€åŠ è½½ï¼Œå¯ä»¥åœ¨éœ€è¦æ—¶å¼‚æ­¥åœ°åŠ è½½è¿œç¨‹æ¨¡å—ï¼Œå¹¶åœ¨åŠ è½½å®Œæˆåä½¿ç”¨æ¨¡å—ã€‚

åœ¨å¾®å‰ç«¯åº”ç”¨ä¸­å¯ä»¥å®ç°æ¨¡å—å…±äº«å’ŒåŠ¨æ€åŠ è½½ï¼Œæä¾›äº†æ›´å¥½çš„ä»£ç å¤ç”¨å’Œå¯æ‰©å±•æ€§ã€‚é€šè¿‡æ¨¡å—å…±äº«ï¼Œå¯ä»¥é¿å…é‡å¤åŠ è½½å’Œä»£ç å†—ä½™ï¼Œè€ŒåŠ¨æ€åŠ è½½åˆ™å¯ä»¥æŒ‰éœ€åŠ è½½æ¨¡å—ï¼Œæé«˜åº”ç”¨çš„æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒã€‚

## è¯´è¯´ qiankun çš„èµ„æºåŠ è½½æœºåˆ¶ï¼ˆimport-html-entryï¼‰

> `qiankun import-html-entry` æ˜¯ qiankun æ¡†æ¶ä¸­ç”¨äºåŠ è½½å­åº”ç”¨çš„ HTML å…¥å£æ–‡ä»¶çš„å·¥å…·å‡½æ•°ã€‚å®ƒæä¾›äº†ä¸€ç§æ–¹ä¾¿çš„æ–¹å¼æ¥åŠ¨æ€åŠ è½½å’Œè§£æå­åº”ç”¨çš„ HTML å…¥å£æ–‡ä»¶ï¼Œå¹¶è¿”å›ä¸€ä¸ªå¯ä»¥åŠ è½½å­åº”ç”¨çš„
> JavaScript æ¨¡å—ã€‚

å…·ä½“è€Œè¨€ï¼Œ`import-html-entry` å®ç°äº†ä»¥ä¸‹åŠŸèƒ½ï¼š

-

- 1.  åŠ è½½ HTML å…¥å£æ–‡ä»¶ï¼š`import-html-entry` ä¼šé€šè¿‡åˆ›å»ºä¸€ä¸ª `<link>` æ ‡ç­¾æ¥åŠ è½½å­åº”ç”¨çš„ HTML å…¥å£æ–‡ä»¶ã€‚è¿™æ ·å¯ä»¥ç¡®ä¿å­åº”ç”¨çš„èµ„æºå¾—åˆ°æ­£ç¡®åŠ è½½ï¼Œå¹¶åœ¨åŠ è½½å®Œæˆåè¿›è¡Œå¤„ç†ã€‚

-

- 1.  è§£æ HTML å…¥å£æ–‡ä»¶ï¼šä¸€æ—¦ HTML å…¥å£æ–‡ä»¶åŠ è½½å®Œæˆï¼Œ`import-html-entry` å°†è§£æè¯¥æ–‡ä»¶çš„å†…å®¹ï¼Œæå–å‡ºå­åº”ç”¨çš„ JavaScript å’Œ CSS èµ„æºçš„ URLã€‚

-

- 1.  åŠ¨æ€åŠ è½½ JavaScript å’Œ CSS èµ„æºï¼š`import-html-entry` ä½¿ç”¨åŠ¨æ€åˆ›å»º `<script>` å’Œ `<link>` æ ‡ç­¾çš„æ–¹å¼ï¼ŒæŒ‰ç…§æ­£ç¡®çš„é¡ºåºåŠ è½½å­åº”ç”¨çš„ JavaScript å’Œ CSS èµ„æºã€‚

-

- 1.  åˆ›å»ºæ²™ç®±ç¯å¢ƒï¼šåœ¨åŠ è½½å­åº”ç”¨çš„ JavaScript èµ„æºæ—¶ï¼Œ`import-html-entry` ä¼šåˆ›å»ºä¸€ä¸ªæ²™ç®±ç¯å¢ƒï¼ˆsandboxï¼‰ï¼Œç”¨äºéš”ç¦»å­åº”ç”¨çš„å…¨å±€å˜é‡å’Œè¿è¡Œç¯å¢ƒï¼Œé˜²æ­¢å­åº”ç”¨ä¹‹é—´çš„å†²çªå’Œæ±¡æŸ“ã€‚

-

- 1.  è¿”å›å­åº”ç”¨çš„å…¥å£æ¨¡å—ï¼šæœ€åï¼Œ`import-html-entry` è¿”å›ä¸€ä¸ªå¯ä»¥åŠ è½½å­åº”ç”¨çš„ JavaScript æ¨¡å—ã€‚è¿™ä¸ªæ¨¡å—é€šå¸¸æ˜¯ä¸€ä¸ªåŒ…å«å­åº”ç”¨åˆå§‹åŒ–ä»£ç çš„å‡½æ•°ï¼Œå¯ä»¥åœ¨ä¸»åº”ç”¨ä¸­è°ƒç”¨ä»¥åŠ è½½å’Œå¯åŠ¨å­åº”ç”¨ã€‚

é€šè¿‡ä½¿ç”¨ `qiankun import-html-entry`ï¼Œå¼€å‘è€…å¯ä»¥æ–¹ä¾¿åœ°å°†å­åº”ç”¨çš„ HTML å…¥å£æ–‡ä»¶ä½œä¸ºæ¨¡å—åŠ è½½ï¼Œå¹¶è·å¾—ä¸€ä¸ªå¯ä»¥åŠ è½½å’Œå¯åŠ¨å­åº”ç”¨çš„å‡½æ•°ï¼Œç®€åŒ–äº†å­åº”ç”¨çš„åŠ è½½å’Œé›†æˆè¿‡ç¨‹ã€‚

## è¯´è¯´ç°æœ‰çš„å‡ ç§å¾®å‰ç«¯æ¡†æ¶ï¼Œå®ƒä»¬çš„ä¼˜ç¼ºç‚¹ï¼Ÿ

ä»¥ä¸‹æ˜¯å¯¹å„ä¸ªå¾®å‰ç«¯æ¡†æ¶ä¼˜ç¼ºç‚¹çš„æ€»ç»“ï¼š

1. **qiankun æ–¹æ¡ˆ**

   **ä¼˜ç‚¹**

   **ç¼ºç‚¹**

2. - é€‚é…æˆæœ¬è¾ƒé«˜ï¼ŒåŒ…æ‹¬å·¥ç¨‹åŒ–ã€ç”Ÿå‘½å‘¨æœŸã€é™æ€èµ„æºè·¯å¾„ã€è·¯ç”±ç­‰æ–¹é¢çš„é€‚é…ï¼›
   - css æ²™ç®±çš„ä¸¥æ ¼éš”ç¦»å¯èƒ½å¼•å‘é—®é¢˜ï¼Œjs æ²™ç®±åœ¨æŸäº›åœºæ™¯ä¸‹æ‰§è¡Œæ€§èƒ½ä¸‹é™ï¼›
   - æ— æ³•åŒæ—¶æ¿€æ´»å¤šä¸ªå­åº”ç”¨ï¼Œä¸æ”¯æŒå­åº”ç”¨ä¿æ´»ï¼›
   - ä¸æ”¯æŒ vite ç­‰ esmodule è„šæœ¬è¿è¡Œã€‚
   - é™ä½äº†åº”ç”¨æ”¹é€ çš„æˆæœ¬ï¼Œé€šè¿‡ html entry çš„æ–¹å¼å¼•å…¥å­åº”ç”¨ï¼›
   - æä¾›äº†å®Œå¤‡çš„æ²™ç®±æ–¹æ¡ˆï¼ŒåŒ…æ‹¬ js æ²™ç®±å’Œ css æ²™ç®±ï¼›
   - æ”¯æŒé™æ€èµ„æºé¢„åŠ è½½èƒ½åŠ›ã€‚

3. **micro-app æ–¹æ¡ˆ**

   **ä¼˜ç‚¹**

   **ç¼ºç‚¹**

4. - æ¥å…¥æˆæœ¬è™½ç„¶é™ä½ï¼Œä½†è·¯ç”±ä¾ç„¶å­˜åœ¨ä¾èµ–ï¼›
   - å¤šåº”ç”¨æ¿€æ´»åæ— æ³•ä¿æŒå„å­åº”ç”¨çš„è·¯ç”±çŠ¶æ€ï¼Œåˆ·æ–°åå…¨éƒ¨ä¸¢å¤±ï¼›
   - css æ²™ç®±æ— æ³•å®Œå…¨éš”ç¦»ï¼Œjs æ²™ç®±åšå…¨å±€å˜é‡æŸ¥æ‰¾ç¼“å­˜ï¼Œæ€§èƒ½æœ‰æ‰€ä¼˜åŒ–ï¼›
   - æ”¯æŒ vite è¿è¡Œï¼Œä½†å¿…é¡»ä½¿ç”¨ plugin æ”¹é€ å­åº”ç”¨ï¼Œä¸” js ä»£ç æ²¡åŠæ³•åšæ²™ç®±éš”ç¦»ï¼›
   - å¯¹äºä¸æ”¯æŒ webcomponent çš„æµè§ˆå™¨æ²¡æœ‰åšé™çº§å¤„ç†ã€‚
   - ä½¿ç”¨ webcomponent åŠ è½½å­åº”ç”¨ï¼Œæ›´ä¼˜é›…ï¼›
   - å¤ç”¨ç»è¿‡å¤§é‡é¡¹ç›®éªŒè¯è¿‡çš„ qiankun æ²™ç®±æœºåˆ¶ï¼Œæé«˜äº†æ¡†æ¶çš„å¯é æ€§ï¼›
   - æ”¯æŒå­åº”ç”¨ä¿æ´»ï¼›
   - é™ä½äº†å­åº”ç”¨æ”¹é€ çš„æˆæœ¬ï¼Œæä¾›äº†é™æ€èµ„æºé¢„åŠ è½½èƒ½åŠ›ã€‚

5. **EMP æ–¹æ¡ˆ**

   **ä¼˜ç‚¹**

   **ç¼ºç‚¹**

6. - å¯¹ webpack å¼ºä¾èµ–ï¼Œå¯¹äºè€æ—§é¡¹ç›®ä¸å‹å¥½ï¼›
   - æ²¡æœ‰æœ‰æ•ˆçš„ css æ²™ç®±å’Œ js æ²™ç®±ï¼Œéœ€è¦é ç”¨æˆ·è‡ªè§‰ï¼›
   - å­åº”ç”¨ä¿æ´»ã€å¤šåº”ç”¨æ¿€æ´»æ— æ³•å®ç°ï¼›
   - ä¸»ã€å­åº”ç”¨çš„è·¯ç”±å¯èƒ½å‘ç”Ÿå†²çªã€‚
   - webpack è”é‚¦ç¼–è¯‘å¯ä»¥ä¿è¯æ‰€æœ‰å­åº”ç”¨ä¾èµ–è§£è€¦ï¼›
   - æ”¯æŒåº”ç”¨é—´å»ä¸­å¿ƒåŒ–çš„è°ƒç”¨ã€å…±äº«æ¨¡å—ï¼›
   - æ”¯æŒæ¨¡å—è¿œç¨‹ ts æ”¯æŒã€‚

7. **æ— ç•Œæ–¹æ¡ˆ**

   **ä¼˜ç‚¹**

   **ç¼ºç‚¹**

8. - åœ¨ç»§æ‰¿äº† iframe ä¼˜ç‚¹çš„åŒæ—¶ï¼Œç¼ºç‚¹ä¾æ—§è¿˜æ˜¯å­˜åœ¨
   - åŸºäº webcomponent å®¹å™¨å’Œ iframe æ²™ç®±ï¼Œå……åˆ†è§£å†³äº†é€‚é…æˆæœ¬ã€æ ·å¼éš”ç¦»ã€è¿è¡Œæ€§èƒ½ã€é¡µé¢ç™½å±ã€å­åº”ç”¨é€šä¿¡ã€å­åº”ç”¨ä¿æ´»ã€å¤šåº”ç”¨æ¿€æ´»ã€vite æ¡†æ¶æ”¯æŒã€åº”ç”¨å…±äº«ç­‰é—®é¢˜ã€‚

---

**å°ç¨‹åº å·²è¢«ä»£ç ä¾èµ–åˆ†æå¿½ç•¥ï¼Œæ— æ³•è¢«å…¶ä»–æ¨¡å—å¼•ç”¨ã€‚ä½ å¯æ ¹æ®æ§åˆ¶å°ä¸­çš„ã€ä»£ç ä¾èµ–åˆ†æã€‘å‘Šè­¦ä¿¡æ¯ä¿®æ”¹ä»£ç ï¼Œæˆ–å…³é—­ã€è¿‡æ»¤æ— ä¾èµ–æ–‡ä»¶ã€‘åŠŸèƒ½**

åªéœ€åœ¨â€œproject.config.jsonâ€=>â€œsettingâ€é‡Œé¢å°†"ignoreDevUnusedFiles"å’Œ"ignoreUploadUnusedFiles"éƒ½è®¾ç½®ä¸º falseï¼Œç„¶åä¿å­˜ï¼Œé‡æ–°ç¼–è¯‘å³å¯ã€‚

```json
"ignoreDevUnusedFiles": false,
"ignoreUploadUnusedFiles": false,
```

---

```js
// jså°†å¤§æ•°å­—å•ä½è½¬åŒ–æˆ åƒã€ä¸‡ã€åƒä¸‡ã€äº¿
function transform(value: number) {
  let newValue = ['', '', '']
  let fr = 1000
  const ad = 1
  let num = 3
  const fm = 1
  while (value / fr >= 1) {
    fr *= 10
    num += 1
    console.log('æ•°å­—', value / fr, 'num:', num)
  }
  if (num <= 4) {
    // åƒ
    newValue[1] = 'åƒ'
    newValue[0] = parseInt(value / 1000) + ''
  } else if (num <= 8) {
    // ä¸‡
    const text1 = parseInt(num - 4) / 3 > 1 ? 'åƒä¸‡' : 'ä¸‡'
    // tslint:disable-next-line:no-shadowed-variable
    const fm = 'ä¸‡' === text1 ? 10000 : 10000000
    newValue[1] = text1
    newValue[0] = value / fm + ''
  } else if (num <= 16) {
    // äº¿
    let text1 = (num - 8) / 3 > 1 ? 'åƒäº¿' : 'äº¿'
    text1 = (num - 8) / 4 > 1 ? 'ä¸‡äº¿' : text1
    text1 = (num - 8) / 7 > 1 ? 'åƒä¸‡äº¿' : text1
    // tslint:disable-next-line:no-shadowed-variable
    let fm = 1
    if ('äº¿' === text1) {
      fm = 100000000
    } else if ('åƒäº¿' === text1) {
      fm = 100000000000
    } else if ('ä¸‡äº¿' === text1) {
      fm = 1000000000000
    } else if ('åƒä¸‡äº¿' === text1) {
      fm = 1000000000000000
    }
    newValue[1] = text1
    newValue[0] = parseInt(value / fm) + ''
  }
  if (value < 1000) {
    newValue[1] = ''
    newValue[0] = value + ''
  }
  return newValue.join('')
}
```

```
æ–‡å­—æè¾¹
-webkit-text-stroke å±…ä¸­æè¾¹
paint-order é…åˆ -webkit-text-stroke ä½¿ç”¨ï¼Œå€¼ä¸º stroke æ—¶ï¼Œå¤–æè¾¹
paint-order:markers|stroke|fill
text-shadowï¼šåªé€‚åˆå°çš„å¤–æè¾¹
```

å‰ç«¯æ‰“å° printjs

# ã€é˜¿é‡Œã€‘å¦‚ä½•å®ç°é¡µé¢æ–‡æœ¬ä¸å¯å¤åˆ¶

æœ‰ CSS å’Œ JS ä¸¤ç§æ–¹æ³•ï¼Œä»¥ä¸‹ä»»é€‰å…¶ä¸€æˆ–ç»“åˆä½¿ç”¨

ä½¿ç”¨ CSS å¦‚ä¸‹ï¼š

```css
user-select: none;
```

æˆ–ä½¿ç”¨ JS å¦‚ä¸‹ï¼Œç›‘å¬ `selectstart` äº‹ä»¶ï¼Œç¦æ­¢é€‰ä¸­ã€‚

å½“ç”¨æˆ·é€‰ä¸­ä¸€ç‰‡åŒºåŸŸæ—¶ï¼Œå°†è§¦å‘ `selectstart` äº‹ä»¶ï¼ŒSelection API å°†ä¼šé€‰ä¸­ä¸€ç‰‡åŒºåŸŸã€‚ç¦æ­¢é€‰ä¸­åŒºåŸŸå³å¯å®ç°é¡µé¢æ–‡æœ¬ä¸å¯å¤åˆ¶ã€‚

```javascript
document.body.onselectstart = (e) => {
  e.preventDefault()
}

document.body.oncopy = (e) => {
  e.preventDefault()
}
```

# ã€å­—èŠ‚ã€‘ç®€å•ä»‹ç» requestIdleCallback åŠä½¿ç”¨åœºæ™¯

`requestIdleCallback` ç»´æŠ¤ä¸€ä¸ªé˜Ÿåˆ—ï¼Œå°†åœ¨æµè§ˆå™¨ç©ºé—²æ—¶é—´å†…æ‰§è¡Œã€‚å®ƒå±äº Background Tasks APIï¼Œä½ å¯ä»¥ä½¿ç”¨ `setTimeout` æ¥æ¨¡æ‹Ÿå®ç°

```javascript
window.requestIdleCallback =
  window.requestIdleCallback ||
  function (handler) {
    let startTime = Date.now()

    return setTimeout(function () {
      handler({
        didTimeout: false,
        timeRemaining: function () {
          return Math.max(0, 50.0 - (Date.now() - startTime))
        },
      })
    }, 1)
  }
```

å¯ä»¥åœ¨ `ric` ä¸­æ‰§è¡Œä»»åŠ¡æ—¶éœ€è¦æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š

1. æ‰§è¡Œé‡è®¡ç®—è€Œéç´§æ€¥ä»»åŠ¡
2. ç©ºé—²å›è°ƒæ‰§è¡Œæ—¶é—´åº”è¯¥å°äº 50msï¼Œæœ€å¥½æ›´å°‘
3. ç©ºé—²å›è°ƒä¸­ä¸è¦æ“ä½œ DOMï¼Œå› ä¸ºå®ƒæœ¬æ¥å°±æ˜¯åˆ©ç”¨çš„é‡æ‹é‡ç»˜åçš„é—´éš™ç©ºé—²æ—¶é—´ï¼Œé‡æ–°æ“ä½œ DOM åˆä¼šé€ æˆé‡æ‹é‡ç»˜

# ã€å¤´æ¡ã€‘å‰ç«¯ä¸Šä¼ æ–‡ä»¶æ—¶å¦‚ä½•è¯»å–æ–‡ä»¶å†…å®¹

```
<input type="file" id="input" onchange="handleFiles(this.files)">
```

åœ¨æµè§ˆå™¨ä¸­ï¼Œé€šè¿‡ `input[type=file]` æ¥ç‚¹å‡»ä¸Šä¼ æ–‡ä»¶ï¼Œæ­¤æ—¶ç›‘å¬ `onChange` äº‹ä»¶ï¼Œå¯ä»¥è·å–åˆ° `File` å¯¹è±¡ï¼Œå…¶ä¸­ä»ä¸­å¯ä»¥è¯»å–æ–‡ä»¶å†…å®¹

è€Œè¯»å–æ–‡ä»¶å†…å®¹ï¼Œéœ€è¦è½¬åŒ– `File/Blob` åˆ° `Text`ï¼Œä¸€èˆ¬ä½¿ç”¨ä»¥ä¸‹ä¸¤ç§æ–¹æ¡ˆ

## **FileReader API**

è¿™æ˜¯æœ€å¸¸ç”¨å¤„ç†ä¸Šä¼ æ–‡ä»¶çš„ APIï¼Œä½†æ˜¯å´ç¹çå†—ä½™éš¾è®°ï¼Œæ¯æ¬¡ä½¿ç”¨åŸºæœ¬ä¸Šéƒ½è¦æŸ¥æ–‡æ¡£ï¼

`FileReader API` ç”¨ä»¥è¯»å– File/Blob å†…å®¹ï¼Œæ­£å› ä¸ºç¹çéš¾è®°ï¼Œä»¥ä¸‹å®ç°ä¸€ä¸ª `readBlob` å‡½æ•°è¯»å–å†…å®¹ã€‚

```javascript
function readBlob(blob) {
  return new Promise((resolve) => {
    const reader = new FileReader()
    reader.onload = function (e) {
      resolve(e.target.result)
    }
    reader.readAsText(blob)
  })
}
```

## **Response API**

è€Œæ˜¯ç”¨ `Response API` åªéœ€è¦ä¸€è¡Œå†…å®¹

```javascript
const readBlob = (blob) => new Response(blob).text()
```

# ç®­å¤´å‡½æ•°

1. ä¸èƒ½ä½¿ç”¨ new è°ƒç”¨ï¼ˆä¸èƒ½å½“ä½œæ„é€ å‡½æ•°ï¼‰

2. æ²¡æœ‰åŸå‹ï¼Œ å³æ²¡æœ‰ `prototype` å±æ€§

3. æ²¡æœ‰ arguments

4. æ²¡æœ‰ this

   ç®­å¤´å‡½æ•°ä¸­çš„ this æ˜¯åœ¨ç®­å¤´å‡½æ•°å®šä¹‰æ—¶å°±å†³å®šçš„ï¼Œè€Œä¸”ä¸å¯ä¿®æ”¹çš„ï¼ˆcallã€applyã€bindï¼‰

   ç®­å¤´å‡½æ•°çš„ this æŒ‡å‘å®šä¹‰æ—¶ï¼Œå¤–å±‚ä¸­ç¬¬ä¸€ä¸ªæ™®é€šå‡½æ•°çš„ this

# computedã€methodsã€watch æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

1. computed å’Œ methods çš„åŒºåˆ«

   computed æ˜¯æœ‰ç¼“å­˜çš„ï¼Œmethods æ²¡æœ‰ç¼“å­˜

2. computed å’Œ watch çš„åŒºåˆ«

   watch æ˜¯ç›‘å¬ï¼Œæ•°æ®æˆ–è€…è·¯ç”±å‘ç”Ÿäº†æ”¹å˜æ‰å¯ä»¥å“åº”ï¼ˆæ‰§è¡Œï¼‰

   computed è®¡ç®—æŸä¸€ä¸ªå±æ€§çš„æ”¹å˜ï¼Œå¦‚æœæŸä¸€ä¸ªå€¼æ”¹å˜äº†ï¼Œè®¡ç®—å±æ€§ä¼šç›‘æµ‹åˆ°è¿›è¡Œè¿”å›

   watch æ˜¯å½“å‰ç›‘å¬åˆ°æ•°æ®æ”¹å˜äº†ï¼Œæ‰ä¼šæ‰§è¡Œå†…éƒ¨ä»£ç 

# var let const

éƒ½æ˜¯ç”¨æ¥å£°æ˜å˜é‡

åŒºåˆ«ä¸€ï¼š

var å…·æœ‰å˜é‡æå‡æœºåˆ¶ï¼Œlet å’Œ const æ²¡æœ‰å˜é‡æå‡çš„æœºåˆ¶

åŒºåˆ«äºŒï¼š

var å¯ä»¥å¤šæ¬¡å£°æ˜åŒä¸€ä¸ªå˜é‡ï¼Œlet å’Œ const ä¸å¯ä»¥å¤šæ¬¡å£°æ˜åŒä¸€ä¸ªå˜é‡

åŒºåˆ«ä¸‰ï¼š

varã€let å£°æ˜å˜é‡çš„ï¼Œconst å£°æ˜å¸¸é‡

var å’Œ let å£°æ˜çš„å˜é‡å¯ä»¥å†æ¬¡èµ‹å€¼ï¼Œä½†æ˜¯ const ä¸å¯ä»¥å†æ¬¡èµ‹å€¼

åŒºåˆ«å››ï¼šå—çº§ä½œç”¨åŸŸ

var å£°æ˜çš„å˜é‡æ²¡æœ‰è‡ªèº«ä½œç”¨åŸŸï¼Œlet å’Œ const å£°æ˜çš„å˜é‡æœ‰è‡ªèº«çš„ä½œç”¨åŸŸ

var å£°æ˜çš„å˜é‡è¢«æŒ‚åˆ° window

# computed çš„å€¼å¯ä»¥ç”¨ v-model ç»‘å®šå—ï¼Ÿ

ä¸å¯ä»¥ã€‚å‡†ç¡®åœ°è¯´ï¼Œç”¨ v-model ç»‘å®šäº† computed çš„å€¼åï¼Œå¯ä»¥åœ¨ç»‘å®šçš„å…ƒç´ ä¸­å¾—åˆ° computed çš„ç»“æœï¼Œä½†ä¸èƒ½å®ç°åŒå‘ç»‘å®šã€‚

v-model é€šå¸¸ç”¨æ¥ç»‘å®š inputã€select ç­‰æ ‡ç­¾ï¼Œç›®çš„æ˜¯ä¸ºäº†å®ç°åŒå‘ç»‘å®šï¼Œå½“åŸå§‹å±æ€§å‘ç”Ÿå˜åŒ–æ—¶ï¼Œç»‘å®šæ ‡ç­¾çš„å€¼ä¹Ÿä¼šå‘ç”Ÿå˜åŒ–ï¼›å½“æ ‡ç­¾çš„å€¼å‘ç”Ÿå˜åŒ–æ—¶ï¼ŒåŸå§‹å±æ€§åŒæ ·å˜åŒ–ã€‚è€Œ computed
æ˜¯é€šè¿‡åŸå§‹å±æ€§è®¡ç®—å‡ºçš„ç»“æœï¼Œæ˜¯å•å‘åªè¯»çš„ï¼Œä¸èƒ½ç›´æ¥ä¿®æ”¹ã€‚

# mutations å’Œ actions åŒºåˆ«

action æäº¤çš„æ˜¯ mutationï¼Œè€Œä¸æ˜¯ç›´æ¥å˜æ›´çŠ¶æ€

action å¯ä»¥åŒ…å«ä»»æ„å¼‚æ­¥æ“ä½œ

# JS ä¸­çš„è®¡æ—¶å™¨æ˜¯å¦èƒ½ç²¾ç¡®è®¡æ—¶ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ

1. ç¡¬ä»¶

   åŸå­é’Ÿ

2. ç³»ç»Ÿ

   æ“ä½œç³»ç»Ÿçš„è®¡æ—¶

3. æ ‡å‡† w3c

   setTimeout `>=5` çš„åµŒå¥—å±‚çº§ï¼Œæœ€å° 4ms

4. äº‹ä»¶å¾ªç¯

# ref ä¸ toRef çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ

1. ref æœ¬è´¨æ˜¯å°†åŸæ•°æ®è¿›è¡Œæ‹·è´ï¼Œç„¶åé€šè¿‡ proxy è½¬ä¸ºå“åº”å¼æ•°æ®ï¼›æ‰€ä»¥ä¸ç®¡æ˜¯ä¿®æ”¹åŸæ•°æ®è¿˜æ˜¯ä¿®æ”¹å“åº”å¼æ•°æ®ï¼Œå®ƒä»¬æ˜¯ä¸ä¼šå—åˆ°å½±å“çš„
2. toRef æœ¬è´¨æ˜¯å°†ä¸€ä¸ªå¯¹è±¡çš„ä¸€ä¸ªå±æ€§ï¼Œé€šè¿‡ ref è½¬ä¸ºå“åº”å¼æ•°æ®ï¼Œæ˜¯å¼•ç”¨å…³ç³»ï¼›ä¸”ä¸ç®¡æ˜¯ä¿®æ”¹æºæ•°æ®è¿˜æ˜¯ä¿®æ”¹ toRef åçš„æ•°æ®ï¼Œä¸¤è€…éƒ½ä¼šæ”¹å˜
3. ref æ•°æ®å‘ç”Ÿå˜åŒ–åï¼Œç•Œé¢ä¼šé©¬ä¸Šæ›´æ–°ï¼›toRef æ•°æ®å‘ç”Ÿå˜åŒ–åï¼Œç•Œé¢ä¸ä¼šè‡ªåŠ¨æ›´æ–°
4. ref æ–¹æ³•åªæ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼ŒtoRef æ¥æ”¶ä¸¤ä¸ªå‚æ•°

# vue3 å¦‚ä½•å®ç°ä¸€ä¸ªç»„ä»¶çš„å¼‚æ­¥åŠ è½½ï¼Ÿ

1. Suspense
2. defineAsyncComponent

# å¦‚ä½•åˆ›å»ºä¸€ä¸ªæ²¡æœ‰ prototype çš„å¯¹è±¡ï¼Ÿ

Object.create(null)

# å‰ç«¯æ€§èƒ½ä¼˜åŒ–çš„æ‰‹æ®µï¼Ÿ

1. å‡å°‘é‡ç»˜å’Œå›æµ
   - ä½¿ç”¨ transform å’Œ opacity æ›¿ä»£ positionã€width å’Œ height æ¥è¿›è¡ŒåŠ¨ç”»
   - ä½¿ç”¨ will-change æ¥æå‰å‘ŠçŸ¥æµè§ˆå™¨æŸä¸ªå±æ€§å°†è¦å‘ç”Ÿå˜åŒ–
2. å‡å°‘ HTTP è¯·æ±‚ï¼š
   - åˆå¹¶å’Œå‹ç¼© cssã€JavaScript å’Œå›¾åƒæ–‡ä»¶
   - ä½¿ç”¨å­—ä½“å›¾æ ‡ä»£æ›¿å›¾åƒ
3. ä½¿ç”¨ç¼“å­˜
   - åˆ©ç”¨æµè§ˆå™¨ç¼“å­˜æœºåˆ¶ï¼Œè®¾ç½®åˆé€‚çš„ç¼“å­˜å¤´
   - åˆ©ç”¨ Service Workers å®ç°ç¦»çº¿ç¼“å­˜
4. å¼‚æ­¥åŠ è½½èµ„æº
   - å°†è„šæœ¬ç§»åˆ°é¡µé¢åº•éƒ¨
   - ä½¿ç”¨å¼‚æ­¥åŠ è½½è„šæœ¬æˆ–å»¶è¿ŸåŠ è½½è„šæœ¬
5. ä¼˜åŒ–å›¾åƒ
   - ä½¿ç”¨é€‚å½“çš„å›¾åƒæ ¼å¼
   - å‹ç¼©å›¾åƒä»¥å‡å°æ–‡ä»¶å¤§å°
   - ä½¿ç”¨å›¾åƒæ‡’åŠ è½½ï¼Œä»…åŠ è½½ç”¨æˆ·å¯è§åŒºåŸŸçš„å›¾åƒ
6. ä¼˜åŒ– CSS å’Œ JavaScrip
   - åˆå¹¶å’Œå‹ç¼© cssã€JavaScript æ–‡ä»¶
   - ç§»é™¤ä¸å¿…è¦çš„æ³¨é‡Šå’Œç©ºç™½
   - ä½¿ç”¨ Tree-shakingï¼ˆå¯¹äº JavaScriptï¼‰æ¥å»é™¤æœªä½¿ç”¨çš„ä»£ç 
7. ä½¿ç”¨ CDNï¼ˆå†…å®¹åˆ†å‘ç½‘ç»œï¼‰
   - å°†é™æ€èµ„æºéƒ¨ç½²åˆ°å…¨çƒ CDN ä¸Šï¼Œå‡å°‘ç½‘ç»œå»¶è¿Ÿ
8. æ‡’åŠ è½½å’Œåˆ†å—åŠ è½½
   - ä½¿ç”¨æ‡’åŠ è½½åŠ è½½è§†å£å†…çš„å†…å®¹
   - ä½¿ç”¨æŒ‰éœ€åŠ è½½ï¼ˆCode Splittingï¼‰åˆ†å‰²å¤§å‹ JavaScript æ–‡ä»¶
9. ä¼˜åŒ–å­—ä½“åŠ è½½
   - ä»…åŠ è½½é¡µé¢æ‰€éœ€çš„å­—ä½“å˜ä½“
   - ä½¿ç”¨ font-display: swap å±æ€§æ¥ä¼˜åŒ–å­—ä½“åŠ è½½

# å¦‚ä½•å°†ä¸€ä¸ªå­—ç¬¦ä¸²è½¬ä¸ºäºŒè¿›åˆ¶ï¼Ÿ

1. å°†å­—ç¬¦ä¸²è½¬ä¸ºå­—ç¬¦æ•°ç»„
2. éå†å­—ç¬¦æ•°ç»„ï¼Œä½¿ç”¨ charCodeAt() å°†æ¯ä¸ªå­—ç¬¦å…ƒç´ è½¬ä¸º ASCII ç 
3. ä½¿ç”¨ toString(2) å°† ASCII ç å…ƒç´ è½¬ä¸ºäºŒè¿›åˆ¶
4. ä½¿ç”¨ join() æ‹¼æ¥æ•°ç»„å…ƒç´ ï¼Œè½¬ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²

# ä¸¥æ ¼æ¨¡å¼ä¸‹æœ‰å“ªäº›é™åˆ¶ï¼Ÿ

- å˜é‡å¿…é¡»å£°æ˜åå†ä½¿ç”¨
- ä¸èƒ½ä½¿ç”¨ with è¯­å¥
- ç¦æ­¢ this æŒ‡å‘ window
- ä¸èƒ½åˆ é™¤å˜é‡
- ç¦æ­¢åœ¨å‡½æ•°å†…éƒ¨éå†è°ƒç”¨æ ˆ
- ç¦æ­¢ä½¿ç”¨ arguments.callee

# å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªæ•°æ®æ˜¯å¦å¯ä»¥è½¬æˆæ—¥æœŸï¼Ÿ

æ–¹æ³•ä¸€ï¼šç”¨ new Date() æ–¹æ³•ï¼Œå°†æ•°æ®è½¬æ¢æˆæ—¥æœŸå¯¹è±¡ï¼Œè½¬æ¢å¤±è´¥çš„å€¼æ˜¯å­—ç¬¦ä¸² "Invalid Date"

æ–¹æ³•äºŒï¼šç”¨ new Date() æ–¹æ³•ï¼Œå°†æ•°æ®è½¬æ¢æˆæ—¥æœŸå¯¹è±¡ï¼Œå†ç”¨ getTime() æ–¹æ³•ï¼Œè·å–è¯¥æ—¥æœŸçš„æ—¶é—´æˆ³ï¼Œæœ€åç”¨ isNaN() åˆ¤æ–­è¯¥æ—¶é—´æˆ³æ˜¯å¦ä¸ºä¸€ä¸ªæ•°ç»„

# å¦‚ä½•å…³é—­ ios é”®ç›˜é¦–å­—æ¯è‡ªåŠ¨å¤§å†™

`<input type="text" autocapoitalize="off" />`

# å¦‚ä½•æ£€æµ‹ä¸€ä¸ªæ•°ç»„ä¸­æ˜¯å¦åŒ…å«æŸä¸€ä¸ªå…ƒç´ ï¼Ÿ

1. indexOf è¿”å›å…ƒç´ ä¸‹æ ‡ï¼Œæ²¡æœ‰è¿”å› -1
2. find æŸ¥æ‰¾å¹¶è¿”å›ç›®æ ‡å…ƒç´ ï¼Œæ²¡æœ‰ undefined
3. findIndex æŸ¥æ‰¾å¹¶è¿”å›ç›®æ ‡å…ƒç´ ä¸‹æ ‡ï¼Œæ²¡æœ‰è¿”å› -1
4. some æŸ¥æ‰¾æ•°ç»„ä¸­æ˜¯å¦æœ‰ç¬¦åˆæ¡ä»¶çš„å…ƒç´ ï¼Œè¿”å› true/false
5. includes è¿”å›æ•°ç»„æ˜¯å¦åŒ…å«æŒ‡å®šçš„å…ƒç´ ï¼Œè¿”å› true/false

# å¾®ä¿¡å°ç¨‹åºé¢è¯•é¢˜ï¼šç»„ä»¶ä¸æ™®é€šé¡µé¢æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ

1. ç»„ä»¶çš„ .js æ–‡ä»¶æ‰§è¡Œçš„ Component() å‡½æ•°ï¼Œé¡µé¢ .js æ–‡ä»¶æ‰§è¡Œçš„æ˜¯ Page() å‡½æ•°
2. ç»„ä»¶åœ¨ .json æ–‡ä»¶ä¸­å¿…é¡»å£°æ˜ "component": true å±æ€§
3. ç»„ä»¶çš„äº‹ä»¶å¤„ç†å‡½æ•°éœ€è¦å®šä¹‰åˆ° methods èŠ‚ç‚¹ä¸­
4. ç”Ÿå‘½å‘¨æœŸä¸åŒ

# rgba å’Œ opacity éƒ½å¯ä»¥è®¾ç½®é€æ˜åº¦ï¼Œå®ƒä»¬æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ

1. rgba æŒ‡çš„æ˜¯é¢œè‰²ï¼Œrgb åˆ†åˆ«æ˜¯çº¢ã€ç»¿ã€è“ï¼Œa æŒ‡ Alpha é€æ˜åº¦ã€‚æ‰€ä»¥ rgba åªèƒ½ä½œç”¨äºé¢œè‰²ï¼›è€Œ opacity ä½œç”¨äºæ•´ä¸ªå…ƒç´ 
2. opacity ä¼šè¢«å­å…ƒç´ ç»§æ‰¿ï¼›rgba ä¸ä¼š

# åŒ¹é…å­—ç¬¦

```javascript
let reg = new RegExp(key, 'gi')
str.replace(reg, 'æ›¿æ¢å€¼æˆ–å›è°ƒå‡½æ•°')
```

# é”®ç›˜äº‹ä»¶

é”®ç›˜äº‹ä»¶ç”±ç”¨æˆ·å‡»æ‰“é”®ç›˜è§¦å‘ï¼Œä¸»è¦æœ‰ keydownã€keypressã€keyup ä¸‰ä¸ªäº‹ä»¶ï¼š

keydownï¼šæŒ‰ä¸‹é”®ç›˜æ—¶è§¦å‘

keyupï¼šæ¾å¼€é”®ç›˜æ—¶è§¦å‘è¯¥äº‹ä»¶

keypressï¼šæŒ‰ä¸‹æœ‰å€¼çš„é”®æ—¶è§¦å‘ã€‚å³æŒ‰ä¸‹ ctrl alt shift meta è¿™æ ·çš„æ— å€¼çš„é”®ï¼Œè¿™ä¸ªäº‹ä»¶ä¸ä¼šè§¦å‘

å¯¹äºæœ‰å€¼çš„é”®ï¼ŒæŒ‰ä¸‹æ—¶å…ˆè§¦å‘ keydown äº‹ä»¶ï¼Œå†è§¦å‘è¿™ä¸ªäº‹ä»¶ã€‚

# å¦‚ä½•å®ç°è‡ªé€‚åº”å¸ƒå±€

æ— é™é€‚é…æ–¹æ¡ˆ + rem å•ä½

æ— é™é€‚é…çš„æ ¸å¿ƒåŸç†ï¼šæŠŠå±å¹•åˆ’åˆ†ä¸ºä¸€å®šçš„ä»½æ•°ï¼ˆ10 ä»½ï¼‰ï¼Œé€šè¿‡ JS åŠ¨æ€ç›‘æµ‹å±å¹•å°ºå¯¸å®½åº¦ï¼Œå®æ—¶è®¡ç®—å¹¶è®¾ç½® html å…ƒç´ çš„åŸºç¡€å­—ä½“å¤§å°

# CDN

CDNï¼šå†…å®¹åˆ†å‘ç½‘ç»œï¼Œæ˜¯ä¸€ç»„åˆ†å¸ƒåœ¨ä¸–ç•Œå„åœ°çš„æœåŠ¡å™¨ç½‘ç»œï¼Œå¯ä»¥ä¸ºå…¨çƒç”¨æˆ·æä¾›å¿«é€Ÿã€å®‰å…¨çš„å†…å®¹ä¼ é€æœåŠ¡

åŸç†ï¼š

1. CDN æœåŠ¡å™¨åœ¨å…¨çƒå„åœ°åˆ†å¸ƒ
2. ç”¨æˆ·è®¿é—®ç½‘ç«™çš„æ—¶å€™ï¼Œç”¨æˆ·æµè§ˆå™¨ä¼šå‘æœ€è¿‘çš„ CDN å‘é€è¯·æ±‚
3. CDN æœåŠ¡ä¼šæŠŠå†…å®¹ç¼“å­˜åœ¨ç¦»ç”¨æˆ·æœ€è¿‘çš„æœåŠ¡å™¨ä¸Šé¢ï¼ŒæŠŠå†…å®¹è¿”å›ç»™ç”¨æˆ·

ä½œç”¨ï¼š

1. æé«˜é¡µé¢çš„åŠ è½½é€Ÿåº¦
2. å‡è½»æºæœåŠ¡å™¨çš„è´Ÿæ‹…
3. æé«˜ç½‘ç«™çš„å¯ç”¨æ€§

# æ–‡å­—è½¬è¯­éŸ³

å¦‚ä½•æŠŠæ–‡å­—è½¬è¯­éŸ³

web apiï¼šè¯­éŸ³ä¸ç»Ÿä¸€/å…¼å®¹æ€§

ç¬¬ä¸‰æ–¹å¹³å°

ä¼˜åŒ–ï¼š

æ–­å¥

å¹¶å‘æ§åˆ¶

ç¼“å­˜

å®¢æˆ·ç«¯ localStorageï¼ˆmd5 base64ï¼‰

æœåŠ¡å™¨

# é‡ç»˜å’Œå›æµæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

1. é‡ç»˜
   - å…ƒç´ æ ·å¼çš„å¯è§å±æ€§å‘ç”Ÿæ”¹å˜ï¼ˆé¢œè‰²ã€èƒŒæ™¯è‰²ï¼‰ï¼Œä½†å¸ƒå±€ä¸æ”¹å˜çš„æ—¶å€™
   - é‡ç»˜ä¸å½±å“é¡µé¢å¸ƒå±€ï¼Œåªä¼šé‡ç»˜å—å½±å“çš„å…ƒç´ 
2. å›æµ
   - å¸ƒå±€çš„å˜åŒ–å¯¼è‡´å…ƒç´ çš„å°ºå¯¸ã€ä½ç½®æˆ–éšè—çŠ¶æ€çš„å˜åŒ–ï¼Œéœ€è¦é‡æ–°è®¡ç®—æ•´ä¸ªå¸ƒå±€
   - å›æµä¼šé€ æˆé‡ç»˜ï¼Œä½†é‡ç»˜ä¸ä¸€å®šä¼šå›æµ

css3 ç¡¬ä»¶åŠ é€Ÿ

æ‰¹é‡æ“ä½œå…ƒç´ ï¼Œç„¶åå†ä½¿ç”¨æ–‡æ¡£ç¢ç‰‡è¿›è¡Œæ“ä½œ

ç¼“å­˜æ ·å¼å±æ€§

# SPA çš„ä¼˜ç¼ºç‚¹ï¼Œä»¥åŠåœ¨ä½•ç§åœºæ™¯ä¸‹æ›´é€‚åˆä½¿ç”¨ SPA

ä¼˜ç‚¹ï¼š

ç”¨æˆ·ä½“éªŒå¥½

æ€§èƒ½å¥½

å‰åç«¯åˆ†ç¦»

ç»„ä»¶åŒ–å’Œæ¨¡å—åŒ–

æ›´å¥½çš„å®¢æˆ·é€»è¾‘å¤„ç†

ç¼ºç‚¹ï¼š

åˆå§‹åŒ–åŠ è½½æ—¶é—´æ¯”è¾ƒé•¿

SEO é—®é¢˜æ¯”è¾ƒä¸¥é‡

å¤æ‚æ€§æ¯”è¾ƒé«˜

ä¸åˆ©äºç¦»çº¿æµè§ˆ

åœºæ™¯ï¼š

é¡¹ç›®ä¾§é‡äºç”¨æˆ·ä½“éªŒ

å¯¹äºä¸€äº›éœ€è¦ä¿æŒé«˜åº¦ä¸€è‡´æ€§çš„ UI è®¾è®¡å’Œäº¤äº’

å¯¹é¡¹ç›®æœ‰è¶³å¤Ÿçš„èµ„æºæŠ•å…¥ï¼Œå¹¶ä¸”å¯ä»¥æ‰¿æ‹…åˆå§‹åŒ–åŠ è½½æ—¶é—´è¾ƒé•¿

# ä»è¾“å…¥ URL åˆ°é¡µé¢å±•ç°è¿™ä¸€è¿‡ç¨‹ä¸­ï¼Œæµè§ˆå™¨éƒ½åšäº†å“ªäº›å·¥ä½œ

1. è§£æ URL
2. æŸ¥æ‰¾ç¼“å­˜
3. DNS æŸ¥è¯¢
4. å»ºç«‹ TCP é“¾æ¥
5. å‘é€ HTTP è¯·æ±‚
6. æœåŠ¡å™¨å¤„ç†è¯·æ±‚
7. æœåŠ¡å™¨å‘é€ HTTP å“åº”
8. æµè§ˆå™¨æ¥æ”¶å¹¶è§£æå“åº”
9. èµ„æºåŠ è½½ä¸æ¸²æŸ“
10. å¸ƒå±€å’Œç»˜åˆ¶
11. JS æ‰§è¡Œ
12. äº¤äº’ä¸æ›´æ–°

# å¦‚ä½•é¿å… JavaScript ä¸­çš„å…¨å±€å˜é‡æ±¡æŸ“ï¼Ÿ

1. ç«‹å³æ‰§è¡Œå‡½æ•°
2. ä¸¥æ ¼æ¨¡å¼

# window.onload å’Œ DOMContentLoaded çš„åŒºåˆ«

éƒ½æ˜¯ç”¨æ¥æ ‡è¯† DOM æ–‡æ¡£åŠ è½½å®Œæˆçš„äº‹ä»¶

1. åŠ è½½æ—¶æœºï¼š
   1. window.onload é¡µé¢æ‰€æœ‰ DOM åŠ è½½å®Œæˆåè§¦å‘
   2. DOMContentLoaded åœ¨ DOM æ ‘æ„å»ºå®Œæˆåè§¦å‘
2. äº‹ä»¶æ˜¯å¦èƒ½å¤šæ¬¡è§¦å‘ï¼š
   1. window.onload ä¸è¡Œ
   2. DOMContentLoaded å¯ä»¥
3. å…¼å®¹æ€§
   1. window.onload IE8 ä»¥ä¸‹ä¸æ”¯æŒ
   2. DOMContentLoaded IE9 ä»¥ä¸Šæ‰æ”¯æŒ

# è°ˆè°ˆç§»åŠ¨ç«¯å¸ƒå±€çš„å‡ ç§æ–¹å¼

1. æµå¼å¸ƒå±€

   ç›¸å¯¹å•ä½å®šä¹‰å…ƒç´ çš„å®½é«˜

2. å›ºå®šå®½åº¦å¸ƒå±€

3. å“åº”å¼å¸ƒå±€

   å¼¹æ€§å¸ƒå±€+åª’ä½“æŸ¥è¯¢

4. æ …æ ¼å¸ƒå±€

5. flex å¸ƒå±€ï¼ˆå¼¹æ€§å¸ƒå±€ï¼‰

6. ç€‘å¸ƒæµ

# å“åº”å¼è®¾è®¡

ç½‘ç«™åœ¨ä¸åŒçš„è®¾å¤‡å’Œå±å¹•å°ºå¯¸ä¸Šéƒ½å¯ä»¥æä¾›ä¸€è‡´çš„ç”¨æˆ·ä½“éªŒ

åŸç†ï¼š

1. å¼¹æ€§å’Œç½‘æ ¼å¸ƒå±€
2. å¼¹æ€§å›¾ç‰‡ï¼šå›¾ç‰‡ä¼šæ ¹æ®å±å¹•å¤§å°è¿›è¡Œè°ƒæ•´
3. åª’ä½“æŸ¥è¯¢
4. æµå¼å¸ƒå±€
5. é€‚åº”å›¾ç‰‡

# ç‚¹å‡»ç©¿é€

åœ¨è¿›è¡Œå¿«é€Ÿæ»‘åŠ¨çš„æ—¶å€™ï¼ŒæŸä¸ªå¯ç‚¹å‡»å…ƒç´ çš„ç‚¹å‡»äº‹ä»¶é€è¿‡äº†å½“å‰å…ƒç´ ä¼ é€’åˆ°äº†ä¸‹æ–¹å…ƒç´ 

1. é˜»æ­¢é»˜è®¤äº‹ä»¶

   e.preventDefault()

2. ä½¿ç”¨ touch äº‹ä»¶

3. ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“

   fastclick zepto

4. css

# rem å’Œ em çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ

```
px em rem åŒºåˆ«
1.pxï¼šå›ºå®šå€¼ç»å¯¹å•ä½
2.emï¼šç›¸å¯¹å•ä½ï¼šç›¸å¯¹äºå®ƒçš„çˆ¶å…ƒç´ çš„å­—ä½“å¤§å°
3.remï¼šç›¸å¯¹å•ä½ï¼šç›¸å¯¹äºæ ¹å…ƒç´ ï¼ˆhtmlï¼‰å­—ä½“å¤§å°
```

1. rem

   ç›¸å¯¹äºæ ¹å…ƒç´ çš„å­—ä½“å¤§å°æ¥è®¡ç®—çš„

   æ ¹å…ƒç´ çš„ font-sizeï¼š16pxï¼Œå¦å¤–ä¸€ä¸ªå…ƒç´  width:1rem

2. em

   em ç›¸å¯¹äºå½“å‰å…ƒç´ çš„çˆ¶å…ƒç´ å­—ä½“å¤§å°æ¥è®¡ç®—

   å¦‚æœçˆ¶å…ƒç´ è®¾ç½®äº†å­—ä½“å¤§å°ï¼Œå­å…ƒç´ ä½¿ç”¨ em å•ä½ï¼Œå®ƒçš„å¤§å°ä¼šå—åˆ°çˆ¶å…ƒç´ å­—ä½“å¤§å°çš„å½±å“

# æ¸…é™¤æµ®åŠ¨çš„æ–¹æ³•æœ‰å“ªäº›ï¼Ÿä¼ªå…ƒç´ æ¸…é™¤çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ

1. é¢å¤–æ ‡ç­¾æ³•

   æµ®åŠ¨å…ƒç´ ä¹‹åæ·»åŠ ä¸€ä¸ªç©º div æˆ–å…¶ä»–å—çº§å…ƒç´ ï¼Œå¹¶è®¾ç½® clear:both

2. ä½¿ç”¨ overflow å±æ€§è§¦å‘ BFC

   æµ®åŠ¨å…ƒç´ çš„çˆ¶å®¹å™¨ä¸Šè®¾ç½® overflow:hidden

3. ä¼ªå…ƒç´ æ¸…é™¤æ³•

   åˆ©ç”¨ after ä¼ªå…ƒç´ ä¸ºæµ®åŠ¨å…ƒç´ çš„çˆ¶å®¹å™¨æ·»åŠ çœ‹ä¸è§çš„å†…å®¹ï¼Œç„¶åè®¾ç½® clear:both;display:block;content:''

4. ç›´æ¥è®¾ç½®é«˜åº¦

# forEach

```javascript
const arr = [1, 2, 3]
arr.forEach((item) => {
  arr.push(2)
  console.log('arr', item)
})

arr.forEach((item, i) => {
  arr.splice(i, 1)
  console.log('arr', item)
})

const arr1 = [, , 3]
arr1.forEach((item) => {
  console.log('arr', item)
})
```

```javascript
Array.prototype.forEach = function (callback) {
  const len = this.length
  if (typeof callback !== 'function') {
    throw new TypeError(callback + 'is not a function')
  }
  let k = 0
  while (k < len) {
    if (k in ths) {
      callback(this[k], k, this)
    }
    k++
  }
}
```

# ç«‹å³æ‰§è¡Œå‡½æ•°

```javascript
;(function test() {
  test = 'LBJhui'
  console.log(test)
})()
// å‡½æ•°çš„åç§°æ˜¯åªè¯»çš„ï¼Œæ‰€ä»¥ä¸èƒ½åœ¨å‡½æ•°å†…éƒ¨ä¿®æ”¹å‡½æ•°çš„åç§°ã€‚å› æ­¤å‡½æ•°å†…éƒ¨ test = 'LBJhui' è¿™è¡Œä»£ç å…¶å®æ˜¯æ— æ•ˆçš„
```

# åœ¨å‰ç«¯å¼€å‘ä¸­å¦‚ä½•ä¼˜åŒ– DOM æ“ä½œä»¥æé«˜é¡µé¢æ€§èƒ½

1. å‡å°‘ DOM æŸ¥è¯¢
2. æ‰¹é‡å¤„ç† DOM æ“ä½œ
3. é¿å…ä¸å¿…è¦çš„é‡æ’é‡ç»˜
4. ä½¿ç”¨ç°ä»£ api
5. å¼‚æ­¥ç¼–ç¨‹å’Œå»¶è¿ŸåŠ è½½
6. ä½¿ç”¨åŸç”Ÿæ–¹æ³•æ›¿ä»£å­—ç¬¦ä¸²æ“ä½œ
7. äº‹ä»¶å§”æ‰˜

# CORS çš„å·¥ä½œåŸç†æ˜¯ä»€ä¹ˆï¼Ÿ

é¢„æ£€è¯·æ±‚

æœåŠ¡å™¨å“åº”

å®é™…è¯·æ±‚å’Œå“åº”

æµè§ˆå™¨æ£€éªŒ

# JSONP æ˜¯ä»€ä¹ˆï¼Ÿå®ƒæ˜¯å¦‚ä½•ç»•è¿‡åŒæºç­–ç•¥çš„

åˆ©ç”¨æµè§ˆå™¨å¯¹ script æ ‡ç­¾çš„ç‰¹æ®Šå¤„ç†æ¥è§„é¿åŒæºç­–ç•¥çš„é™åˆ¶

åŸç†æ ¸å¿ƒï¼š

æœºåˆ¶

- å®¢æˆ·ç«¯è¯·æ±‚
- æœåŠ¡ç«¯å“åº”
- å®¢æˆ·ç«¯å¤„ç†

ç»•è¿‡åŒæºç­–ç•¥

åœºæ™¯é™åˆ¶ï¼šGET

# scoped åŸç†

1. ä½œç”¨ï¼šè®©æ ·å¼åœ¨æœ¬ç»„ä»¶ä¸­ç”Ÿæ•ˆï¼Œä¸å½±å“å…¶ä»–ç»„ä»¶
2. åŸç†ï¼šç»™ç»“ç‚¹æ–°å¢è‡ªå®šä¹‰å±æ€§ï¼Œç„¶å css æ ¹æ®å±æ€§é€‰æ‹©å™¨æ·»åŠ æ ·å¼

# ä»€ä¹ˆæ˜¯ XSS æ”»å‡»ï¼Ÿå¦‚ä½•é˜²æ­¢ XSS æ”»å‡»ï¼Ÿ

XSSï¼šæŒ‡æ”»å‡»è€…é€šè¿‡åœ¨ç›®æ ‡ç½‘ç«™è¾“å…¥å­—æ®µä¸­æ³¨å…¥æ¶æ„è„šæœ¬ä»£ç ï¼Œå½“å…¶ä»–ç”¨æˆ·æµè§ˆè¿™ä¸ªç½‘ç«™çš„æ—¶å€™ï¼Œè„šæœ¬ä¼šåœ¨ä»–çš„æµè§ˆå™¨ä¸­æ‰§è¡Œï¼Œè·å–ç”¨æˆ·çš„æ•æ„Ÿä¿¡æ¯ã€‚

é˜²æ­¢æªæ–½ï¼š

1. è¾“å…¥éªŒè¯å’Œè¿‡æ»¤
2. è¾“å‡ºç¼–ç 
3. ä½¿ç”¨ HTTP å¤´éƒ¨è®¾ç½®
4. å¦¥å–„ç®¡ç† cookies
5. å»ºç«‹å®‰å…¨çš„å¼€å‘å®è·µ
6. æ›´æ–°å’Œè½¯ä»¶å‡çº§

# Vue è·¯ç”±æ¨¡å¼

è·¯ç”±æ¨¡å¼æœ‰ä¸¤ç§ï¼šhistoryã€hash

åŒºåˆ«ï¼š

1. è¡¨ç°å½¢æ€ä¸åŒ
2. è·³è½¬è¯·æ±‚ï¼Œè·¯å¾„ä¸å­˜åœ¨æ—¶ï¼Œhistory ä¼šå‘é€è¯·æ±‚ï¼Œhash ä¸ä¼šå‘é€è¯·æ±‚
3. æ‰“åŒ…åå‰ç«¯è‡ªæµ‹è¦ä½¿ç”¨ hashï¼Œå¦‚æœä½¿ç”¨ history ä¼šå‡ºç°ç©ºç™½é¡µ

# åœ¨å¤„ç†è·¨åŸŸæ—¶ï¼Œå¦‚æœè€ƒè™‘å®‰å…¨æ€§å› ç´ 

1. ç²¾ç¡®æ§åˆ¶å…è®¸çš„æº
2. é™åˆ¶è¯·æ±‚æ–¹æ³•å’Œå¤´ä¿¡æ¯
3. é¢„æ£€è¯·æ±‚éªŒè¯
4. ä½¿ç”¨ https
5. è®¾ç½®é€‚å½“çš„ CSP ç­–ç•¥
6. éªŒè¯å’Œè¿‡æ»¤è¯·æ±‚æ•°æ®
7. é™åˆ¶ç¬¬ä¸‰æ–¹ API ä½¿ç”¨
8. å®æ–½é€Ÿç‡é™åˆ¶
9. æ—¥å¿—å’Œç›‘æ§

# post è¯·æ±‚å’Œ get è¯·æ±‚åœ¨è·¨åŸŸæ—¶æœ‰ä½•ä¸åŒï¼Ÿ

å½“æ¶‰åŠåˆ°è·¨åŸŸè¯·æ±‚ï¼ˆCross-Origin Requestsï¼‰æ—¶ï¼ŒPOST è¯·æ±‚å’Œ GET è¯·æ±‚ä¹‹é—´å­˜åœ¨ä¸€äº›å…³é”®çš„ä¸åŒç‚¹ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†æµè§ˆå™¨ä¸­çš„ CORSï¼ˆè·¨æ¥æºèµ„æºå…±äº«ï¼‰ç­–ç•¥æ—¶ã€‚ä»¥ä¸‹æ˜¯å®ƒä»¬ä¹‹é—´çš„ä¸»è¦å·®å¼‚ï¼š

1. **é¢„æ£€è¯·æ±‚ï¼ˆPreflight Requestï¼‰**ï¼š

   - å¯¹äºæŸäº› CORS è¯·æ±‚ï¼Œæµè§ˆå™¨ä¼šé¦–å…ˆå‘é€ä¸€ä¸ª OPTIONS è¯·æ±‚ä½œä¸ºé¢„æ£€è¯·æ±‚ï¼Œä»¥æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦å…è®¸è·¨åŸŸè¯·æ±‚ã€‚è¿™é€šå¸¸å‘ç”Ÿåœ¨â€œéç®€å•è¯·æ±‚â€ä¸­ï¼Œå³é‚£äº›ä¸ç¬¦åˆç®€å•è¯·æ±‚æ¡ä»¶çš„è¯·æ±‚ã€‚ç®€å•è¯·æ±‚çš„æ¡ä»¶åŒ…æ‹¬ï¼šè¯·æ±‚æ–¹æ³•åªèƒ½æ˜¯
     HEADã€GET æˆ– POSTï¼Œè¯·æ±‚å¤´åªèƒ½åŒ…å«ä¸€äº›ç‰¹å®šçš„å­—æ®µï¼ˆå¦‚ Acceptã€Accept-Languageã€Content-Languageã€Content-Type ç­‰ï¼‰ï¼Œä¸” Content-Type çš„å€¼ä»…é™äº`application/x-www-form-urlencoded`ã€
     `multipart/form-data`æˆ–`text/plain`ã€‚
   - å¯¹äº POST è¯·æ±‚ï¼Œå¦‚æœå®ƒåŒ…å«è‡ªå®šä¹‰çš„ HTTP å¤´æˆ– Content-Type å­—æ®µçš„å€¼ä¸æ˜¯ä¸Šè¿°çš„â€œç®€å•â€å€¼ï¼Œé‚£ä¹ˆå®ƒé€šå¸¸ä¼šè§¦å‘é¢„æ£€è¯·æ±‚ã€‚è€Œ GET è¯·æ±‚ç”±äºå…¶æ€§è´¨ï¼ˆé€šå¸¸åªç”¨äºæ£€ç´¢æ•°æ®ï¼‰å’Œç®€å•æ€§ï¼Œå¾ˆå°‘ä¼šè§¦å‘é¢„æ£€è¯·æ±‚ã€‚

2. **ç¼“å­˜**ï¼š

   - æµè§ˆå™¨å¯èƒ½ä¼šå¯¹ GET è¯·æ±‚çš„å“åº”è¿›è¡Œç¼“å­˜ï¼Œè¿™æ„å‘³ç€å¯¹äºç›¸åŒçš„ URL å’Œè¯·æ±‚å¤´ï¼Œæµè§ˆå™¨å¯èƒ½ä¼šä»ç¼“å­˜ä¸­åŠ è½½å“åº”è€Œä¸æ˜¯é‡æ–°å‘é€è¯·æ±‚åˆ°æœåŠ¡å™¨ã€‚ä½†æ˜¯ï¼ŒPOST è¯·æ±‚é€šå¸¸ä¸ä¼šè¢«ç¼“å­˜ï¼Œå› ä¸ºå®ƒä»¬æ˜¯ç”¨äºæäº¤æ•°æ®çš„ï¼Œè€Œæ•°æ®å¯èƒ½ä¼šç»å¸¸å˜åŒ–ã€‚
   - åœ¨è·¨åŸŸåœºæ™¯ä¸­ï¼Œè¿™ç§ç¼“å­˜è¡Œä¸ºå¯èƒ½ä¼šå½±å“è¯·æ±‚çš„æ€§èƒ½å’Œç»“æœã€‚å¦‚æœ GET è¯·æ±‚çš„å“åº”è¢«ç¼“å­˜ï¼Œå¹¶ä¸”æœåŠ¡å™¨ä¸Šçš„æ•°æ®å·²ç»æ›´æ”¹ï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯å¯èƒ½ä¼šè·å–åˆ°æ—§çš„ã€ä¸å‡†ç¡®çš„æ•°æ®ã€‚

3. **å®‰å…¨æ€§**ï¼š

   - ä»å®‰å…¨æ€§çš„è§’åº¦æ¥çœ‹ï¼ŒPOST è¯·æ±‚é€šå¸¸ç”¨äºæäº¤æ•°æ®ï¼ˆå¦‚è¡¨å•æ•°æ®ã€æ–‡ä»¶ä¸Šä¼ ç­‰ï¼‰ï¼Œè€Œ GET è¯·æ±‚åˆ™ç”¨äºæ£€ç´¢æ•°æ®ã€‚å› æ­¤ï¼Œåœ¨è·¨åŸŸåœºæ™¯ä¸­ï¼Œä½¿ç”¨ POST è¯·æ±‚æäº¤æ•æ„Ÿæ•°æ®å¯èƒ½æ›´å®‰å…¨ä¸€äº›ï¼Œå› ä¸ºå®ƒä¸å¤ªå¯èƒ½è¢«ç¼“å­˜æˆ–è®°å½•åœ¨æµè§ˆå™¨çš„å†å²è®°å½•ä¸­ã€‚ä½†æ˜¯ï¼Œè¿™å¹¶ä¸æ„å‘³ç€
     POST è¯·æ±‚æœ¬èº«å°±æ›´å®‰å…¨ï¼›å®ƒä»ç„¶éœ€è¦é€‚å½“çš„å®‰å…¨æªæ–½ï¼ˆå¦‚ HTTPSã€èº«ä»½éªŒè¯å’Œæˆæƒç­‰ï¼‰æ¥ä¿æŠ¤æ•°æ®ã€‚

4. **è¯·æ±‚ä½“ï¼ˆRequest Bodyï¼‰**ï¼š

   - GET è¯·æ±‚é€šå¸¸æ²¡æœ‰è¯·æ±‚ä½“ï¼ˆå°½ç®¡æŸäº› HTTP å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å¯èƒ½å…è®¸åœ¨ GET è¯·æ±‚ä¸­åŒ…å«è¯·æ±‚ä½“ï¼Œä½†è¿™å¹¶ä¸æ˜¯æ ‡å‡†åšæ³•ï¼‰ã€‚å› æ­¤ï¼Œè·¨åŸŸ GET è¯·æ±‚ä¸èƒ½ç”¨äºå‘é€å¤§é‡æ•°æ®åˆ°æœåŠ¡å™¨ã€‚ç›¸åï¼ŒPOST
     è¯·æ±‚å¯ä»¥åŒ…å«è¯·æ±‚ä½“ï¼Œå¹¶ç”¨äºå‘é€å¤§é‡æ•°æ®åˆ°æœåŠ¡å™¨ã€‚

5. **å¹‚ç­‰æ€§**ï¼š

   - GET è¯·æ±‚æ˜¯å¹‚ç­‰çš„ï¼Œå³å¤šæ¬¡æ‰§è¡Œç›¸åŒçš„ GET è¯·æ±‚ä¸ä¼šäº§ç”Ÿä¸åŒçš„ç»“æœï¼ˆé™¤éæœ‰å‰¯ä½œç”¨ï¼Œå¦‚æ•°æ®æ›´æ–°æˆ–åˆ é™¤ï¼‰ã€‚è¿™ä½¿å¾— GET è¯·æ±‚åœ¨è·¨åŸŸåœºæ™¯ä¸­æ›´åŠ å¯é å’Œå¯é¢„æµ‹ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒPOST è¯·æ±‚é€šå¸¸ä¸æ˜¯å¹‚ç­‰çš„ï¼Œå› ä¸ºæ¯æ¬¡æ‰§è¡Œ
     POST è¯·æ±‚éƒ½å¯èƒ½ä¼šäº§ç”Ÿä¸åŒçš„ç»“æœï¼ˆä¾‹å¦‚ï¼Œåˆ›å»ºæ–°çš„èµ„æºæˆ–æ›´æ–°ç°æœ‰èµ„æºï¼‰ã€‚

6. **æµè§ˆå™¨é™åˆ¶**ï¼š

   - æŸäº›æµè§ˆå™¨å¯èƒ½ä¼šå¯¹ GET è¯·æ±‚çš„ URL é•¿åº¦æ–½åŠ é™åˆ¶ï¼ˆå°½ç®¡è¿™ä¸ªé™åˆ¶å¯èƒ½å› æµè§ˆå™¨å’Œç‰ˆæœ¬è€Œå¼‚ï¼‰ã€‚å¦‚æœ URL è¶…è¿‡äº†è¿™ä¸ªé™åˆ¶ï¼Œé‚£ä¹ˆ GET è¯·æ±‚å¯èƒ½ä¼šå¤±è´¥ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒPOST è¯·æ±‚æ²¡æœ‰è¿™æ ·çš„é™åˆ¶ï¼Œå› ä¸ºæ•°æ®å¯ä»¥åŒ…å«åœ¨è¯·æ±‚ä½“ä¸­è€Œä¸æ˜¯
     URL ä¸­ã€‚å› æ­¤ï¼Œåœ¨éœ€è¦å‘é€å¤§é‡æ•°æ®æˆ–å¤æ‚æŸ¥è¯¢å‚æ•°çš„è·¨åŸŸåœºæ™¯ä¸­ï¼ŒPOST è¯·æ±‚å¯èƒ½æ›´åˆé€‚ã€‚

# è§£é‡Šä¸€ä¸‹ CSP ä¸è·¨åŸŸçš„å…³ç³»

CSPï¼ˆContent Security Policyï¼‰ä¸è·¨åŸŸï¼ˆCross-Originï¼‰åœ¨ Web å®‰å…¨é¢†åŸŸä¸­æ˜¯ä¸¤ä¸ªé‡è¦çš„æ¦‚å¿µï¼Œä½†å®ƒä»¬å„è‡ªå…³æ³¨çš„å®‰å…¨é—®é¢˜å’Œå®ç°æœºåˆ¶æœ‰æ‰€ä¸åŒã€‚ä»¥ä¸‹æ˜¯å…³äº CSP ä¸è·¨åŸŸå…³ç³»çš„è¯¦ç»†è§£é‡Šï¼š

### CSPï¼ˆå†…å®¹å®‰å…¨ç­–ç•¥ï¼‰

1. **å®šä¹‰**ï¼šCSP æ˜¯ä¸ºäº†ç¼“è§£è·¨ç«™è„šæœ¬ï¼ˆXSSï¼‰ç­‰å®‰å…¨å¨èƒè€Œå¼•å…¥çš„ä¸€ç§å®‰å…¨æœºåˆ¶ã€‚å®ƒå…è®¸ç½‘ç«™å¼€å‘è€…åˆ›å»ºå¹¶å¼ºåˆ¶åº”ç”¨ä¸€äº›è§„åˆ™ï¼Œä»¥ç®¡ç†ç½‘ç«™å…è®¸åŠ è½½çš„å†…å®¹ã€‚
2. **å·¥ä½œåŸç†**ï¼šCSP ä»¥ç™½åå•çš„æœºåˆ¶å¯¹ç½‘ç«™åŠ è½½æˆ–æ‰§è¡Œçš„èµ„æºèµ·ä½œç”¨ã€‚åœ¨ç½‘é¡µä¸­ï¼Œè¿™æ ·çš„ç­–ç•¥é€šè¿‡ HTTP å¤´ä¿¡æ¯æˆ–è€… meta å…ƒç´ å®šä¹‰ã€‚ä¾‹å¦‚ï¼Œé€šè¿‡è®¾ç½®`Content-Security-Policy` HTTP
   å¤´ï¼Œå¯ä»¥é™åˆ¶å“ªäº›å¤–éƒ¨èµ„æºï¼ˆå¦‚è„šæœ¬ã€æ ·å¼è¡¨ã€å›¾ç‰‡ç­‰ï¼‰å¯ä»¥è¢«åŠ è½½å’Œæ‰§è¡Œã€‚
3. **é™åˆ¶ä¸å½±å“**ï¼šCSP è™½ç„¶æä¾›äº†å¼ºå¤§çš„å®‰å…¨ä¿æŠ¤ï¼Œä½†ä¹Ÿå¯èƒ½é€ æˆä¸€äº›é™åˆ¶ï¼Œå¦‚ Eval åŠç›¸å…³å‡½æ•°è¢«ç¦ç”¨ã€å†…åµŒçš„ JavaScript ä»£ç å°†ä¸ä¼šæ‰§è¡Œã€åªèƒ½é€šè¿‡ç™½åå•æ¥åŠ è½½è¿œç¨‹è„šæœ¬ç­‰ã€‚è¿™äº›é™åˆ¶å¯èƒ½ä¼šå¢åŠ å¼€å‘è€…çš„å·¥ä½œé‡ï¼Œéœ€è¦èŠ±è´¹æ›´å¤šæ—¶é—´æ¥åˆ†ç¦»å†…åµŒçš„
   JavaScript ä»£ç å’Œè°ƒæ•´åº”ç”¨é€»è¾‘ã€‚

### è·¨åŸŸï¼ˆCross-Originï¼‰

1. **å®šä¹‰**ï¼šè·¨åŸŸæ˜¯æŒ‡ä¸€ä¸ªåŸŸä¸‹çš„æ–‡æ¡£æˆ–è„šæœ¬è¯•å›¾å»è¯·æ±‚å¦ä¸€ä¸ªåŸŸä¸‹çš„èµ„æºã€‚ç”±äºæµè§ˆå™¨çš„åŒæºç­–ç•¥ï¼ˆSame-Origin Policyï¼‰ï¼Œè·¨åŸŸè¯·æ±‚é€šå¸¸ä¼šè¢«é™åˆ¶æˆ–é˜»æ­¢ï¼Œä»¥é˜²æ­¢æ¶æ„è„šæœ¬æ”»å‡»å’Œæ•°æ®æ³„éœ²ã€‚
2. **åŒæºç­–ç•¥**ï¼šåŒæºç­–ç•¥è¦æ±‚åè®®ã€åŸŸåå’Œç«¯å£ä¸‰è€…éƒ½ç›¸åŒæ‰è¢«è®¤ä¸ºæ˜¯åŒæºçš„ã€‚å¦‚æœå…¶ä¸­ä»»ä½•ä¸€ä¸ªä¸åŒï¼Œåˆ™è¢«è§†ä¸ºè·¨åŸŸã€‚
3. **è§£å†³æ–¹æ¡ˆ**ï¼šä¸ºäº†å®ç°è·¨åŸŸè¯·æ±‚ï¼Œå¼€å‘è€…å¯ä»¥é‡‡ç”¨ä¸€äº›æŠ€æœ¯æ‰‹æ®µï¼Œå¦‚ CORSï¼ˆè·¨æ¥æºèµ„æºå…±äº«ï¼‰ã€Proxyï¼ˆä»£ç†ï¼‰å’Œ JSONP ç­‰ã€‚è¿™äº›æŠ€æœ¯å…è®¸æœåŠ¡å™¨è®¾ç½®ç‰¹å®šçš„å“åº”å¤´ï¼ˆå¦‚`Access-Control-Allow-Origin`
   ï¼‰ï¼Œä»¥å…è®¸æ¥è‡ªä¸åŒæºçš„è¯·æ±‚ã€‚

### CSP ä¸è·¨åŸŸçš„å…³ç³»

- **ç‹¬ç«‹æ€§**ï¼šCSP å’Œè·¨åŸŸæ˜¯ä¸¤ä¸ªç‹¬ç«‹çš„æ¦‚å¿µï¼Œå„è‡ªå…³æ³¨ä¸åŒçš„å®‰å…¨é—®é¢˜ã€‚CSP å…³æ³¨çš„æ˜¯å¦‚ä½•é™åˆ¶å’Œç®¡ç†ç½‘ç«™åŠ è½½çš„å†…å®¹ï¼Œè€Œè·¨åŸŸå…³æ³¨çš„æ˜¯å¦‚ä½•å…è®¸æˆ–é™åˆ¶æ¥è‡ªä¸åŒæºçš„è¯·æ±‚ã€‚
- **ç›¸äº’å½±å“**ï¼šåœ¨æŸäº›æƒ…å†µä¸‹ï¼ŒCSP çš„è®¾ç½®å¯èƒ½ä¼šå½±å“è·¨åŸŸè¯·æ±‚çš„å®ç°ã€‚ä¾‹å¦‚ï¼Œåœ¨ä½¿ç”¨ CSP é™åˆ¶è„šæœ¬åŠ è½½æ—¶ï¼Œå¦‚æœè·¨åŸŸè¯·æ±‚éœ€è¦åŠ è½½å¹¶æ‰§è¡Œè¿œç¨‹è„šæœ¬ï¼Œå¯èƒ½ä¼šå—åˆ° CSP ç­–ç•¥çš„é™åˆ¶ã€‚åŒæ ·ï¼Œè·¨åŸŸè¯·æ±‚çš„å®ç°ä¹Ÿå¯èƒ½éœ€è¦è€ƒè™‘
  CSP ç­–ç•¥çš„å½±å“ï¼Œä»¥ç¡®ä¿è¯·æ±‚çš„èµ„æºç¬¦åˆ CSP è§„åˆ™ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼ŒCSP å’Œè·¨åŸŸåœ¨ Web å®‰å…¨é¢†åŸŸä¸­å„è‡ªæ‰®æ¼”ç€é‡è¦çš„è§’è‰²ã€‚å¼€å‘è€…éœ€è¦æ ¹æ®å®é™…éœ€æ±‚åˆç†é…ç½® CSP ç­–ç•¥å’Œè·¨åŸŸè¯·æ±‚çš„å®ç°æ–¹å¼ï¼Œä»¥ç¡®ä¿ Web åº”ç”¨çš„å®‰å…¨æ€§å’Œå¯ç”¨æ€§ã€‚
